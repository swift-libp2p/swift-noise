//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import Crypto
import XCTest

@testable import Noise

final class K_Handshake_Tests: XCTestCase {

    func test_Noise_K_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
            handshake=Noise_K_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254af724161ce8037f690f587990caba741
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=af4b5c9ff0d0b31da602bb6e7153edd095bd37fa83b0a35768d6ac024bc746
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=a5f0b377dfd3489f3f151959508a84f19530d5cb0ea8226f2481f7839d2be5

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547a2e747346812f333b2884928033af07
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=548e6dc3b25bc8d0916603d1b74d6755aeb9664c5d890466d385e7dc918acb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b43de84e2dbaaa14fdec24a4f7cc2dad954be8427ffea5b736d623b75ac878

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543754db2fc9cc2ef2f59756219f19fdf4
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8c47be8aaf7c41ae38280e5e38cd42f5c57e55f0bae05b5088c448ca737cac
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03fac31b503fe58810962b52ddd9ad9fb8ff709d88926115d593bb790be465

            handshake=Noise_K_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b8cae311a5f3367e2170caf5c7ae0947b49ced8a3b7a99f10460
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=af4b5c9ff0d0b31da602bb6e7153edd095bd37fa83b0a35768d6ac024bc746
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=a5f0b377dfd3489f3f151959508a84f19530d5cb0ea8226f2481f7839d2be5

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541a844cd1a19651421cc5f0a672d6629f1bcebe5fd2691c65df09
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=548e6dc3b25bc8d0916603d1b74d6755aeb9664c5d890466d385e7dc918acb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b43de84e2dbaaa14fdec24a4f7cc2dad954be8427ffea5b736d623b75ac878

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542e79d636b2cfc26e6d3b795a2db7f448dd03f4a5053d35f31b5e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8c47be8aaf7c41ae38280e5e38cd42f5c57e55f0bae05b5088c448ca737cac
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03fac31b503fe58810962b52ddd9ad9fb8ff709d88926115d593bb790be465

            handshake=Noise_K_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254061ee6934752ad8113f86fbb135a5833
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=af4b5c9ff0d0b31da602bb6e7153edd095bd37fa83b0a35768d6ac024bc746
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=a5f0b377dfd3489f3f151959508a84f19530d5cb0ea8226f2481f7839d2be5

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548960d9a2b168215cea4307684febf3a7
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=548e6dc3b25bc8d0916603d1b74d6755aeb9664c5d890466d385e7dc918acb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b43de84e2dbaaa14fdec24a4f7cc2dad954be8427ffea5b736d623b75ac878

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254fffe9d4e3bde9e0560276f13d2c04674
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8c47be8aaf7c41ae38280e5e38cd42f5c57e55f0bae05b5088c448ca737cac
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03fac31b503fe58810962b52ddd9ad9fb8ff709d88926115d593bb790be465

            handshake=Noise_K_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b8cae311a5f3367e21709e6be52d6fd8abf20e2708f50165f7ba
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=af4b5c9ff0d0b31da602bb6e7153edd095bd37fa83b0a35768d6ac024bc746
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=a5f0b377dfd3489f3f151959508a84f19530d5cb0ea8226f2481f7839d2be5

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541a844cd1a19651421cc510d96aa4ac452dc98839e9311bb36fd9
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=548e6dc3b25bc8d0916603d1b74d6755aeb9664c5d890466d385e7dc918acb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b43de84e2dbaaa14fdec24a4f7cc2dad954be8427ffea5b736d623b75ac878

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542e79d636b2cfc26e6d3b936366095e5a0447b667b6c1ae8d7887
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8c47be8aaf7c41ae38280e5e38cd42f5c57e55f0bae05b5088c448ca737cac
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03fac31b503fe58810962b52ddd9ad9fb8ff709d88926115d593bb790be465
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_K_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
            handshake=Noise_K_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f6c00a2c6c7b4e047404cd845438f31d
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8f37d99ddd83fcfad851544fadbbd9f83a21cb504f79a040f0db0ef406a2cb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8b69be08bbd320ce82a65b1ac6013f3aada9a0e64e53b0f9de55a83e0fd4e2

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545b743993c03a39ed2078fe83cacb0005
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=5df379aa748528b394de3a483c10bfa9b2fd420d2d5a7247be18b9b71b1741
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=73a0c4086f45b89ac5ac48564363e3cce8449b2d2c7cf71adadb6258119771

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254af5df3705094e65fd6345071bdb48771
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c63f46ef1a4531b36b6d9d933fc6d97a929ba3fce60a9523228c4df6745d30
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=daa224045edb5559f94be878b2de124313b1e157fa49295925143dca42782b

            handshake=Noise_K_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541f0499b194617954a3a80fecc4b0b687b2dcfaca93c170ec8133
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8f37d99ddd83fcfad851544fadbbd9f83a21cb504f79a040f0db0ef406a2cb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8b69be08bbd320ce82a65b1ac6013f3aada9a0e64e53b0f9de55a83e0fd4e2

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549832db195cc1e003857c7f520d021430e9ae20a35b9e906b8f7e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=5df379aa748528b394de3a483c10bfa9b2fd420d2d5a7247be18b9b71b1741
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=73a0c4086f45b89ac5ac48564363e3cce8449b2d2c7cf71adadb6258119771

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549ad2b6a5f66290516660e12f3f66ba36a904982d33fe8ed8f15e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c63f46ef1a4531b36b6d9d933fc6d97a929ba3fce60a9523228c4df6745d30
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=daa224045edb5559f94be878b2de124313b1e157fa49295925143dca42782b

            handshake=Noise_K_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254fef72b48f3aac25836d9eb5b379c8a5b
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8f37d99ddd83fcfad851544fadbbd9f83a21cb504f79a040f0db0ef406a2cb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8b69be08bbd320ce82a65b1ac6013f3aada9a0e64e53b0f9de55a83e0fd4e2

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548ae6fc65d6fc0d280734065c183cc02b
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=5df379aa748528b394de3a483c10bfa9b2fd420d2d5a7247be18b9b71b1741
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=73a0c4086f45b89ac5ac48564363e3cce8449b2d2c7cf71adadb6258119771

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f13e539dc67cfd7c8bed15eb755b3e70
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c63f46ef1a4531b36b6d9d933fc6d97a929ba3fce60a9523228c4df6745d30
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=daa224045edb5559f94be878b2de124313b1e157fa49295925143dca42782b

            handshake=Noise_K_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541f0499b194617954a3a8ba6d2ccb66ba883621b78eb1ccb78060
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=8f37d99ddd83fcfad851544fadbbd9f83a21cb504f79a040f0db0ef406a2cb
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8b69be08bbd320ce82a65b1ac6013f3aada9a0e64e53b0f9de55a83e0fd4e2

            handshake=Noise_Kpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549832db195cc1e003857cf56e834a296df1104de185a7b9129a7e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=5df379aa748528b394de3a483c10bfa9b2fd420d2d5a7247be18b9b71b1741
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=73a0c4086f45b89ac5ac48564363e3cce8449b2d2c7cf71adadb6258119771

            handshake=Noise_Kpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549ad2b6a5f66290516660fc7bf731ab1516ae6fe1723e6a8fbaeb
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c63f46ef1a4531b36b6d9d933fc6d97a929ba3fce60a9523228c4df6745d30
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=daa224045edb5559f94be878b2de124313b1e157fa49295925143dca42782b
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_K_25519_AESGCM_SHA256() throws {
        let vectors = """
            handshake=Noise_K_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cc4041bbf40e26aea2c61f36b29dfda1
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=aca1ae00ed718c11ae8f91c3c289db54dca4fba284098248984158f4afb15a
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=334cde4d2b9e7189be333e05c4e8ca8cbe9a7e9e3170dc61abf51906f95f9b

            handshake=Noise_Kpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f6463591c0d8b8fd209cf3c80579bfed
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=7736979bc1fc8d5c7d42c92ea41ee59e97d59faafe791a2e3d58c8e8fb9929
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03236fadebc8f6a18ecb878d1ac2b78a3cf0e0024d0fb5d8b9d105ea194980

            handshake=Noise_Kpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254443d03b8955d57e4fcbdf961645c0db9
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1429bc785fdc4adc51006b72f574c963bc97309e22feb0b54f8b944292af3b
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=c74d5a471091962d858c65542df842172e2e95a85bfe0eea2c6be86c8bfd89

            handshake=Noise_K_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625428f2b400a063dbdce02b182da650e11fdf8ee63bffbdb9263e2d
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=aca1ae00ed718c11ae8f91c3c289db54dca4fba284098248984158f4afb15a
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=334cde4d2b9e7189be333e05c4e8ca8cbe9a7e9e3170dc61abf51906f95f9b

            handshake=Noise_Kpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c2b61d59cbbc7e45c9743b816be7edfacba1a21c0b4ea6499687
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=7736979bc1fc8d5c7d42c92ea41ee59e97d59faafe791a2e3d58c8e8fb9929
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03236fadebc8f6a18ecb878d1ac2b78a3cf0e0024d0fb5d8b9d105ea194980

            handshake=Noise_Kpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549b08ff5e93b809df01a6974598eabce902b5dca3bef8fdd0ae9f
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1429bc785fdc4adc51006b72f574c963bc97309e22feb0b54f8b944292af3b
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=c74d5a471091962d858c65542df842172e2e95a85bfe0eea2c6be86c8bfd89

            handshake=Noise_K_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545452dfe8670e01ec6c7ddf716617ac9e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=aca1ae00ed718c11ae8f91c3c289db54dca4fba284098248984158f4afb15a
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=334cde4d2b9e7189be333e05c4e8ca8cbe9a7e9e3170dc61abf51906f95f9b

            handshake=Noise_Kpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254091a3df37d8ffa0d9c758bac64d545e2
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=7736979bc1fc8d5c7d42c92ea41ee59e97d59faafe791a2e3d58c8e8fb9929
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03236fadebc8f6a18ecb878d1ac2b78a3cf0e0024d0fb5d8b9d105ea194980

            handshake=Noise_Kpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625467fbf473495da6b5e23acf5bb6fe9b22
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1429bc785fdc4adc51006b72f574c963bc97309e22feb0b54f8b944292af3b
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=c74d5a471091962d858c65542df842172e2e95a85bfe0eea2c6be86c8bfd89

            handshake=Noise_K_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625428f2b400a063dbdce02b5c28836b6e5fda2325068eb862efefce
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=aca1ae00ed718c11ae8f91c3c289db54dca4fba284098248984158f4afb15a
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=334cde4d2b9e7189be333e05c4e8ca8cbe9a7e9e3170dc61abf51906f95f9b

            handshake=Noise_Kpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c2b61d59cbbc7e45c974869c028f5d84ed2aef938dd851ef00bd
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=7736979bc1fc8d5c7d42c92ea41ee59e97d59faafe791a2e3d58c8e8fb9929
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=03236fadebc8f6a18ecb878d1ac2b78a3cf0e0024d0fb5d8b9d105ea194980

            handshake=Noise_Kpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549b08ff5e93b809df01a6287cee688e3c750260ad541a39378ee2
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1429bc785fdc4adc51006b72f574c963bc97309e22feb0b54f8b944292af3b
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=c74d5a471091962d858c65542df842172e2e95a85bfe0eea2c6be86c8bfd89
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_K_25519_AESGCM_SHA512() throws {
        let vectors = """
            handshake=Noise_K_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d181b2326033180d1efb21521b324a92
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=344e43356f1c93c5c345ff96d7671dc700a99d4c1a1e74a1fa6658219a7297
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=93a8163f0e969702549d39bae62a6f15eee1416ad8c1cbd5b545d77145cb16

            handshake=Noise_Kpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543f880385cbbd4e4627713122b83ca89e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=b60ace60531354a67160d9606e0db5d1a2a5949c7cd4bad2ab72bded373f09
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8de8b083b7c4450eadd4d2303cdff7325a8bd5fc54cb13054148818922c255

            handshake=Noise_Kpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254bbd32e924225d5cd2f1e57426c23b774
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=13d2fe35d850dd95b05d9368e3cb118febf832bbc8d80810838747b10cbefc
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=970e52003f0ec0f427e4221354eb9ed099864d15a59ae15ed0b732843eb7c8

            handshake=Noise_K_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c5672a9d770969769874994bbccf28d4db2f626566d3c3216351
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=344e43356f1c93c5c345ff96d7671dc700a99d4c1a1e74a1fa6658219a7297
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=93a8163f0e969702549d39bae62a6f15eee1416ad8c1cbd5b545d77145cb16

            handshake=Noise_Kpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544d8c11d84ff6ad4c09d4701841b7e57b976b0012be26f3a63234
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=b60ace60531354a67160d9606e0db5d1a2a5949c7cd4bad2ab72bded373f09
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8de8b083b7c4450eadd4d2303cdff7325a8bd5fc54cb13054148818922c255

            handshake=Noise_Kpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f6b065ba9cc0c626743f51ce46f94d811eb9452378e4517d832e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=13d2fe35d850dd95b05d9368e3cb118febf832bbc8d80810838747b10cbefc
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=970e52003f0ec0f427e4221354eb9ed099864d15a59ae15ed0b732843eb7c8

            handshake=Noise_K_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254915e0cc0990344b65cbda0733b24186c
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=344e43356f1c93c5c345ff96d7671dc700a99d4c1a1e74a1fa6658219a7297
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=93a8163f0e969702549d39bae62a6f15eee1416ad8c1cbd5b545d77145cb16

            handshake=Noise_Kpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254beaf955b2e97b63a40e509e098e86d26
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=b60ace60531354a67160d9606e0db5d1a2a5949c7cd4bad2ab72bded373f09
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8de8b083b7c4450eadd4d2303cdff7325a8bd5fc54cb13054148818922c255

            handshake=Noise_Kpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625406637d84bb2b8bacf583b157b5e2db6e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=13d2fe35d850dd95b05d9368e3cb118febf832bbc8d80810838747b10cbefc
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=970e52003f0ec0f427e4221354eb9ed099864d15a59ae15ed0b732843eb7c8

            handshake=Noise_K_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c5672a9d7709697698742cd70ec0be61893c6605698abea0e701
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=344e43356f1c93c5c345ff96d7671dc700a99d4c1a1e74a1fa6658219a7297
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=93a8163f0e969702549d39bae62a6f15eee1416ad8c1cbd5b545d77145cb16

            handshake=Noise_Kpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544d8c11d84ff6ad4c09d4d1c82d14bc3fcc12126c67b2a0b7ed61
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=b60ace60531354a67160d9606e0db5d1a2a5949c7cd4bad2ab72bded373f09
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=8de8b083b7c4450eadd4d2303cdff7325a8bd5fc54cb13054148818922c255

            handshake=Noise_Kpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f6b065ba9cc0c626743f16dad8f22e8694edcec128ad0134b91f
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=13d2fe35d850dd95b05d9368e3cb118febf832bbc8d80810838747b10cbefc
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=970e52003f0ec0f427e4221354eb9ed099864d15a59ae15ed0b732843eb7c8
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }
}
