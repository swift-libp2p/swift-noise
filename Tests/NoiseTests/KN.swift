//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class KN_Handshake_Tests: XCTestCase {
    
    func test_Noise_KN_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_KN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f99627c2b9a34dc2e78efc21ea6d09e0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=440ade028b567ce045b4a367bc7644ba49ff120f2e704abe4be8ce31a43c0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=644df69c08e6c5b832b7b34b54a7e616efc276686ea257ca570c7b0af25e03

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549d36baa6dbd5bae534893a1691872bff
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466eec752b6d790962a0adb9fa92948a16f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=58d034db684b5b9548fa8a2596d5ef48bdc0827f3c936757f824f25190410c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5987d3cbe26bcf75946a86d0555108608e7ed18325dd60fe7d4fd200ee741d

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545c1042a1c7e8f74e1c96e053fc8ca7d4
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466458d2cdf33b1fbee339147985abf0afa
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7474619bc60a98042cc7bce09f4f631f20af421de18fc434457e2fb7f9e48e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00783db976d144d85fb4dbb341e908748eb0bc90123fcf4162b10cd34277ef

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541c91264cfdb8fc6b8804d45a55b62a8b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846696ab554cdc752c12efb617a2bbb548d0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d65a6ebbe3f38a2f2de8529b5203ed2668cbcefc48219fce3f2414bf3b2bdb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cdef5b6bd32cdca6ebfe2a3b697caadc3099b9e820eb1c9d27d28b6ed99138

        handshake=Noise_KN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c39ce1d8e1bc7d551d60e0f13021b569aaf063bbfbaeb5df1d48
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=440ade028b567ce045b4a367bc7644ba49ff120f2e704abe4be8ce31a43c0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=644df69c08e6c5b832b7b34b54a7e616efc276686ea257ca570c7b0af25e03

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d9e492b73ab5e7b411ca24b530505ed9f9a7434b7fb9e3942543
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466faed543a83225ae87e5f7b9ed811dd5a5bea64334ddf210e18b4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=58d034db684b5b9548fa8a2596d5ef48bdc0827f3c936757f824f25190410c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5987d3cbe26bcf75946a86d0555108608e7ed18325dd60fe7d4fd200ee741d

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548b78fe393615d3918bb58f0884d2d372e53e4851ce80e67fe922
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466273122b0e5f91c8b4a7ef2d5a964eb79bc00a41011e068557be1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7474619bc60a98042cc7bce09f4f631f20af421de18fc434457e2fb7f9e48e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00783db976d144d85fb4dbb341e908748eb0bc90123fcf4162b10cd34277ef

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d738849e4f8635b57bf99e438b655ab0cdd92b50c3eb8a38fa47
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466874006ee8e970d1140a893ddd52de47e27b95d0f17bd424122fd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d65a6ebbe3f38a2f2de8529b5203ed2668cbcefc48219fce3f2414bf3b2bdb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cdef5b6bd32cdca6ebfe2a3b697caadc3099b9e820eb1c9d27d28b6ed99138

        handshake=Noise_KN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484667f658a41f0ba1afd9c3df2bc05eb14e0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=440ade028b567ce045b4a367bc7644ba49ff120f2e704abe4be8ce31a43c0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=644df69c08e6c5b832b7b34b54a7e616efc276686ea257ca570c7b0af25e03

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544914ec3c41b58c96b596001a8abe3938
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668f00eba16f40a2355d414ed7b0bab565
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=58d034db684b5b9548fa8a2596d5ef48bdc0827f3c936757f824f25190410c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5987d3cbe26bcf75946a86d0555108608e7ed18325dd60fe7d4fd200ee741d

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a01257cd75ea9e8e2fe8a59205962271
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846680d63539016c3cf1e09fe3440be095d6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7474619bc60a98042cc7bce09f4f631f20af421de18fc434457e2fb7f9e48e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00783db976d144d85fb4dbb341e908748eb0bc90123fcf4162b10cd34277ef

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254677a7c6247070ec793bfa8ea24a40134
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466931ff9b08ae6a9b92eab49565d39c990
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d65a6ebbe3f38a2f2de8529b5203ed2668cbcefc48219fce3f2414bf3b2bdb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cdef5b6bd32cdca6ebfe2a3b697caadc3099b9e820eb1c9d27d28b6ed99138

        handshake=Noise_KN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c39ce1d8e1bc7d551d6096fc00a1fb421a5a36483878f3112caa
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=440ade028b567ce045b4a367bc7644ba49ff120f2e704abe4be8ce31a43c0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=644df69c08e6c5b832b7b34b54a7e616efc276686ea257ca570c7b0af25e03

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d9e492b73ab5e7b411ca38a73ec25f1334931010f25867aa8dd2
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466faed543a83225ae87e5f4fa930e2a1af4d46cb19721cc97cddd9
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=58d034db684b5b9548fa8a2596d5ef48bdc0827f3c936757f824f25190410c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5987d3cbe26bcf75946a86d0555108608e7ed18325dd60fe7d4fd200ee741d

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548b78fe393615d3918bb584c160d00bae8672e05bb010987c999f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466273122b0e5f91c8b4a7e9e8a59e9c89269df77d30fbeaec514c2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7474619bc60a98042cc7bce09f4f631f20af421de18fc434457e2fb7f9e48e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00783db976d144d85fb4dbb341e908748eb0bc90123fcf4162b10cd34277ef

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d738849e4f8635b57bf9f7c2d1cce4db786552b21fc809e097b9
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466874006ee8e970d1140a8eee4c4694467251fe8db35416cf00ff2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d65a6ebbe3f38a2f2de8529b5203ed2668cbcefc48219fce3f2414bf3b2bdb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cdef5b6bd32cdca6ebfe2a3b697caadc3099b9e820eb1c9d27d28b6ed99138
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_KN_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_KN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a05b47c8265d4ab0222de8450c1a67fc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f3c9fbbd304f284cbf067f089801a6cbdefa9ec68ce8a186b3ec6198eff1b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e4508095fd5fa73c415d881b7b7b5519a522c358eaee583f65379a82746c72

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a605358c47ddb81dd2a4c82b4c275e2d
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ce6754e492246db11d29b0ebfd513bc4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=216cfab041942d740699e1d9b13b70be15efd1842776ae8bbbcff63e5ab6f3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4f390f1ed96ab34cc1ad8e419f44afb39d6c152556d04fd8285e16480f4542

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541786642ee04970b496f2d5463b0aabb0
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846647a2b31a6688efaff36c8fa66ee16eac
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d71742981c22266f55a203db331274afe42f2fcbb53cd54743f0eb4b09112b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=896562cb84ade13be47e2cd28b0244f4006df84781d971b8ddd0383395adc0

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625490b21825eee9e45abc6ff262aca6e634
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846684e4d22747f1a8b988b94cb283b34885
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bfe4815658302d4f593705a806e1102e3a2a0a36dc847aa612586a035edaa3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=dc23a01b665cafc7c1baafeda8e705ee9e0f8a0f1f4c9b89814cb747274c08

        handshake=Noise_KN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac57ebc5143d3134c5674a209111f914f49e33f0c29b6e232822
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f3c9fbbd304f284cbf067f089801a6cbdefa9ec68ce8a186b3ec6198eff1b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e4508095fd5fa73c415d881b7b7b5519a522c358eaee583f65379a82746c72

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543cd51e47fb9aa475e18e123b157d4e9ee222e358cc22e19916a3
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846647dfb3375c1e7beabafacf5cd875d25dbfbe5d5fd5762503b6cc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=216cfab041942d740699e1d9b13b70be15efd1842776ae8bbbcff63e5ab6f3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4f390f1ed96ab34cc1ad8e419f44afb39d6c152556d04fd8285e16480f4542

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543fb5766cc4bc875a8c94708eed1c40bad1376f555482ee213c4c
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466eeb430d11573629ee9f48689ee97e44a23404b52878c01f8129d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d71742981c22266f55a203db331274afe42f2fcbb53cd54743f0eb4b09112b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=896562cb84ade13be47e2cd28b0244f4006df84781d971b8ddd0383395adc0

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254033b7a5813ca73b834666f8c07644ac14f8bccffe995d2ded587
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c95ee12179a4d001f6e0beb00425609cf2cd7a7f17766a623f53
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bfe4815658302d4f593705a806e1102e3a2a0a36dc847aa612586a035edaa3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=dc23a01b665cafc7c1baafeda8e705ee9e0f8a0f1f4c9b89814cb747274c08

        handshake=Noise_KN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669d58ab3ea3c810e67a9e0bc3f8b31cad
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f3c9fbbd304f284cbf067f089801a6cbdefa9ec68ce8a186b3ec6198eff1b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e4508095fd5fa73c415d881b7b7b5519a522c358eaee583f65379a82746c72

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254028d29d14a56c53b7db28781e4b8e0ec
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669ce4da10e934ba7a166a6518c4d9fd18
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=216cfab041942d740699e1d9b13b70be15efd1842776ae8bbbcff63e5ab6f3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4f390f1ed96ab34cc1ad8e419f44afb39d6c152556d04fd8285e16480f4542

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625413e83f08edd08acd29015742d043f59b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466cab3cb9abaebcd0b566d2d3fdc38039a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d71742981c22266f55a203db331274afe42f2fcbb53cd54743f0eb4b09112b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=896562cb84ade13be47e2cd28b0244f4006df84781d971b8ddd0383395adc0

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625493a48efb4ac89aafa2eba5be4722b098
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846639b3e3cb2a7a8813f232329758728863
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bfe4815658302d4f593705a806e1102e3a2a0a36dc847aa612586a035edaa3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=dc23a01b665cafc7c1baafeda8e705ee9e0f8a0f1f4c9b89814cb747274c08

        handshake=Noise_KN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac57ebc5143d3134c567adc45d5a0da7645b723d3653a951aa1a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f3c9fbbd304f284cbf067f089801a6cbdefa9ec68ce8a186b3ec6198eff1b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e4508095fd5fa73c415d881b7b7b5519a522c358eaee583f65379a82746c72

        handshake=Noise_KNpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543cd51e47fb9aa475e18e4b5ca06c89b89d86120b3a6925871f0b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846647dfb3375c1e7beabafaaf3082b2bafc8456a2751912500c2a3a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=216cfab041942d740699e1d9b13b70be15efd1842776ae8bbbcff63e5ab6f3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4f390f1ed96ab34cc1ad8e419f44afb39d6c152556d04fd8285e16480f4542

        handshake=Noise_KNpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543fb5766cc4bc875a8c94660ba2bf08b944693946e4d1842d6003
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466eeb430d11573629ee9f4be8a75aae8683f5d5e87a90e4581f68e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d71742981c22266f55a203db331274afe42f2fcbb53cd54743f0eb4b09112b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=896562cb84ade13be47e2cd28b0244f4006df84781d971b8ddd0383395adc0

        handshake=Noise_KNpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254033b7a5813ca73b83466231a71a631b5aaa173c4529f435385b7
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c95ee12179a4d001f6e0b2073ec8b7c064daad044fdc8e3f9f2a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bfe4815658302d4f593705a806e1102e3a2a0a36dc847aa612586a035edaa3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=dc23a01b665cafc7c1baafeda8e705ee9e0f8a0f1f4c9b89814cb747274c08
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_KN_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_KN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466827d5016baa63241017945dea7aeb9be
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d8eb7e92e6ffa800b669953e5a1b99fe268df1161d7293a1c1836f7dd2d55b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=009f1432e8414277b5ddf687ae0daf50f76e24c5ed30b0d1e4af53544c70ad

        handshake=Noise_KNpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254169cf5ede5a37b6318901ccb41cfc0e6
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846625bfff2e7a6576de4563a805d0cc79ad
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e3cfa09d18879571feb6c1b8656bd2c1768f636b70f269473f795eb26efe04
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a2f6c5b843b9306af62414b072ef527322ee7c77fcbdcf3774c85a0f62ee29

        handshake=Noise_KNpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542b4b5f5a0d01587d693384d5fa9b816d
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e2b2821c8dd067005f3942c533057774
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2eba684f829bd3225ffd18163e51830268c3107086c6a5c6c8861324a84118
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00b6cddef82e1313dd1f4a5e2e63aff31c9a39160698ee7b81b00e72c20082

        handshake=Noise_KNpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543212e39efee8148627b3aeb4e1a997d2
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c1a5d67a8aa44d84bc1d1310365f02a5
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=17bb34185e6ca8171a04f52a87e4b372b2a0c871444050890b9e6d64775a30
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d607e4acbb0b137bb7956fe26d648088a9865b25376513351b0ed019e5c098

        handshake=Noise_KN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fc79472c53cf5dde06848020738862f3268987d895428bdd974b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d8eb7e92e6ffa800b669953e5a1b99fe268df1161d7293a1c1836f7dd2d55b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=009f1432e8414277b5ddf687ae0daf50f76e24c5ed30b0d1e4af53544c70ad

        handshake=Noise_KNpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d65483c2c037a3715bfd2e8bceb4633a3758a492725e6cb94082
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466653bddb937e507c9febf96843ce9aedca6013fb23cd2c54fd3cf
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e3cfa09d18879571feb6c1b8656bd2c1768f636b70f269473f795eb26efe04
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a2f6c5b843b9306af62414b072ef527322ee7c77fcbdcf3774c85a0f62ee29

        handshake=Noise_KNpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c7207c975f3cc6901b9d650f4f768838f45cb1899c96808a8b7c
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664685702a41068df357c8ba5150d0e340cde8073a959298579680
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2eba684f829bd3225ffd18163e51830268c3107086c6a5c6c8861324a84118
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00b6cddef82e1313dd1f4a5e2e63aff31c9a39160698ee7b81b00e72c20082

        handshake=Noise_KNpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d109459bac52bf108d0aeee64b8e84f04273f7423b0ae575df25
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665d5f1ae785b46ce05fded66b0c412e1d35aea492cdafed0410eb
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=17bb34185e6ca8171a04f52a87e4b372b2a0c871444050890b9e6d64775a30
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d607e4acbb0b137bb7956fe26d648088a9865b25376513351b0ed019e5c098

        handshake=Noise_KN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f4f7f9d6b31a498dbd6a5e3507e7dc97
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d8eb7e92e6ffa800b669953e5a1b99fe268df1161d7293a1c1836f7dd2d55b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=009f1432e8414277b5ddf687ae0daf50f76e24c5ed30b0d1e4af53544c70ad

        handshake=Noise_KNpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625439382eef6b7cd99fa9cd2ff31146a7e7
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fbb960fdc82cf9a7808990194e3c706b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e3cfa09d18879571feb6c1b8656bd2c1768f636b70f269473f795eb26efe04
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a2f6c5b843b9306af62414b072ef527322ee7c77fcbdcf3774c85a0f62ee29

        handshake=Noise_KNpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625404c68e7f550e27c9cc7b2c2edb4de4a7
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669ac747a0a01f904299ac44304fb4c552
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2eba684f829bd3225ffd18163e51830268c3107086c6a5c6c8861324a84118
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00b6cddef82e1313dd1f4a5e2e63aff31c9a39160698ee7b81b00e72c20082

        handshake=Noise_KNpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254546bebfef90b0b870b4e9596efcc7447
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664c8f298e9f683830ecef7654eac5efae
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=17bb34185e6ca8171a04f52a87e4b372b2a0c871444050890b9e6d64775a30
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d607e4acbb0b137bb7956fe26d648088a9865b25376513351b0ed019e5c098

        handshake=Noise_KN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fc79472c53cf5dde06842c7bbaddce7a78d729b83d1579fee94c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d8eb7e92e6ffa800b669953e5a1b99fe268df1161d7293a1c1836f7dd2d55b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=009f1432e8414277b5ddf687ae0daf50f76e24c5ed30b0d1e4af53544c70ad

        handshake=Noise_KNpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d65483c2c037a3715bfd42574061e8d814661165acbf6eedb5c6
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466653bddb937e507c9febfa60df671aeed8ee66f0e986dfeaa0865
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e3cfa09d18879571feb6c1b8656bd2c1768f636b70f269473f795eb26efe04
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a2f6c5b843b9306af62414b072ef527322ee7c77fcbdcf3774c85a0f62ee29

        handshake=Noise_KNpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c7207c975f3cc6901b9da3e1a6491825efcc2dd70646ab8cb898
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664685702a41068df357c8a9d8abd0235d963ad2dcf235a6f353f5
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2eba684f829bd3225ffd18163e51830268c3107086c6a5c6c8861324a84118
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=00b6cddef82e1313dd1f4a5e2e63aff31c9a39160698ee7b81b00e72c20082

        handshake=Noise_KNpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d109459bac52bf108d0a86488e517a3e603907489b5fc4a7311b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665d5f1ae785b46ce05fdea603c6ef38009c36fe4846c921c6326b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=17bb34185e6ca8171a04f52a87e4b372b2a0c871444050890b9e6d64775a30
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d607e4acbb0b137bb7956fe26d648088a9865b25376513351b0ed019e5c098
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_KN_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_KN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f72c1a277693fd38269f8a99291c5da2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f85b724b0d10b19b9f18ba74dc10bc28c187a1505e32a1b7ddb76fc381c60
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7b27b15d8102e55eb6b5e7c02d5c1309289aa197b383424bb8d70268d1270f

        handshake=Noise_KNpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544b68b11ecf5211c5fda412733efd29ca
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663cbd6e15bfac1b01f644ac427edfc442
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c41244c39a4dc4bbd816e4383b36aeb29b39b1a4cd3375c8ee7db0f744b131
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cbcc5c8eedfe981223357f4d43f13be03b9c6ee905ad052bb319a97d31e22c

        handshake=Noise_KNpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ed5eac382bc8e0e9fd781c2da8b87220
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466176a5de05f62ccb244d937a1aa4740e4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=90abc79cc783c1390801576ba8ef427a7cc56945b010efdd7b649ad1dbf654
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a414c63f43213f517dbe5b9ca2fe9013e406135d0b085f6718825d67d1b829

        handshake=Noise_KNpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c0bb61207231b261590226d6bd0ae06f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c2392623d2b637e821625b49207eeb58
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aaaeaecd7573c689b8d4ccbc5770cb22d0af475f726df807fc07e57aca7fe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=1ee45b0cdba6411256525be9e7e44e1042d2c5402d080fdd0de28944e38b2a

        handshake=Noise_KN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d680843f299d5b026581d284e8e375b8d3fb53a0e005ce9714f7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f85b724b0d10b19b9f18ba74dc10bc28c187a1505e32a1b7ddb76fc381c60
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7b27b15d8102e55eb6b5e7c02d5c1309289aa197b383424bb8d70268d1270f

        handshake=Noise_KNpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c078e4e4c58ada7cb779610e8a2238b1012f7082cb66c772cfc9
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ab8d646d386089d58257871d3f64ce46e5a812c674583d1ccdf4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c41244c39a4dc4bbd816e4383b36aeb29b39b1a4cd3375c8ee7db0f744b131
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cbcc5c8eedfe981223357f4d43f13be03b9c6ee905ad052bb319a97d31e22c

        handshake=Noise_KNpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254484735eb56d9c231711a4a49f1b0e91368939fe01abaafeda157
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466955eb77ae3722bb9b8c14c019d2261382b06c17e895bfe86f3dc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=90abc79cc783c1390801576ba8ef427a7cc56945b010efdd7b649ad1dbf654
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a414c63f43213f517dbe5b9ca2fe9013e406135d0b085f6718825d67d1b829

        handshake=Noise_KNpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254222c68cd4874356be9500e89b00ff544ace940b5729f086c3219
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f47863d9cb0059460bd645d3cf5c91821534a353e6358b048322
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aaaeaecd7573c689b8d4ccbc5770cb22d0af475f726df807fc07e57aca7fe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=1ee45b0cdba6411256525be9e7e44e1042d2c5402d080fdd0de28944e38b2a

        handshake=Noise_KN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466edfd9f5e801b157d7af36200f0962b2a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f85b724b0d10b19b9f18ba74dc10bc28c187a1505e32a1b7ddb76fc381c60
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7b27b15d8102e55eb6b5e7c02d5c1309289aa197b383424bb8d70268d1270f

        handshake=Noise_KNpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254017d026ae69e905da4fa3527befbe8a1
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c903feabcdd078005d691951aa948363
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c41244c39a4dc4bbd816e4383b36aeb29b39b1a4cd3375c8ee7db0f744b131
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cbcc5c8eedfe981223357f4d43f13be03b9c6ee905ad052bb319a97d31e22c

        handshake=Noise_KNpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d1ff777c50a19ec441934658f96590fb
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846654b54d2e6cdea2573e3a4b7e84607e8f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=90abc79cc783c1390801576ba8ef427a7cc56945b010efdd7b649ad1dbf654
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a414c63f43213f517dbe5b9ca2fe9013e406135d0b085f6718825d67d1b829

        handshake=Noise_KNpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d845f0d6e394c2c4577a7543e7e781c4
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665445832471db03c2530f8279f43e913b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aaaeaecd7573c689b8d4ccbc5770cb22d0af475f726df807fc07e57aca7fe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=1ee45b0cdba6411256525be9e7e44e1042d2c5402d080fdd0de28944e38b2a

        handshake=Noise_KN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d680843f299d5b0265815e4064f0df3ea5eeef9535edc1a29e1b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7f85b724b0d10b19b9f18ba74dc10bc28c187a1505e32a1b7ddb76fc381c60
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7b27b15d8102e55eb6b5e7c02d5c1309289aa197b383424bb8d70268d1270f

        handshake=Noise_KNpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c078e4e4c58ada7cb779bd109ef1e5c961b7ffb99ec6d65744b0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ab8d646d386089d5825772141b5d91cba7a101d5ce077f7eec01
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c41244c39a4dc4bbd816e4383b36aeb29b39b1a4cd3375c8ee7db0f744b131
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=cbcc5c8eedfe981223357f4d43f13be03b9c6ee905ad052bb319a97d31e22c

        handshake=Noise_KNpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254484735eb56d9c231711a830caaff9108765bb21ac3cfc49d99eb
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466955eb77ae3722bb9b8c17991fc2b411ec54030c87e11b2f67cf1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=90abc79cc783c1390801576ba8ef427a7cc56945b010efdd7b649ad1dbf654
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a414c63f43213f517dbe5b9ca2fe9013e406135d0b085f6718825d67d1b829

        handshake=Noise_KNpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254222c68cd4874356be9509397dc032d89ade799a5a2591d9a6b32
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f47863d9cb0059460bd69e5cf4f459a34ce682b7e725dbbedae3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aaaeaecd7573c689b8d4ccbc5770cb22d0af475f726df807fc07e57aca7fe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=1ee45b0cdba6411256525be9e7e44e1042d2c5402d080fdd0de28944e38b2a
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}
