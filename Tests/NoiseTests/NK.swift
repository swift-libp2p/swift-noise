//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class NK_Handshake_Tests: XCTestCase {
    
    func test_Noise_NK_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_NK_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254bb9e8fd1c92e99737291c111956e17ab
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d97cd906e611b305ce4c22ffd315b750
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9cfd3ddea89d9f445475098f834e572ec4a8c5e9be740dd92831ef6cf6fd9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5db2eb7c7b37b33cd42fd321e05d9048c9be3efa0ae3a8c76724307e7562ff

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254718a7d4c2e3c99dbf622a533aee2274f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c286f86f4a7cfd2b81fe3d1444add3f2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=01d0ab0f394923f44c3abad69154757bbf902c64c5219bf8c624d69b11c959
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2c2a431db9e64c43b6c0a520547bdd8e1368358c099345ab4969f1bb4a9299

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254afc9110414941f0b3fa72bd395095718
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669c069692405e7802986d04a3d2430961
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d7766291245b52e9d504ca48bc3fb1118bdf46179c1b9bd32c925493533b3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=11a8d0014a1f8b258deb81bed19ea97bec009031d6a7a374eba5528490926c

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f93a440c4497c8dc01d655826bc1e042
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846680f0334cb21d5a78f12947bb80c7735b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6647abf5c995fb4b851bfd63c8e699286071c1fc2559764335c6329e2bea0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89e20c2dca7e4c2202aa731271c5d2081164c86e7b365ca98465961e7113a6

        handshake=Noise_NK_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543e44c6b6a0a9a28f5daf1796ae55886ff960a634ddc73b72e7b0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666e1a02e46e9053fa2a81f648b1fee43c438299bba0e77bc34d08
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9cfd3ddea89d9f445475098f834e572ec4a8c5e9be740dd92831ef6cf6fd9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5db2eb7c7b37b33cd42fd321e05d9048c9be3efa0ae3a8c76724307e7562ff

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ca3238dddb5256cd690a81f68c59b5d5216a7806cc1e63fcdceb
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660aa92dceb01712153f8dbce8ba3752e32b0a055a3f56a4900e58
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=01d0ab0f394923f44c3abad69154757bbf902c64c5219bf8c624d69b11c959
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2c2a431db9e64c43b6c0a520547bdd8e1368358c099345ab4969f1bb4a9299

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b74e16d251935c4ba865774bfc2d3703bf09fe397d41b70e66b0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466668442074729cbc1afdd21edaed1bd0c2bfe8b0bbd4797e22a73
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d7766291245b52e9d504ca48bc3fb1118bdf46179c1b9bd32c925493533b3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=11a8d0014a1f8b258deb81bed19ea97bec009031d6a7a374eba5528490926c

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545b3af61cb5aa81f19c8ece0651d022203328454673d001ede6b8
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bf9e6c127466353179c7c004f953f2584b10238b823e7cc5e97c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6647abf5c995fb4b851bfd63c8e699286071c1fc2559764335c6329e2bea0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89e20c2dca7e4c2202aa731271c5d2081164c86e7b365ca98465961e7113a6

        handshake=Noise_NK_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254660f1a4e72e678e4b0bcacd08c2cc9f4
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669b3dc8f07dd44673e4833fc90ce1164e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9cfd3ddea89d9f445475098f834e572ec4a8c5e9be740dd92831ef6cf6fd9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5db2eb7c7b37b33cd42fd321e05d9048c9be3efa0ae3a8c76724307e7562ff

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625460387695ddb6a97647f93847e8923922
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466dd59aa9c3ee7803c98e3651db6b3e81b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=01d0ab0f394923f44c3abad69154757bbf902c64c5219bf8c624d69b11c959
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2c2a431db9e64c43b6c0a520547bdd8e1368358c099345ab4969f1bb4a9299

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544259ae3d24d8665ff7ce9256b701954c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c3d5626dcdd6dbd0ef679f92fa2f4518
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d7766291245b52e9d504ca48bc3fb1118bdf46179c1b9bd32c925493533b3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=11a8d0014a1f8b258deb81bed19ea97bec009031d6a7a374eba5528490926c

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b9cfbfa816d97f7a4c47a7a9f8ecc6ac
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661629749d9a9c1558d3a8027a81a7b97f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6647abf5c995fb4b851bfd63c8e699286071c1fc2559764335c6329e2bea0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89e20c2dca7e4c2202aa731271c5d2081164c86e7b365ca98465961e7113a6

        handshake=Noise_NK_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543e44c6b6a0a9a28f5dafb35dfe4f2cf52995fadd57f0a4006d1c
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666e1a02e46e9053fa2a81414fd4a5bd34dbd73cb3a6e1b896bce6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9cfd3ddea89d9f445475098f834e572ec4a8c5e9be740dd92831ef6cf6fd9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5db2eb7c7b37b33cd42fd321e05d9048c9be3efa0ae3a8c76724307e7562ff

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ca3238dddb5256cd690ae943692a4c055f22d3dd834ea90edfd8
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660aa92dceb01712153f8d214f8f71c03c898cbd891e751f10d132
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=01d0ab0f394923f44c3abad69154757bbf902c64c5219bf8c624d69b11c959
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2c2a431db9e64c43b6c0a520547bdd8e1368358c099345ab4969f1bb4a9299

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b74e16d251935c4ba86516dfd74e045ff1c291281bcaa9362d00
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466668442074729cbc1afddf5f76f8ec753aa54926873c9096709c3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d7766291245b52e9d504ca48bc3fb1118bdf46179c1b9bd32c925493533b3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=11a8d0014a1f8b258deb81bed19ea97bec009031d6a7a374eba5528490926c

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545b3af61cb5aa81f19c8e33d34af062c6a72f793a6612ed12887f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bf9e6c127466353179c7c97611f0c4ac0ac3142512e76f650851
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6647abf5c995fb4b851bfd63c8e699286071c1fc2559764335c6329e2bea0f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89e20c2dca7e4c2202aa731271c5d2081164c86e7b365ca98465961e7113a6
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_NK_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_NK_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541ae9c9a6658068e796f1609d0738cf24
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666a553cbfe29b06c54b679290a63b357e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e81871e9c00f0153758cddbae509bd548b0f5a02eab4751107842ef6b6a93c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=16cbc8684ec246d78a72c6421aa737ed4441ac751cdd4510617decffe89dfd

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254098cdd7308257dd69233ab7d725ee8bc
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668edb3682137234dad14a8b4c8866e03d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7cb6cbbbddfefdc4d030ab94ab2aab13422ef4d87e054a08bb10da446c6f36
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e3926ab002f3c5051150d49e11388040a8397644b461aed00fad63e8023241

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cbd6c6755faedda9da18ea3a14dbb128
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664c48eb806966bdd24e98fe421b3d4815
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=1193e531aed0c1f9c475668bc5420beb3ee15f3520931d4a283185763289fa
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d4b9ff958655454654452cfc613b0b9a7fd7dac8aae5f1f0382edba43b0d1a

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625486bf3bfeb6861b365528620b68992d7b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668acd99b4cbc7ce0c14ff2be16afc02bf
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=65fd72393fd5065a54fa40313eaf8b7a052631aaf3f7368622f909aff8f4e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=28de903b3a3f50fd29d23549b726ddeb4c16f7db17c1757b4dd8d54ecfd8a2

        handshake=Noise_NK_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625490f8f004794122bca779d9bedcc39b7bfb88883f6a56029320aa
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e93b0314d9d7741d4e27466c0dd7656cf06185f352ffe422a67d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e81871e9c00f0153758cddbae509bd548b0f5a02eab4751107842ef6b6a93c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=16cbc8684ec246d78a72c6421aa737ed4441ac751cdd4510617decffe89dfd

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254686ba4c18195ad7d41e9992316453c355d139541985ab5a3966f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d153be7723be9f8b575546cf935485ad9ab67635c3570d782a7a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7cb6cbbbddfefdc4d030ab94ab2aab13422ef4d87e054a08bb10da446c6f36
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e3926ab002f3c5051150d49e11388040a8397644b461aed00fad63e8023241

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254210d5de7949ae573f825864efec44aec7e75233f354d162612d0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c58fd6fcb9ef1553a6b2f2800aeb72958e3cc8bbb74a7d21b9b2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=1193e531aed0c1f9c475668bc5420beb3ee15f3520931d4a283185763289fa
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d4b9ff958655454654452cfc613b0b9a7fd7dac8aae5f1f0382edba43b0d1a

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541c009a07ab83cf19c6e7f8cdce6b7810b8fd94271ebe94286d91
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ef6e6049aca18b319ec85d018f1abc9f9b886f0291177f84af35
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=65fd72393fd5065a54fa40313eaf8b7a052631aaf3f7368622f909aff8f4e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=28de903b3a3f50fd29d23549b726ddeb4c16f7db17c1757b4dd8d54ecfd8a2

        handshake=Noise_NK_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e84c76e8c7b65cb632b4b7e044462340
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665e44b83033cf4b6c0632338348ba3010
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e81871e9c00f0153758cddbae509bd548b0f5a02eab4751107842ef6b6a93c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=16cbc8684ec246d78a72c6421aa737ed4441ac751cdd4510617decffe89dfd

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254078dc0cb4f3e257498b0326b749ed738
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846611a2822f0742f8b8d78d49e4826d4768
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7cb6cbbbddfefdc4d030ab94ab2aab13422ef4d87e054a08bb10da446c6f36
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e3926ab002f3c5051150d49e11388040a8397644b461aed00fad63e8023241

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e2f9cfc860db48368e8e7b088ac14ac9
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663518375638c3a6f8b52d108e2eca0c65
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=1193e531aed0c1f9c475668bc5420beb3ee15f3520931d4a283185763289fa
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d4b9ff958655454654452cfc613b0b9a7fd7dac8aae5f1f0382edba43b0d1a

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625492ab9d1af417323e2bc1b5d5ab5a9795
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846626b056d1f03521f4218c4e423a14182b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=65fd72393fd5065a54fa40313eaf8b7a052631aaf3f7368622f909aff8f4e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=28de903b3a3f50fd29d23549b726ddeb4c16f7db17c1757b4dd8d54ecfd8a2

        handshake=Noise_NK_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625490f8f004794122bca7798750ae0cdabd48361711c1194a3a80ac
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e93b0314d9d7741d4e27e87d0ce6e3fe0f2b2b1c073a577dde57
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e81871e9c00f0153758cddbae509bd548b0f5a02eab4751107842ef6b6a93c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=16cbc8684ec246d78a72c6421aa737ed4441ac751cdd4510617decffe89dfd

        handshake=Noise_NKpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254686ba4c18195ad7d41e9353c11fdf8f2db2246391ecb8dd0fdf1
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d153be7723be9f8b575534d2a1f435076015a844d771ca0cf06b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7cb6cbbbddfefdc4d030ab94ab2aab13422ef4d87e054a08bb10da446c6f36
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e3926ab002f3c5051150d49e11388040a8397644b461aed00fad63e8023241

        handshake=Noise_NKpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254210d5de7949ae573f825ac5a5aebcfe6558f9de711f803dca24a
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c58fd6fcb9ef1553a6b208182eca4927db5b6ebede70e11c926f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=1193e531aed0c1f9c475668bc5420beb3ee15f3520931d4a283185763289fa
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d4b9ff958655454654452cfc613b0b9a7fd7dac8aae5f1f0382edba43b0d1a

        handshake=Noise_NKpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541c009a07ab83cf19c6e7468cbd4dd5693d61810307b3a1037ca2
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ef6e6049aca18b319ec8175c93ded5a053ed7324261bb7944cee
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=65fd72393fd5065a54fa40313eaf8b7a052631aaf3f7368622f909aff8f4e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=28de903b3a3f50fd29d23549b726ddeb4c16f7db17c1757b4dd8d54ecfd8a2
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_NK_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_NK_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625418e3e3b9a33b9d5f680ee08fbf20d03f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a2c11719e1aac7b6b2efc4871618f8bf
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95922788fcef822a17b42f450fa14d05d8e6a4377ca0aea3b4804f03db74a2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0976cd4a786c253b37489b6bc3867b2df0dddf9f939b218da54092c6d3eca4

        handshake=Noise_NKpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f965755a00eab9d92efbcdfbcc9e3b63
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c07c73cd24ea666246bc2ce129914dd3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=093acd47149fadf3574dd440428181edf9c61cc4a1b5ef815e8b779f1bbf40
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2b8e170039917a61d4fe8acbd2147d50afafc32070458b51b666225614f364

        handshake=Noise_NKpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625461500ecd7d2df0e7b6517f899a562cdd
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660c7c4d7f118e1fe8345ffceee554dc1b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=51fd5d7489dae3d6a99766db0afe89c1d19ed91a80b1bb64f94e747360fd2c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=be24f94a04505c8ab51768a80b388f2758ddab3b2fa3eebfeaceeff0130d78

        handshake=Noise_NKpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625498189a3c42ac5c0817de56867c43b2e5
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668f7ced987ac0a5d56835254fc6374a82
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d848f074d3d766c1a7770c51ceba699a16ad262790fc279e7dd2fcccfd4dca
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=51f74c4a80c3768dd6476fbb9c599efe5491567af3d18c8415d9d017821004

        handshake=Noise_NK_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546cfcd5c91dd95543a236cd276e885b5c7a1c3890ca630f06543e
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b3f3dd3e34414275ad733b2a5593f9b31485eecd7c12413912a9
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95922788fcef822a17b42f450fa14d05d8e6a4377ca0aea3b4804f03db74a2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0976cd4a786c253b37489b6bc3867b2df0dddf9f939b218da54092c6d3eca4

        handshake=Noise_NKpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625485932c8c7615c8263798b4f9d548cb656be5a4eb30cd9a0485c9
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466cce9cb21a513f9de326cba676712ee32441eb2146407fba7b57e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=093acd47149fadf3574dd440428181edf9c61cc4a1b5ef815e8b779f1bbf40
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2b8e170039917a61d4fe8acbd2147d50afafc32070458b51b666225614f364

        handshake=Noise_NKpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543f74b70b971271ffb3efb21dfeb1ea4ec9039c91a237de4027a5
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669920e429a6643b44e75fa65798b735a87d8c1edbd6013455a404
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=51fd5d7489dae3d6a99766db0afe89c1d19ed91a80b1bb64f94e747360fd2c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=be24f94a04505c8ab51768a80b388f2758ddab3b2fa3eebfeaceeff0130d78

        handshake=Noise_NKpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254537ac869369393768b2148856b6ab4aa465dbf8b6ff26007937a
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846695f32217406ccaa2da8f4a639bd9b5656007964aeaf74c7c377d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d848f074d3d766c1a7770c51ceba699a16ad262790fc279e7dd2fcccfd4dca
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=51f74c4a80c3768dd6476fbb9c599efe5491567af3d18c8415d9d017821004

        handshake=Noise_NK_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f256569b87bb96d615490cfa4ca93b30
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664918946d495163ba4efd4dfea52402eb
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95922788fcef822a17b42f450fa14d05d8e6a4377ca0aea3b4804f03db74a2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0976cd4a786c253b37489b6bc3867b2df0dddf9f939b218da54092c6d3eca4

        handshake=Noise_NKpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e6679a09e77ede865a31906c6f3c9537
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466833a2e7d79a0dbfc47f93bd7c4442646
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=093acd47149fadf3574dd440428181edf9c61cc4a1b5ef815e8b779f1bbf40
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2b8e170039917a61d4fe8acbd2147d50afafc32070458b51b666225614f364

        handshake=Noise_NKpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625402b4cfd1e0bc207c3f2a5459c6993328
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466065a03c65cc319c55bde1813028060ce
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=51fd5d7489dae3d6a99766db0afe89c1d19ed91a80b1bb64f94e747360fd2c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=be24f94a04505c8ab51768a80b388f2758ddab3b2fa3eebfeaceeff0130d78

        handshake=Noise_NKpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546de0aeb2f4a18513ac55eea1fbbe4de8
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846626379fd9720128b0dbbaa6734fd5b9e0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d848f074d3d766c1a7770c51ceba699a16ad262790fc279e7dd2fcccfd4dca
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=51f74c4a80c3768dd6476fbb9c599efe5491567af3d18c8415d9d017821004

        handshake=Noise_NK_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546cfcd5c91dd95543a2363b9bd07c092d8fff14687e5f48b43afc
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b3f3dd3e34414275ad73c9d7e1d03e86e1580404241350ed9ab1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95922788fcef822a17b42f450fa14d05d8e6a4377ca0aea3b4804f03db74a2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0976cd4a786c253b37489b6bc3867b2df0dddf9f939b218da54092c6d3eca4

        handshake=Noise_NKpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625485932c8c7615c82637987b6d1508724221d9ac49e27a147f5b20
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466cce9cb21a513f9de326ccb24b4012111db3db7d41383ad139bf4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=093acd47149fadf3574dd440428181edf9c61cc4a1b5ef815e8b779f1bbf40
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2b8e170039917a61d4fe8acbd2147d50afafc32070458b51b666225614f364

        handshake=Noise_NKpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543f74b70b971271ffb3ef260b21a3f29655bee689e501c2a16b89
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669920e429a6643b44e75f92aa79146466904a0217560ee27b49df
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=51fd5d7489dae3d6a99766db0afe89c1d19ed91a80b1bb64f94e747360fd2c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=be24f94a04505c8ab51768a80b388f2758ddab3b2fa3eebfeaceeff0130d78

        handshake=Noise_NKpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254537ac869369393768b21c12506b70b078d6cb28378d02e8d93af
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846695f32217406ccaa2da8ffcd2908a04cb425c65daad407f91f131
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d848f074d3d766c1a7770c51ceba699a16ad262790fc279e7dd2fcccfd4dca
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=51f74c4a80c3768dd6476fbb9c599efe5491567af3d18c8415d9d017821004
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_NK_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_NK_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f4de59ddee9ea99d5e8aa53446f9bac9
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846600c26d78fb1fda00ee777962da982403
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=3c3b3e1a1b22cdec195cb8c43f3d694269cd55421d0895cca7696e8c298c1c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=13d838829d7fb57425535f1586944638fc6bbf339797c76dca3220ef1ac3c6

        handshake=Noise_NKpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625442eba9e36fd2c74a614ad95028e3f5a0
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c4add52345e59d58759ba764f67ed9bc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=977b3bc4c37ed85bb2f14db182740fe80d5f46a53fdc0a94ab5c45c457524e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0c2b02468bfcafd95de5eb7f367545a23c4569540a3ad7c8f586f9df3906ca

        handshake=Noise_NKpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545bea413ae247b1489d5d76dc47a98732
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846680c1ccc3ceb11995d9a9c688519e916c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=dafa613d0ecf78ca534bf648499e98d5d3b22807a64149f12b45f27b397b16
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=917876a5cd379ec833d3b8e3bae24aaba92e63c316d40872b543fb60f9ad16

        handshake=Noise_NKpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c4be6444813fede19be6aef74e85031c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846607ef2728f791c670472e5a41e1e6b31f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eaf9eace39e81e51a53ae9eabd917d2605ce13bdcf089338a62b554225f230
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d0c1580eea13c076581792052cc5ea1617c4093fd54657130b273ccb55f1b9

        handshake=Noise_NK_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254479d6d76c8b559feebf4a71f42ce483ff0cf117f668906babd12
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846621612afe71fb7bc67dafcd0d83506c6becdad3daac83d5b90b24
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=3c3b3e1a1b22cdec195cb8c43f3d694269cd55421d0895cca7696e8c298c1c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=13d838829d7fb57425535f1586944638fc6bbf339797c76dca3220ef1ac3c6

        handshake=Noise_NKpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625410bac85a9bf99c7fdd478913e038b7ccc97518c9cad9e1533646
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e2cc032cc4ae7da4eda9f47aa7c37ad99015588c190bac9a8387
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=977b3bc4c37ed85bb2f14db182740fe80d5f46a53fdc0a94ab5c45c457524e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0c2b02468bfcafd95de5eb7f367545a23c4569540a3ad7c8f586f9df3906ca

        handshake=Noise_NKpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625482751e4f02de3f742d89f17b30414fb1151dd7eb34dba83103cf
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664376773ce777a22ce76c89b02c0c992849ecf119f5ecddb511c6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=dafa613d0ecf78ca534bf648499e98d5d3b22807a64149f12b45f27b397b16
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=917876a5cd379ec833d3b8e3bae24aaba92e63c316d40872b543fb60f9ad16

        handshake=Noise_NKpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542d0dcc1bd68cfc5ae3bd0b87c08f23c69ce1b3cccd83f5204db1
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466df4695624544314012baea976075677efc6eb4417112883ebd7c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eaf9eace39e81e51a53ae9eabd917d2605ce13bdcf089338a62b554225f230
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d0c1580eea13c076581792052cc5ea1617c4093fd54657130b273ccb55f1b9

        handshake=Noise_NK_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254bccd4635d2891ae46fa388fcb277b5bb
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668479b6648e2a13c0900168a46748457f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=3c3b3e1a1b22cdec195cb8c43f3d694269cd55421d0895cca7696e8c298c1c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=13d838829d7fb57425535f1586944638fc6bbf339797c76dca3220ef1ac3c6

        handshake=Noise_NKpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625446261dfdaaf4ca0a1e51254bbf6b3a71
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a1fae0771c98fdec558518fc919cbd4f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=977b3bc4c37ed85bb2f14db182740fe80d5f46a53fdc0a94ab5c45c457524e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0c2b02468bfcafd95de5eb7f367545a23c4569540a3ad7c8f586f9df3906ca

        handshake=Noise_NKpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ac3a9c9d8550f06f3de2b891e96395cb
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bf809f989b8fbf9c10f6d31438caa613
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=dafa613d0ecf78ca534bf648499e98d5d3b22807a64149f12b45f27b397b16
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=917876a5cd379ec833d3b8e3bae24aaba92e63c316d40872b543fb60f9ad16

        handshake=Noise_NKpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b9b01234febc4f0392461ae38c5ee4a8
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846661ff269ec62bf942fe8d6c85a773b1d2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eaf9eace39e81e51a53ae9eabd917d2605ce13bdcf089338a62b554225f230
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d0c1580eea13c076581792052cc5ea1617c4093fd54657130b273ccb55f1b9

        handshake=Noise_NK_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254479d6d76c8b559feebf467ad4b7003f368eb3929dca92e160bad
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846621612afe71fb7bc67daf8931a9010b74ab201a6ab9a6224cc78d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=3c3b3e1a1b22cdec195cb8c43f3d694269cd55421d0895cca7696e8c298c1c
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=13d838829d7fb57425535f1586944638fc6bbf339797c76dca3220ef1ac3c6

        handshake=Noise_NKpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625410bac85a9bf99c7fdd476360ac387c559fc40fa57bc0de8f2b03
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e2cc032cc4ae7da4eda923f9aad27b1e981be207dc57be28e47c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=977b3bc4c37ed85bb2f14db182740fe80d5f46a53fdc0a94ab5c45c457524e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0c2b02468bfcafd95de5eb7f367545a23c4569540a3ad7c8f586f9df3906ca

        handshake=Noise_NKpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625482751e4f02de3f742d89bba6ef6aea9975aae58faccbb8541cf7
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664376773ce777a22ce76c25463e4d298635ca65941beae4337859
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=dafa613d0ecf78ca534bf648499e98d5d3b22807a64149f12b45f27b397b16
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=917876a5cd379ec833d3b8e3bae24aaba92e63c316d40872b543fb60f9ad16

        handshake=Noise_NKpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542d0dcc1bd68cfc5ae3bd27ac7960aa606e9dec412a6c64323ea2
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466df4695624544314012ba66257a4a39bb5b6289e32409329b7bda
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eaf9eace39e81e51a53ae9eabd917d2605ce13bdcf089338a62b554225f230
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d0c1580eea13c076581792052cc5ea1617c4093fd54657130b273ccb55f1b9
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}
