//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class KX_Handshake_Tests: XCTestCase {
    
    func test_Noise_KX_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_KX_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846622be88163c561546e4bed5f7edf59c4a66de1b08618f33e5795acaac602ccefed747d2332f470a6322d692464a05fcd67cba64be6a7e2398b84f0874a7d27c38
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0bdd14922642db2bd89e286bac9a93db23f5677f0c21a2504d12a30ba345c9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=01d6ba6fa72b364f3595ecd4fcfd2163c6419dcaaf81400f2a2475841bf0d8

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d46828feccb106fce1347259efe3d560
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e10980f3530a4aaf3535bcd0434d86038c899f9f7eaa14ec3b953dfccd14f38eeceda506dac5ffaa99ff52fe7504945eb9b6072986d1e7120e06d3c1972f7180
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=10541bac3d4a63122a37a4f7b5dcfcc525e1181fc5dd8acc49d47583d318a8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=863dcf756c35668a469a0b54d4e1dfe6c8eb5731fefa8fd1ea01ee193ca65a

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254239128e9c724ebca8616533a70d2437b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666502920f436afe0924fb9e2089dae0157d3aece8be75d5e40c6c32324963763a5208664eb984e338151d464d04f944b15fc0cf85a10bb0c55d8971abe75aa2b3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f4df46901c83ffc83cb5a2b8e3f551f94413e760c545fe690c376fcc67d2c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6ae230f4066266b0d5acbd1f88e9a369008a22f37234bb29edccccd574835b

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254016d9bce67aca6fbde6cd635a26a793b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665707e22c0421b4143fb60cdb66d4abe8e9f9f96622ed7415a4bef49e881e6259ec92755a87cf9ae7807a98d2b99b2886a6afd2cf42f6ec465d945fceeaa6ca42
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ccf1e63eb05b5935b3925d91e55cc46e95c883af0c86ceb81b44679d63b8df
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=bfb507e53620a99a87de6c5118a296da629e71582b4315d3f9d276cd6d8123

        handshake=Noise_KX_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846622be88163c561546e4bed5f7edf59c4a66de1b08618f33e5795acaac602ccefea1671c0794e5e89f47225379b721d4ec0bff04812072f6475715344dbbf02f94c684290d67dbdbc8207d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0bdd14922642db2bd89e286bac9a93db23f5677f0c21a2504d12a30ba345c9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=01d6ba6fa72b364f3595ecd4fcfd2163c6419dcaaf81400f2a2475841bf0d8

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c3e81f3136465c96cebd9ede3119a58997cc9451cb028c655ffe
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e10980f3530a4aaf3535bcd0434d86038c899f9f7eaa14ec3b953dfccd14f38e945d19af90678c770e7fa5b44cf2f028a97d8dcafbf2716d9afdcfbbcb54a91f9a244f39bdc24b915afe
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=10541bac3d4a63122a37a4f7b5dcfcc525e1181fc5dd8acc49d47583d318a8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=863dcf756c35668a469a0b54d4e1dfe6c8eb5731fefa8fd1ea01ee193ca65a

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254326b26fa793456510d57c3fbdb793f6b4b818a362b84c1b66c8f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666502920f436afe0924fb9e2089dae0157d3aece8be75d5e40c6c32324963763a4a342ec239c8c23d581a3c32e692458a71115f8a46511990d9df9e566c592c7cd453946d482d1b0471ca
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f4df46901c83ffc83cb5a2b8e3f551f94413e760c545fe690c376fcc67d2c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6ae230f4066266b0d5acbd1f88e9a369008a22f37234bb29edccccd574835b

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548ae113e0354a922eba4fcd8f1779c9e2a7e299b5dd36d51a3a88
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665707e22c0421b4143fb60cdb66d4abe8e9f9f96622ed7415a4bef49e881e62592ad072445cec53458b1a2afe797bd4b04144407359790a257fcb9ab38935582670d3355072c7f3df624b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ccf1e63eb05b5935b3925d91e55cc46e95c883af0c86ceb81b44679d63b8df
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=bfb507e53620a99a87de6c5118a296da629e71582b4315d3f9d276cd6d8123

        handshake=Noise_KX_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846622be88163c561546e4bed5f7edf59c4a66de1b08618f33e5795acaac602ccefe8ac78598314baf570622d86009c726c36d35cf3d7a7d73b97b17feb38c3b39d8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0bdd14922642db2bd89e286bac9a93db23f5677f0c21a2504d12a30ba345c9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=01d6ba6fa72b364f3595ecd4fcfd2163c6419dcaaf81400f2a2475841bf0d8

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254af3f8d444ba03713f5022a823e640a91
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e10980f3530a4aaf3535bcd0434d86038c899f9f7eaa14ec3b953dfccd14f38e10d88a49863b30c39deeac932734a107a7dcd046a5c72e44ffe7568799d921d8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=10541bac3d4a63122a37a4f7b5dcfcc525e1181fc5dd8acc49d47583d318a8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=863dcf756c35668a469a0b54d4e1dfe6c8eb5731fefa8fd1ea01ee193ca65a

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625400e84c01aaed5f725ab7f61e29eeb91b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666502920f436afe0924fb9e2089dae0157d3aece8be75d5e40c6c32324963763a9c046b9524fcbdb33f1659ae34847bf2b199c8870b646a54304818f51af06071
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f4df46901c83ffc83cb5a2b8e3f551f94413e760c545fe690c376fcc67d2c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6ae230f4066266b0d5acbd1f88e9a369008a22f37234bb29edccccd574835b

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e705ff1f11873ffc5d577a6a5cf567e0
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665707e22c0421b4143fb60cdb66d4abe8e9f9f96622ed7415a4bef49e881e62597f5a32f7d06d14b6f025a25d9c5c4d4757d58ed15d8db3099ad8e3eb486f924c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ccf1e63eb05b5935b3925d91e55cc46e95c883af0c86ceb81b44679d63b8df
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=bfb507e53620a99a87de6c5118a296da629e71582b4315d3f9d276cd6d8123

        handshake=Noise_KX_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846622be88163c561546e4bed5f7edf59c4a66de1b08618f33e5795acaac602ccefee3df782d6947d1c911aac6358c29ee3a0bff04812072f6475715256b60c70ed7efb0e39e3228d109cc28
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0bdd14922642db2bd89e286bac9a93db23f5677f0c21a2504d12a30ba345c9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=01d6ba6fa72b364f3595ecd4fcfd2163c6419dcaaf81400f2a2475841bf0d8

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c3e81f3136465c96cebdfe53333e37d04b3ecfc1ce18c24d8655
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e10980f3530a4aaf3535bcd0434d86038c899f9f7eaa14ec3b953dfccd14f38e0d9282cf7902b2cf30bdc567ba9b58c2a97d8dcafbf2716d9afd88d956892efd1b1f7e4e9e43e5d33812
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=10541bac3d4a63122a37a4f7b5dcfcc525e1181fc5dd8acc49d47583d318a8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=863dcf756c35668a469a0b54d4e1dfe6c8eb5731fefa8fd1ea01ee193ca65a

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254326b26fa793456510d5783814b7b0b910fa84f2e03549260a3ff
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666502920f436afe0924fb9e2089dae0157d3aece8be75d5e40c6c32324963763a9e52ca3691a9bb4da162c6b52f63a33d71115f8a46511990d9dfae8beae37024a6d8f9d64a13ed725a88
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f4df46901c83ffc83cb5a2b8e3f551f94413e760c545fe690c376fcc67d2c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6ae230f4066266b0d5acbd1f88e9a369008a22f37234bb29edccccd574835b

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548ae113e0354a922eba4f54c106d22ef8b5012baa9d3f6282043e
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665707e22c0421b4143fb60cdb66d4abe8e9f9f96622ed7415a4bef49e881e62598c2243a2c57862be374df2bcf1dca08b4144407359790a257fcb737585008b71d92634ed2e0006947bf3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ccf1e63eb05b5935b3925d91e55cc46e95c883af0c86ceb81b44679d63b8df
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=bfb507e53620a99a87de6c5118a296da629e71582b4315d3f9d276cd6d8123
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_KX_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_KX_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846698119b787fffa4ac2c31f25455c130cf4de25f7384a93535288b79d7da78ad57dcedde22e3c3bfbdd4123468b03f56acebb709800aaf11ff0a383891f7e13e7f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=645d87cb21d68205c5d1d5ace656933772726dc15677fa66ecbb0d9e7c4a76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f5021dc910cb1c6c6c1789bc0e1383e616b8a0706ce7e8c9de0038b94c7ae3

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625420c520dc8393601629a9a4b0442dde86
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ff370f61dd7f82942851279f7749a086d1bf8d2975f632a8917f266aeb7a015ed99da110b6f09d00c39aad859dbca8df6235fbb88c5ef51a8e680b281421f61c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c7b22671faef802e2d77369ee735381ed398d69c460aaacf316284f3ef9aad
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=af44c5d5da5673e25de13a9f767e492ee14e50d7866252021d594b50de5482

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254171daeee62ba0080fa7246ee5640d14a
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c234402484dec5e7c50aa677ecc860e1006ed5575482ccc537336b0c0810c9761e8591300938fc3dd8280a499b8effe7b0f575edc0525bb334884f1c5a7f8a5d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=522cff6137e48e907204736ed64baeff2a255653a1f54cfc85c1fcb89a38e7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a0e5114517474c8aea753cd6286906b640d6504e446cc65840f91c2ae4ff2d

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625437cad4dcdeaad9e6c772f632ef0f0219
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662fe9957e4a8cf74cd95f22436f4cf0e40492e620ecef46cd0927053bea29b9fc3a446d8a8476c205ad279277e78b42fa40ab44a17da0ea17c7bdc385c52156d3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a8c3c1697a1444f8aaf5c1f30f8f47fe5f2edc883495d0a5fa03b5be468105
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=272a63fdf5bc0dac82c112f669218e7c0f49708ce1c24fcc16eaec673c8ffb

        handshake=Noise_KX_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846698119b787fffa4ac2c31f25455c130cf4de25f7384a93535288b79d7da78ad576c29eb2fc4fc0373ed8cf04ebe98c88763f453e22f5bf4fea56930d1b112a72635a554fb65faa2ac41b7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=645d87cb21d68205c5d1d5ace656933772726dc15677fa66ecbb0d9e7c4a76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f5021dc910cb1c6c6c1789bc0e1383e616b8a0706ce7e8c9de0038b94c7ae3

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548c42693ab9b2b64f32e396a1c5c1cf40666e2447991b4301219a
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ff370f61dd7f82942851279f7749a086d1bf8d2975f632a8917f266aeb7a015ed112c9698130c8f77715bb1606ee158a1bf0561b47f1fa3358fd7f873c8fb725b873f32a3a2b74818ad5
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c7b22671faef802e2d77369ee735381ed398d69c460aaacf316284f3ef9aad
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=af44c5d5da5673e25de13a9f767e492ee14e50d7866252021d594b50de5482

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625429641c04894b9a11f27d044ce0cd6700c86d74b6c6b2e0a36631
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c234402484dec5e7c50aa677ecc860e1006ed5575482ccc537336b0c0810c97614f780867dcfa660718c9445ddb0b18adb74ab7d4bb6da9bebc94b680fa2005464fb98609980ad19a71b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=522cff6137e48e907204736ed64baeff2a255653a1f54cfc85c1fcb89a38e7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a0e5114517474c8aea753cd6286906b640d6504e446cc65840f91c2ae4ff2d

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540a6409e4470fb6ff0e4814ec0d6311dcbdebc35784830d1fbed8
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662fe9957e4a8cf74cd95f22436f4cf0e40492e620ecef46cd0927053bea29b9fcfdc326f3f799fa284adde53c57a64e92a31ea878b11cc8a07a211d9d1a425caf0a49fb0a54759b386248
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a8c3c1697a1444f8aaf5c1f30f8f47fe5f2edc883495d0a5fa03b5be468105
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=272a63fdf5bc0dac82c112f669218e7c0f49708ce1c24fcc16eaec673c8ffb

        handshake=Noise_KX_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846698119b787fffa4ac2c31f25455c130cf4de25f7384a93535288b79d7da78ad57be7743fad001edc79215121d52d586527894eb7516dbd70d353c8174849e3fb7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=645d87cb21d68205c5d1d5ace656933772726dc15677fa66ecbb0d9e7c4a76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f5021dc910cb1c6c6c1789bc0e1383e616b8a0706ce7e8c9de0038b94c7ae3

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625447b7249372647d750def52e1c5e505de
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ff370f61dd7f82942851279f7749a086d1bf8d2975f632a8917f266aeb7a015e37746122f2158189601b656f82a28272f471a98dd3e9cb92f15dcb31b2d61afe
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c7b22671faef802e2d77369ee735381ed398d69c460aaacf316284f3ef9aad
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=af44c5d5da5673e25de13a9f767e492ee14e50d7866252021d594b50de5482

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549a46b6cc19675c81a7c17e59ae2fbb77
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c234402484dec5e7c50aa677ecc860e1006ed5575482ccc537336b0c0810c976a3e88fa64138fea30ee9b5dfb5f7edf054d75d4cb3788e22dc531cf95b5e2f48
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=522cff6137e48e907204736ed64baeff2a255653a1f54cfc85c1fcb89a38e7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a0e5114517474c8aea753cd6286906b640d6504e446cc65840f91c2ae4ff2d

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625419b10036434a604f7ad315181f250980
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662fe9957e4a8cf74cd95f22436f4cf0e40492e620ecef46cd0927053bea29b9fc64f37ec0795f68ed37302d9790f1282a4e9570c27bc6fba150347584f533aa77
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a8c3c1697a1444f8aaf5c1f30f8f47fe5f2edc883495d0a5fa03b5be468105
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=272a63fdf5bc0dac82c112f669218e7c0f49708ce1c24fcc16eaec673c8ffb

        handshake=Noise_KX_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846698119b787fffa4ac2c31f25455c130cf4de25f7384a93535288b79d7da78ad57d1ec426cdbfc40cc5b485727b8e8243463f453e22f5bf4fea56964b42c087e66e0d151039f27af53d4fd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=645d87cb21d68205c5d1d5ace656933772726dc15677fa66ecbb0d9e7c4a76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f5021dc910cb1c6c6c1789bc0e1383e616b8a0706ce7e8c9de0038b94c7ae3

        handshake=Noise_KXpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548c42693ab9b2b64f32e3c4cfe206c4b91682f9f8f6936fc9afbe
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ff370f61dd7f82942851279f7749a086d1bf8d2975f632a8917f266aeb7a015ee7c5ca712002095e484838ae25fd75461bf0561b47f1fa3358fdf8e83366ddb4923b44739185cea05565
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=c7b22671faef802e2d77369ee735381ed398d69c460aaacf316284f3ef9aad
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=af44c5d5da5673e25de13a9f767e492ee14e50d7866252021d594b50de5482

        handshake=Noise_KXpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625429641c04894b9a11f27da81cd77c9a037dcdb91e7d38713655de
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c234402484dec5e7c50aa677ecc860e1006ed5575482ccc537336b0c0810c9761e984ed70366c1429556ad81e7ffc621db74ab7d4bb6da9bebc94678f2c759019dd38f17f4672db5fe6b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=522cff6137e48e907204736ed64baeff2a255653a1f54cfc85c1fcb89a38e7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a0e5114517474c8aea753cd6286906b640d6504e446cc65840f91c2ae4ff2d

        handshake=Noise_KXpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540a6409e4470fb6ff0e4867ac27fa94e39def5fb9cff692b08053
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662fe9957e4a8cf74cd95f22436f4cf0e40492e620ecef46cd0927053bea29b9fc80694fe3959f5da3630331671ddae3d5a31ea878b11cc8a07a219cbdbb73011e081a82623aefd7500ebb
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a8c3c1697a1444f8aaf5c1f30f8f47fe5f2edc883495d0a5fa03b5be468105
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=272a63fdf5bc0dac82c112f669218e7c0f49708ce1c24fcc16eaec673c8ffb
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_KX_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_KX_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846651b9d60eb501f5efa797765be5facecd1b54777890c04bcbd4c363392ec8020c6574a4c4d6b72b0eb5e4f7ddfa581d58df144e59de159afb7c8c8c882873e8f6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=cef18cc9c074b7b65b0876c13b23ac88a40d8f0508e88ce059511c69cafe8e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2cb3ee4126b92633a230fa828a5d01e20577ad6957dbab9f547a0d321da1aa

        handshake=Noise_KXpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254fd769263bccd79587c7f736e1359352c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668140b6d6d8f57a44ea44a8faf051f109ab23fa8a11571923ab169aa41f1c145acaa50a4110b116973a047dc46fda6e45e79872d9a133db8635d3ef5f62c67f8c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=741d43d667af84da98ce714d05b47f025f58390989a6017c317d906d89cef3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=03cd0d03692885e37a8b0b6163e094c9a8d5a62383c15a0d43af0505985d69

        handshake=Noise_KXpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625494e6dc9266f412da8940e5f1ed2928a1
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a0bfaa51f5148f03b052ef9bcbe0a78ff41c171a105e9928b8eca5683674c22961d70956f724006d7c2c5f64c58fcc8b9e6d7c434b2bc8dfe67a122758b866ed
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=57271ed33c4dc921dde89c5e7920df0ab2a58361b19e4d6383e650da99e7fd
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4719d03ef8bd3d51202cb10d97d8ed9a449b928b50944e20fc749fdd36882a

        handshake=Noise_KXpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c9c7f6571bb640878ca69055b410af39
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664eb43ac79c1a09d29d9ee9abd60d01f24e07f95c9b57e6b228513d3b911a6bc5ad29b67154c895c55dca9525049a9c88bb1d43a542bd18b0ad443deb912abfdd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=97fb83aaf881a57aef8a2ee5c92067bfb12be1ca9ff96ec05801a17ab59dc1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5980f6c58e2c33192316ff9db9684a41f98cff4c921dd99d10a147888cab96

        handshake=Noise_KX_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846651b9d60eb501f5efa797765be5facecd1b54777890c04bcbd4c363392ec8020cffea7b7816cc8d3cbba422da8c5039188ad2715f430663cbef349f687f0f01cc0840853c3dd4a03ce7bc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=cef18cc9c074b7b65b0876c13b23ac88a40d8f0508e88ce059511c69cafe8e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2cb3ee4126b92633a230fa828a5d01e20577ad6957dbab9f547a0d321da1aa

        handshake=Noise_KXpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625479403368521b32d522b60c39847630ecef1bd89c190bd2cb44fb
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668140b6d6d8f57a44ea44a8faf051f109ab23fa8a11571923ab169aa41f1c145a32241706d4690b505402baf8a06ac03dc72401f783edd06f26aaa98ca33150b3f574651a160baec40c13
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=741d43d667af84da98ce714d05b47f025f58390989a6017c317d906d89cef3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=03cd0d03692885e37a8b0b6163e094c9a8d5a62383c15a0d43af0505985d69

        handshake=Noise_KXpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625456816aec771748a363fa2a63e3ea0a5168ce09326a42f6efc8b8
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a0bfaa51f5148f03b052ef9bcbe0a78ff41c171a105e9928b8eca5683674c229549745c7795addacbbf9c25b7cc5137f185ab372ec13f203d0fe6467406ad4cc76392bb4aee1f7c753b8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=57271ed33c4dc921dde89c5e7920df0ab2a58361b19e4d6383e650da99e7fd
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4719d03ef8bd3d51202cb10d97d8ed9a449b928b50944e20fc749fdd36882a

        handshake=Noise_KXpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625403f860c4b0e5d136c74ff866a7ebba59b63ddf4984282f9a193c
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664eb43ac79c1a09d29d9ee9abd60d01f24e07f95c9b57e6b228513d3b911a6bc58b6457503d60ae02750d4fddc6a3866ed9e2b7b665ba695e83536460bf805b4ed26df8efe3af02fd4d67
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=97fb83aaf881a57aef8a2ee5c92067bfb12be1ca9ff96ec05801a17ab59dc1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5980f6c58e2c33192316ff9db9684a41f98cff4c921dd99d10a147888cab96

        handshake=Noise_KX_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846651b9d60eb501f5efa797765be5facecd1b54777890c04bcbd4c363392ec8020c59dd8e8bebc235878d857c6d84f0a5338eb5d49142fed0d622590da2f9ea200d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=cef18cc9c074b7b65b0876c13b23ac88a40d8f0508e88ce059511c69cafe8e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2cb3ee4126b92633a230fa828a5d01e20577ad6957dbab9f547a0d321da1aa

        handshake=Noise_KXpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540fbdb18c265d797f42d7536d571f3473
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668140b6d6d8f57a44ea44a8faf051f109ab23fa8a11571923ab169aa41f1c145ad1708830ccf11c7e12c15ae550ba6b9ce92e7a01beb8af9f1ce00af37806dd10
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=741d43d667af84da98ce714d05b47f025f58390989a6017c317d906d89cef3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=03cd0d03692885e37a8b0b6163e094c9a8d5a62383c15a0d43af0505985d69

        handshake=Noise_KXpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546046313eb7d85b39691f62081c58167c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a0bfaa51f5148f03b052ef9bcbe0a78ff41c171a105e9928b8eca5683674c229fc6c0e0e58ca821feb64676b38238320161795720ff76f68a12f005fcb10d883
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=57271ed33c4dc921dde89c5e7920df0ab2a58361b19e4d6383e650da99e7fd
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4719d03ef8bd3d51202cb10d97d8ed9a449b928b50944e20fc749fdd36882a

        handshake=Noise_KXpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548b60f0d634971bb203b652ba1967b61a
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664eb43ac79c1a09d29d9ee9abd60d01f24e07f95c9b57e6b228513d3b911a6bc5e426a250b6d1851e0988cc7e1e3d719f9b071823a8e301e71894a3e769e1e9fa
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=97fb83aaf881a57aef8a2ee5c92067bfb12be1ca9ff96ec05801a17ab59dc1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5980f6c58e2c33192316ff9db9684a41f98cff4c921dd99d10a147888cab96

        handshake=Noise_KX_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846651b9d60eb501f5efa797765be5facecd1b54777890c04bcbd4c363392ec8020c7c436998be9c91ef0b5bf378deb15d158ad2715f430663cbef34c07c8fffbbe6e1d06b86643854167c10
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=cef18cc9c074b7b65b0876c13b23ac88a40d8f0508e88ce059511c69cafe8e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2cb3ee4126b92633a230fa828a5d01e20577ad6957dbab9f547a0d321da1aa

        handshake=Noise_KXpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625479403368521b32d522b66108a91f0ee0630b01d5e9d75894e97b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668140b6d6d8f57a44ea44a8faf051f109ab23fa8a11571923ab169aa41f1c145a15a68caffb32e07426fb150508d5a8edc72401f783edd06f26aa8076fe78659e21041dd0d33c189cefe9
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=741d43d667af84da98ce714d05b47f025f58390989a6017c317d906d89cef3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=03cd0d03692885e37a8b0b6163e094c9a8d5a62383c15a0d43af0505985d69

        handshake=Noise_KXpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625456816aec771748a363fa549a17755a6b8c1bd2ba5e506be3c0ad
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466a0bfaa51f5148f03b052ef9bcbe0a78ff41c171a105e9928b8eca5683674c22927af6ddc7a690cdb4d5a2980f751f89a185ab372ec13f203d0fea95291c45a6bd1ecd8d7646b9d8232d1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=57271ed33c4dc921dde89c5e7920df0ab2a58361b19e4d6383e650da99e7fd
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4719d03ef8bd3d51202cb10d97d8ed9a449b928b50944e20fc749fdd36882a

        handshake=Noise_KXpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625403f860c4b0e5d136c74f34c13ce247013edb3c379e4a24ac14df
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664eb43ac79c1a09d29d9ee9abd60d01f24e07f95c9b57e6b228513d3b911a6bc5668549e52bbb134d9ff2d80daea26b9dd9e2b7b665ba695e83538dfe52c654f53bcdc88eea727bffe4ce
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=97fb83aaf881a57aef8a2ee5c92067bfb12be1ca9ff96ec05801a17ab59dc1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5980f6c58e2c33192316ff9db9684a41f98cff4c921dd99d10a147888cab96
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_KX_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_KX_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846672f4561972c0066d2edb9ec3f6e06061d9efd85e8e09eea4f7b55e051881ed2d461f07a142019054861b74148fc944f2e8d3d02e24ba2ac639ffb67a06cf941c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b455e7160f810c5bc83b94c63932a10a218f6558daa7c9408d619d960d2796
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f2afc54621ee01e366836724674abfef6e64777e77ec15067c04d59d9209a4

        handshake=Noise_KXpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548430ae3a453831ae8a72cf799518925e
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846616cadc6a5849f99f04d636b30b52105083d64100bee3bb0069b4f03ee5528920b0e6c7d5cd255c95ce396140e6463b697b3fef9bb639280d1e8ef58e2cc57896
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95f4eba61bd217fca6eeac0a5a0a96f68e11a0d0c49dd2e288a8e4e2b17feb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7df0beb173488e9c5778a1af08cbff1aa3337839a0ece825a2a502a0b05bc0

        handshake=Noise_KXpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545c23b090b7eba082e987ffde36222281
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ea2829785aa59d7e2f1df56d98f6239f2a267a4c2001acb54d556932c40595e08d08fa0a460ac311e155c1961457907cc0a4d7e1108630ca5899c30604b20475
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=db708006c85bb5c1cdb6fab482f0179cb466ef1ac02d2a5d897ab5e93cda4e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8a2c4b83b0a27cce3a7347e01d5d11e47a2979bc41d5b8c4b7419640ef6afd

        handshake=Noise_KXpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625450e8db962a84fca6873e83064a5444db
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846661d4c7b7bc2b1ee4596b72cc8f00e533cfe7c236f9b8deb95ad7fd92c14165e5a8d3903706ccda48ece8fff18fd25fcbc7742a1ecbd81dee525c0bc58eb20fe0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=41c1facc56421dd154d1435a4f33d5b5a243d389e0b460bdf6ea6362a8dcb1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3aaefa2606543d87e25894c5eaed9eed40ceca80106c62822593046c03ae39

        handshake=Noise_KX_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846672f4561972c0066d2edb9ec3f6e06061d9efd85e8e09eea4f7b55e051881ed2d3c473a344d1071574c284e14408c92b58539d798b2be574927e85b225447321ee1eca1a9e701c541dfc4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b455e7160f810c5bc83b94c63932a10a218f6558daa7c9408d619d960d2796
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f2afc54621ee01e366836724674abfef6e64777e77ec15067c04d59d9209a4

        handshake=Noise_KXpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541a278e53378151225fdc24a27a0350908629f692f9235d8b579a
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846616cadc6a5849f99f04d636b30b52105083d64100bee3bb0069b4f03ee55289202bbe89689c2b31e623a1ff6083a686213eb28814fe4ae279902deca97b1bf6dd106c9b325fda721e8e45
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95f4eba61bd217fca6eeac0a5a0a96f68e11a0d0c49dd2e288a8e4e2b17feb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7df0beb173488e9c5778a1af08cbff1aa3337839a0ece825a2a502a0b05bc0

        handshake=Noise_KXpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541963a6cc03347872d41cd292b29b87d22c488ec89f15cadc0304
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ea2829785aa59d7e2f1df56d98f6239f2a267a4c2001acb54d556932c40595e0ff2d81ce4e2b85ccd5b50e3d9385951e978f1e633d310614bfa6c9af1eb5389105299f943c88ef268de0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=db708006c85bb5c1cdb6fab482f0179cb466ef1ac02d2a5d897ab5e93cda4e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8a2c4b83b0a27cce3a7347e01d5d11e47a2979bc41d5b8c4b7419640ef6afd

        handshake=Noise_KXpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b687a1a128f62ce6ad4869118737b15a42084f3c92aebc30d267
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846661d4c7b7bc2b1ee4596b72cc8f00e533cfe7c236f9b8deb95ad7fd92c14165e50a8d064f224ac761b6d7c1c6c8eb50293f03deb388775b780f1a4d2ab7129b40773b857884e7fa3781ba
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=41c1facc56421dd154d1435a4f33d5b5a243d389e0b460bdf6ea6362a8dcb1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3aaefa2606543d87e25894c5eaed9eed40ceca80106c62822593046c03ae39

        handshake=Noise_KX_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846672f4561972c0066d2edb9ec3f6e06061d9efd85e8e09eea4f7b55e051881ed2d1d615544c66e1cb785f80a256fa65b2fa178f825837d657176e150e7ce6f245c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b455e7160f810c5bc83b94c63932a10a218f6558daa7c9408d619d960d2796
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f2afc54621ee01e366836724674abfef6e64777e77ec15067c04d59d9209a4

        handshake=Noise_KXpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f158d8a926103237627624b7994e5cea
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846616cadc6a5849f99f04d636b30b52105083d64100bee3bb0069b4f03ee55289209cd64d6c3bbcf800f969aa8df01d86fe7072004c1b4554700eb5909209e0dab7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95f4eba61bd217fca6eeac0a5a0a96f68e11a0d0c49dd2e288a8e4e2b17feb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7df0beb173488e9c5778a1af08cbff1aa3337839a0ece825a2a502a0b05bc0

        handshake=Noise_KXpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543d791c8f0b6f7c80957817be26d2892d
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ea2829785aa59d7e2f1df56d98f6239f2a267a4c2001acb54d556932c40595e00680a79b2539691fef9292119bcf76716a9952ab10be0f6024bf192f1769921a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=db708006c85bb5c1cdb6fab482f0179cb466ef1ac02d2a5d897ab5e93cda4e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8a2c4b83b0a27cce3a7347e01d5d11e47a2979bc41d5b8c4b7419640ef6afd

        handshake=Noise_KXpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b9a3396c47f801921ad02dbae48fc985
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846661d4c7b7bc2b1ee4596b72cc8f00e533cfe7c236f9b8deb95ad7fd92c14165e594f70660f3cee9026c4f1dbad7e0f4ad0cbf817f2b3cb5e211e95723c228e6a8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=41c1facc56421dd154d1435a4f33d5b5a243d389e0b460bdf6ea6362a8dcb1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3aaefa2606543d87e25894c5eaed9eed40ceca80106c62822593046c03ae39

        handshake=Noise_KX_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846672f4561972c0066d2edb9ec3f6e06061d9efd85e8e09eea4f7b55e051881ed2dc41c3031529d4ad19d8b7d219ee949ba8539d798b2be574927e893bc2be2e90d5f23a332ce63e9b6af53
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b455e7160f810c5bc83b94c63932a10a218f6558daa7c9408d619d960d2796
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=f2afc54621ee01e366836724674abfef6e64777e77ec15067c04d59d9209a4

        handshake=Noise_KXpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541a278e53378151225fdcdac5afdbdd2dc7dedc8295b2873efbe7
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846616cadc6a5849f99f04d636b30b52105083d64100bee3bb0069b4f03ee55289203975f934fe65246ce4d017fc344204863eb28814fe4ae279902d812f17f5fdeec17d2be7cfe9c15fe371
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=95f4eba61bd217fca6eeac0a5a0a96f68e11a0d0c49dd2e288a8e4e2b17feb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=7df0beb173488e9c5778a1af08cbff1aa3337839a0ece825a2a502a0b05bc0

        handshake=Noise_KXpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541963a6cc03347872d41c5e0ed0f6f3e8e1bb772a98ffc1f921a3
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ea2829785aa59d7e2f1df56d98f6239f2a267a4c2001acb54d556932c40595e0add7a52cc2a82263c610384ed971faaf978f1e633d310614bfa6c7981a371f1daaf7743d4b65531bfac4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=db708006c85bb5c1cdb6fab482f0179cb466ef1ac02d2a5d897ab5e93cda4e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8a2c4b83b0a27cce3a7347e01d5d11e47a2979bc41d5b8c4b7419640ef6afd

        handshake=Noise_KXpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b687a1a128f62ce6ad483da6460c40931a96fa6bd046991ec6fa
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846661d4c7b7bc2b1ee4596b72cc8f00e533cfe7c236f9b8deb95ad7fd92c14165e5c17fef40ec942d9af58b9f2084f7d7343f03deb388775b780f1a06a1f31cd098cde068559214e75a9613
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=41c1facc56421dd154d1435a4f33d5b5a243d389e0b460bdf6ea6362a8dcb1
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3aaefa2606543d87e25894c5eaed9eed40ceca80106c62822593046c03ae39
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}

