//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import Crypto
import XCTest

@testable import Noise

final class X_Handshake_Tests: XCTestCase {

    func test_Noise_X_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
            handshake=Noise_X_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548cccfba3094925ef50f41bb45d6e69936ad15fcba0c3479a46afb577d3459497de729f4d8d615d5886e52f4f888dd49490ed46957206fa937490058feca88e4c
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=2e04749040fde470ab93dda9ca2d7dc69896d0c564d0898755a09830735187
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=11ca4c30bd3b563c23f5a5ae83844d038b1ae8ac7ed4e7e788ad9cdfb56c39

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546a25d60fc3551b45b422660fc5330a9a9a211a4c015192a4cb45f9e2736c0e75bb78c9f2817412a0d0644ce590aa15f91ed91cc1bf4db059be00aaea12d8ee2e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=6f84a4ede3160b3464efec0b87051e3555832871ffb6b3f3549461507068cf
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=83ac689c3ac344c2b7fbbaacc8d655c9ff0a1a89458b12ceb4510e80b5f9da

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625433e53e3ef1c689e4802f9453dd73c9402aa8072a810f934f7a466d2ede7d8ca7f8d22e80734349ab2e4fef536d0bc40c860a78498c16248c6d4121c7c68cd5e9
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=131094feaa8cbacb6c348050711162cf8d44b13e8de882c98410e7d3981d51
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=15fcd4e117342b9e651d6ab5048fd549fb38093e21fd369e1c6e630fbe9d24

            handshake=Noise_X_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548cccfba3094925ef50f41bb45d6e69936ad15fcba0c3479a46afb577d3459497de729f4d8d615d5886e52f4f888dd49486d56a823c51b82cc9bbf955b0358da74bdd0b077ee1f02b887f
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=2e04749040fde470ab93dda9ca2d7dc69896d0c564d0898755a09830735187
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=11ca4c30bd3b563c23f5a5ae83844d038b1ae8ac7ed4e7e788ad9cdfb56c39

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546a25d60fc3551b45b422660fc5330a9a9a211a4c015192a4cb45f9e2736c0e75bb78c9f2817412a0d0644ce590aa15f961bd13d0da02b4849bacd8ac61dcfa5bef1e7f6befb9ccdb30c1
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=6f84a4ede3160b3464efec0b87051e3555832871ffb6b3f3549461507068cf
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=83ac689c3ac344c2b7fbbaacc8d655c9ff0a1a89458b12ceb4510e80b5f9da

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625433e53e3ef1c689e4802f9453dd73c9402aa8072a810f934f7a466d2ede7d8ca7f8d22e80734349ab2e4fef536d0bc40c425ca4e756799dee05a7ed4e89dfa0920c4a847773f25c044e12
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=131094feaa8cbacb6c348050711162cf8d44b13e8de882c98410e7d3981d51
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=15fcd4e117342b9e651d6ab5048fd549fb38093e21fd369e1c6e630fbe9d24

            handshake=Noise_X_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548cccfba3094925ef50f41bb45d6e69936ad15fcba0c3479a46afb577d3459497a2b1b0c7f3c1107df1feeb7d2e340fd8d5f49ce97438f6953faa0fd6fa333a9e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=2e04749040fde470ab93dda9ca2d7dc69896d0c564d0898755a09830735187
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=11ca4c30bd3b563c23f5a5ae83844d038b1ae8ac7ed4e7e788ad9cdfb56c39

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546a25d60fc3551b45b422660fc5330a9a9a211a4c015192a4cb45f9e2736c0e75f6af9abf7f31d35f75534eac6e1181ed73faa6a26a1c01055d98b0f42b3e70d6
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=6f84a4ede3160b3464efec0b87051e3555832871ffb6b3f3549461507068cf
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=83ac689c3ac344c2b7fbbaacc8d655c9ff0a1a89458b12ceb4510e80b5f9da

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625433e53e3ef1c689e4802f9453dd73c9402aa8072a810f934f7a466d2ede7d8ca79f78c9011a748444af8a1d2ac4beffd3606f6e6109b0940a1b63b3f6d67e62d9
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=131094feaa8cbacb6c348050711162cf8d44b13e8de882c98410e7d3981d51
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=15fcd4e117342b9e651d6ab5048fd549fb38093e21fd369e1c6e630fbe9d24

            handshake=Noise_X_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548cccfba3094925ef50f41bb45d6e69936ad15fcba0c3479a46afb577d3459497a2b1b0c7f3c1107df1feeb7d2e340fd886d56a823c51b82cc9bbef609fcb249aa5dc6bfae8b03f645e11
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=2e04749040fde470ab93dda9ca2d7dc69896d0c564d0898755a09830735187
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=11ca4c30bd3b563c23f5a5ae83844d038b1ae8ac7ed4e7e788ad9cdfb56c39

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546a25d60fc3551b45b422660fc5330a9a9a211a4c015192a4cb45f9e2736c0e75f6af9abf7f31d35f75534eac6e1181ed61bd13d0da02b4849bac05762a942acd1f8196a3e9abd1804c1a
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=6f84a4ede3160b3464efec0b87051e3555832871ffb6b3f3549461507068cf
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=83ac689c3ac344c2b7fbbaacc8d655c9ff0a1a89458b12ceb4510e80b5f9da

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625433e53e3ef1c689e4802f9453dd73c9402aa8072a810f934f7a466d2ede7d8ca79f78c9011a748444af8a1d2ac4beffd3425ca4e756799dee05a737edccc12925ee623b4305c3410a3753
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=131094feaa8cbacb6c348050711162cf8d44b13e8de882c98410e7d3981d51
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=15fcd4e117342b9e651d6ab5048fd549fb38093e21fd369e1c6e630fbe9d24
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_X_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
            handshake=Noise_X_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254376c7107f9eb405171d2d1f3d248bce446063fa27b4685471cef3d72d2da8dea4a3e192003851247b8cd95003cccd0c58e96de55d37979fb46e5a502a7e8d6e7
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=95cd22713f4dc63780f443ddf8c584322d1f2e280dae8418c8a526a594e842
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=9e0f68ed156a13caecfc626ac6ab7516853fd098bc61c56216c95b8d7fc398

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542be0098b3b9dab8f530c810961603ba2f6a822cc78ac7eee268859f4df844553d30e3740165e3ae647bc0b502ee8e56a192bd7a7e255d12c4856c0d56857b688
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c08a79e514742f8589a1ebe18591620d753a930a6f712a8e052fde4f0eee37
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b2515711f8ce760c177220035b0693e0402e8b243720c39c2fa5c63d8fe506

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254da919bbbd48942dc8dbb313ccfdf9cbe55ada3842eecc44363f68c7f277f40b9cb22eab3c5e8a67218d9e1d23c7c3b468f6237c9a41c4b7e67549484fb3d2ebc
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5c617be1a77e3328ced09ee748203bbb7afb29b2c84fb20cf3b3a6d638197
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0c7261852346c160ee7df5a37ac9f3bad96737b841a6d544b39f3052e0dddd

            handshake=Noise_X_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254376c7107f9eb405171d2d1f3d248bce446063fa27b4685471cef3d72d2da8dea4a3e192003851247b8cd95003cccd0c552a973c425d8f07f60648804b7601dca1fdf628e900475030723
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=95cd22713f4dc63780f443ddf8c584322d1f2e280dae8418c8a526a594e842
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=9e0f68ed156a13caecfc626ac6ab7516853fd098bc61c56216c95b8d7fc398

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542be0098b3b9dab8f530c810961603ba2f6a822cc78ac7eee268859f4df844553d30e3740165e3ae647bc0b502ee8e56a81596dfb309c93b19d1534841d06d77ec854aab3070121504346
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c08a79e514742f8589a1ebe18591620d753a930a6f712a8e052fde4f0eee37
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b2515711f8ce760c177220035b0693e0402e8b243720c39c2fa5c63d8fe506

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254da919bbbd48942dc8dbb313ccfdf9cbe55ada3842eecc44363f68c7f277f40b9cb22eab3c5e8a67218d9e1d23c7c3b467b9fb8b2dd85bd90458553d745936beb7be4fbadae7aca179b16
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5c617be1a77e3328ced09ee748203bbb7afb29b2c84fb20cf3b3a6d638197
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0c7261852346c160ee7df5a37ac9f3bad96737b841a6d544b39f3052e0dddd

            handshake=Noise_X_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254376c7107f9eb405171d2d1f3d248bce446063fa27b4685471cef3d72d2da8deaa15d6a63c69270eccce4c01bcc449c6fcb8d33e0971f84f0bdd310d557ae81d8
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=95cd22713f4dc63780f443ddf8c584322d1f2e280dae8418c8a526a594e842
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=9e0f68ed156a13caecfc626ac6ab7516853fd098bc61c56216c95b8d7fc398

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542be0098b3b9dab8f530c810961603ba2f6a822cc78ac7eee268859f4df844553b33f9d2a4423e9a802ff89a058ed672f49301da562d43c4e84803ece0442d767
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c08a79e514742f8589a1ebe18591620d753a930a6f712a8e052fde4f0eee37
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b2515711f8ce760c177220035b0693e0402e8b243720c39c2fa5c63d8fe506

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254da919bbbd48942dc8dbb313ccfdf9cbe55ada3842eecc44363f68c7f277f40b92bc84021a9f0cea4dcd51d10b9ddc776d8d7d0db81f5ed7985751fe2e2aea0ec
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5c617be1a77e3328ced09ee748203bbb7afb29b2c84fb20cf3b3a6d638197
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0c7261852346c160ee7df5a37ac9f3bad96737b841a6d544b39f3052e0dddd

            handshake=Noise_X_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254376c7107f9eb405171d2d1f3d248bce446063fa27b4685471cef3d72d2da8deaa15d6a63c69270eccce4c01bcc449c6f52a973c425d8f07f606498675011335ab87e026edc45c947accd
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=95cd22713f4dc63780f443ddf8c584322d1f2e280dae8418c8a526a594e842
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=9e0f68ed156a13caecfc626ac6ab7516853fd098bc61c56216c95b8d7fc398

            handshake=Noise_Xpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542be0098b3b9dab8f530c810961603ba2f6a822cc78ac7eee268859f4df844553b33f9d2a4423e9a802ff89a058ed672f81596dfb309c93b19d158cb77e84c978a3dcb608c6ecac6c2c5d
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=c08a79e514742f8589a1ebe18591620d753a930a6f712a8e052fde4f0eee37
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b2515711f8ce760c177220035b0693e0402e8b243720c39c2fa5c63d8fe506

            handshake=Noise_Xpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254da919bbbd48942dc8dbb313ccfdf9cbe55ada3842eecc44363f68c7f277f40b92bc84021a9f0cea4dcd51d10b9ddc7767b9fb8b2dd85bd904585a11cd434469ceca29de06fb9079d0a05
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5c617be1a77e3328ced09ee748203bbb7afb29b2c84fb20cf3b3a6d638197
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0c7261852346c160ee7df5a37ac9f3bad96737b841a6d544b39f3052e0dddd
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_X_25519_AESGCM_SHA256() throws {
        let vectors = """
            handshake=Noise_X_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625427b9e233a46e236bc3b949c842a23bd75b3d6d717dbf3aa4a3cfaa59a42e6a50f3540c9b1fdc8ca68fb6b8f9081e9b28194a52a70998dd4ec3fc2088ad06f966
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=601398a290497a3ecf22851d05f53b34fa1fc4a47a0371df1f5c540a1ecf61
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=04edfc327b91e91bb67f5a069e5afbf154ebcf196baf843dce5d22f58f04e7

            handshake=Noise_Xpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254806e8e97beb9d15190981ce5f4080aeb28c7e1c743a3d676a62c14f688c70a7c7ea2fe760f1224179cc5e79e1e6510512dda2314f768816ac53546834a0e3615
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=d3fabb12ea23bcec3493f543912515d7ad5ed8e58e9a9998ae5044d2f27c32
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=5b47a6a68e47e6c22c90a55fb3bff11a8a0bbb84813887d2d7ba0e96dfd36c

            handshake=Noise_Xpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546fa09d3ca0fdbbc71df8bb16ff941b7488f0c070e770859b7026d4058df16697a5eb1d97cf498e8a907dd916557c3564006c7097ab7bb6106508c504c44b9cbc
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=48b987b047342448756adb8c63d3e45f96b4be90f221b0406ab00e95f7219c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=451d0097fdecb5f4a7e61ef341bdb66a8bbdaf5b1a650d05e7b0f5e29f26ac

            handshake=Noise_X_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625427b9e233a46e236bc3b949c842a23bd75b3d6d717dbf3aa4a3cfaa59a42e6a50f3540c9b1fdc8ca68fb6b8f9081e9b28ea4c05b652dbf8aff85830c628e63acd02c85425c685c650b07e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=601398a290497a3ecf22851d05f53b34fa1fc4a47a0371df1f5c540a1ecf61
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=04edfc327b91e91bb67f5a069e5afbf154ebcf196baf843dce5d22f58f04e7

            handshake=Noise_Xpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254806e8e97beb9d15190981ce5f4080aeb28c7e1c743a3d676a62c14f688c70a7c7ea2fe760f1224179cc5e79e1e651051ab45b08deb5664fd49b358927839000e24fd90d598c3c57ee99d
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=d3fabb12ea23bcec3493f543912515d7ad5ed8e58e9a9998ae5044d2f27c32
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=5b47a6a68e47e6c22c90a55fb3bff11a8a0bbb84813887d2d7ba0e96dfd36c

            handshake=Noise_Xpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546fa09d3ca0fdbbc71df8bb16ff941b7488f0c070e770859b7026d4058df16697a5eb1d97cf498e8a907dd916557c3564f54ded2eef286aa4c8f398f33f44b433c3e830e471f72ed3db02
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=48b987b047342448756adb8c63d3e45f96b4be90f221b0406ab00e95f7219c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=451d0097fdecb5f4a7e61ef341bdb66a8bbdaf5b1a650d05e7b0f5e29f26ac

            handshake=Noise_X_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625427b9e233a46e236bc3b949c842a23bd75b3d6d717dbf3aa4a3cfaa59a42e6a50e9a53f4b77ba9c212a5ca41f911c099159e23701989c18e59ba9ffc746d06b61
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=601398a290497a3ecf22851d05f53b34fa1fc4a47a0371df1f5c540a1ecf61
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=04edfc327b91e91bb67f5a069e5afbf154ebcf196baf843dce5d22f58f04e7

            handshake=Noise_Xpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254806e8e97beb9d15190981ce5f4080aeb28c7e1c743a3d676a62c14f688c70a7c70240353a0960993446dad6546c6a59e0df5ae06d7bc29f93ccdcc03a66ed9e5
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=d3fabb12ea23bcec3493f543912515d7ad5ed8e58e9a9998ae5044d2f27c32
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=5b47a6a68e47e6c22c90a55fb3bff11a8a0bbb84813887d2d7ba0e96dfd36c

            handshake=Noise_Xpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546fa09d3ca0fdbbc71df8bb16ff941b7488f0c070e770859b7026d4058df16697a6910630c6924a577f719acb8ee3181ca49a434aad229419e4f52a88ba17496e
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=48b987b047342448756adb8c63d3e45f96b4be90f221b0406ab00e95f7219c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=451d0097fdecb5f4a7e61ef341bdb66a8bbdaf5b1a650d05e7b0f5e29f26ac

            handshake=Noise_X_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625427b9e233a46e236bc3b949c842a23bd75b3d6d717dbf3aa4a3cfaa59a42e6a50e9a53f4b77ba9c212a5ca41f911c0991ea4c05b652dbf8aff858319c0516c6e9079711b89e419c5825b1
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=601398a290497a3ecf22851d05f53b34fa1fc4a47a0371df1f5c540a1ecf61
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=04edfc327b91e91bb67f5a069e5afbf154ebcf196baf843dce5d22f58f04e7

            handshake=Noise_Xpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254806e8e97beb9d15190981ce5f4080aeb28c7e1c743a3d676a62c14f688c70a7c70240353a0960993446dad6546c6a59eab45b08deb5664fd49b37733e0f59b46f6a5688e03dc408d5133
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=d3fabb12ea23bcec3493f543912515d7ad5ed8e58e9a9998ae5044d2f27c32
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=5b47a6a68e47e6c22c90a55fb3bff11a8a0bbb84813887d2d7ba0e96dfd36c

            handshake=Noise_Xpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546fa09d3ca0fdbbc71df8bb16ff941b7488f0c070e770859b7026d4058df16697a6910630c6924a577f719acb8ee3181cf54ded2eef286aa4c8f37ef95f1e47c89dc3f7afa0b2effc7d5a
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=48b987b047342448756adb8c63d3e45f96b4be90f221b0406ab00e95f7219c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=451d0097fdecb5f4a7e61ef341bdb66a8bbdaf5b1a650d05e7b0f5e29f26ac
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_X_25519_AESGCM_SHA512() throws {
        let vectors = """
            handshake=Noise_X_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544bd123345f7c3f54a2b7c20f234b39aad2ea1bf7a9b83b82620158c18e0389f8faca2f68c69790e392e0e18c31f2b1e5db5eb720b8c88350be14c8c7f54b4e1c
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1b4ae7e3fcfa6e15ab023def9162a31e3e34d0842a03269981ad4e7ec16542
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=51198ccfa5d72f8049fcfc80df71db7dcd5e35cda3f9f38684354627f9ee9d

            handshake=Noise_Xpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aea0c63d48d3b1d736b7c1aeae341160ba086d700161ae82ade3efff3235629ffd81d4a1b1e1fb50581c51d774c3293777a02a6bc95c753c273c08d942da964f
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=36d0a83e220c3b0e9715e79ac127f50619a62397c7709f43121aa880b0242c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b132a81c4a9cbd2029363179f168112b8b245a15ac51be366f4cb2f09e8f60

            handshake=Noise_Xpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625464d0a2b152420f100932269d5d383be29d5262c4287efbfc1a4689f88752b5e8e8564a7291e383dc088028b58775c5f40d61430c88439f36b3d04e1cfce91092
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5abf632a1e20300ec96b8849b1debe07702a0474191af8ec95d2120703ac0
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0094ea104502c9337f6fdc742e949099f369f0f4c83a9327686b5fa3a39cb3

            handshake=Noise_X_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544bd123345f7c3f54a2b7c20f234b39aad2ea1bf7a9b83b82620158c18e0389f8faca2f68c69790e392e0e18c31f2b1e5f22a97888834b9a0660e1fcdf45922e722d35e0d2441810979d3
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1b4ae7e3fcfa6e15ab023def9162a31e3e34d0842a03269981ad4e7ec16542
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=51198ccfa5d72f8049fcfc80df71db7dcd5e35cda3f9f38684354627f9ee9d

            handshake=Noise_Xpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aea0c63d48d3b1d736b7c1aeae341160ba086d700161ae82ade3efff3235629ffd81d4a1b1e1fb50581c51d774c32937c1f988f1ae61819d1b63d42fa696048336ad771ced9bc5c747b1
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=36d0a83e220c3b0e9715e79ac127f50619a62397c7709f43121aa880b0242c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b132a81c4a9cbd2029363179f168112b8b245a15ac51be366f4cb2f09e8f60

            handshake=Noise_Xpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625464d0a2b152420f100932269d5d383be29d5262c4287efbfc1a4689f88752b5e8e8564a7291e383dc088028b58775c5f4ef2c2f22b87d9c53accd687b92f198179e55ccc3ca701513b918
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5abf632a1e20300ec96b8849b1debe07702a0474191af8ec95d2120703ac0
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0094ea104502c9337f6fdc742e949099f369f0f4c83a9327686b5fa3a39cb3

            handshake=Noise_X_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544bd123345f7c3f54a2b7c20f234b39aad2ea1bf7a9b83b82620158c18e0389f897297750c1904bab4b5e0f28f2e027d71c9e88c0032221aa15011a8e4c78dffc
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1b4ae7e3fcfa6e15ab023def9162a31e3e34d0842a03269981ad4e7ec16542
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=51198ccfa5d72f8049fcfc80df71db7dcd5e35cda3f9f38684354627f9ee9d

            handshake=Noise_Xpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aea0c63d48d3b1d736b7c1aeae341160ba086d700161ae82ade3efff3235629f35e7632c0bd24a52daa0b948ba567229614147a2f9fec0650804c14558e7a4e3
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=36d0a83e220c3b0e9715e79ac127f50619a62397c7709f43121aa880b0242c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b132a81c4a9cbd2029363179f168112b8b245a15ac51be366f4cb2f09e8f60

            handshake=Noise_Xpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625464d0a2b152420f100932269d5d383be29d5262c4287efbfc1a4689f88752b5e86e5ef46c6d25996ebdb230b7431be817301ae3797b93cccfc4ecdf5ca4689916
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5abf632a1e20300ec96b8849b1debe07702a0474191af8ec95d2120703ac0
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0094ea104502c9337f6fdc742e949099f369f0f4c83a9327686b5fa3a39cb3

            handshake=Noise_X_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544bd123345f7c3f54a2b7c20f234b39aad2ea1bf7a9b83b82620158c18e0389f897297750c1904bab4b5e0f28f2e027d7f22a97888834b9a0660ee508b5c4c7f95b0d4d162d91e1123466
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=1b4ae7e3fcfa6e15ab023def9162a31e3e34d0842a03269981ad4e7ec16542
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=51198ccfa5d72f8049fcfc80df71db7dcd5e35cda3f9f38684354627f9ee9d

            handshake=Noise_Xpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aea0c63d48d3b1d736b7c1aeae341160ba086d700161ae82ade3efff3235629f35e7632c0bd24a52daa0b948ba567229c1f988f1ae61819d1b637fb839283a338b00f93f9a7808911c16
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=36d0a83e220c3b0e9715e79ac127f50619a62397c7709f43121aa880b0242c
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=b132a81c4a9cbd2029363179f168112b8b245a15ac51be366f4cb2f09e8f60

            handshake=Noise_Xpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625464d0a2b152420f100932269d5d383be29d5262c4287efbfc1a4689f88752b5e86e5ef46c6d25996ebdb230b7431be817ef2c2f22b87d9c53accd25f4ff987e5fab341d7f7fb4079e5c4b
            msg_1_payload=79656c6c6f777375626d6172696e65
            msg_1_ciphertext=e5abf632a1e20300ec96b8849b1debe07702a0474191af8ec95d2120703ac0
            msg_2_payload=7375626d6172696e6579656c6c6f77
            msg_2_ciphertext=0094ea104502c9337f6fdc742e949099f369f0f4c83a9327686b5fa3a39cb3
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }
}
