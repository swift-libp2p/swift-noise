//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class IN_Handshake_Tests: XCTestCase {
    
    func test_Noise_IN_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_IN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c841939357934ea06e78f5e8e698684d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2bd30250706a1499562e15fa575c2a5fa7a3c0629af62e55b05201f5ee9a88
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8d24c99e0e9d13c7a8ea87e782a85620a2d9cfffdb51fcbfbb9f47bedb1d7a

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e6392475570fd5848881a9e38debf0e3ef40f0f089c76a43dadf1559adb12f96c20d7b69e8333944ccf04538f378771335ff7c6937772e71fee4cbdd504774cc
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f612bd5240c0b09912b38443ae23b80a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8ee45a004c4c4dea075b1b53c6336c68b12499a8014ec4d159edb4d8d2d61b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=c0ac2d8afe9d104aa19e725b419512b446d379380b524430ad69251033b740

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625412d935cd6b08a35c8ac9d91c82849b1318050ce5ccaeb3ff03a74fc657a862f0e9e1fcc385f2dd4e16efd6f9122f15e8d094df35f7d9fa9bbae5bb7737a4537b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d973603676b783cc27f40ddc2248b573
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ebdd5b2ca6c67d29b7d2a99fc6f852211df419b41ac7aa73b6afed124aefe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=40560f67839ab4d6af1857af31b623678ff4247bfd4fe52c298519e4b37748

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625487f7d8fbdfe8f1b1391dda5c06ec57e068ee0de9e260a3b48444e0ec45ba243ba02332c9e0e6c9faa1c008ebffde52607c9d8d921ca2f9e8bef5846584dd0d27
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846656d415e8c837b3c9793297af04684d7d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aae275159d2a9c8f77e94377242515e9c6faa83a1479dbcb7881dbd29f0fb2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d567ed8546efc8c4efd024eb3ff7a80a2e7a3c2cb15be8d00269e7dfb0e6c

        handshake=Noise_IN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e06c1cbe16f8d6eb194e341725b655563795ebd72a92f673016a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2bd30250706a1499562e15fa575c2a5fa7a3c0629af62e55b05201f5ee9a88
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8d24c99e0e9d13c7a8ea87e782a85620a2d9cfffdb51fcbfbb9f47bedb1d7a

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e6392475570fd5848881a9e38debf0e3ef40f0f089c76a43dadf1559adb12f96c20d7b69e8333944ccf04538f3787713a3f341409341bc2633a44d0d0cffc67cb924c5f817986201f89f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846697a1574e379eb22d4ed6c9bb37a249152f86f772c0b6b0405714
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8ee45a004c4c4dea075b1b53c6336c68b12499a8014ec4d159edb4d8d2d61b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=c0ac2d8afe9d104aa19e725b419512b446d379380b524430ad69251033b740

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625412d935cd6b08a35c8ac9d91c82849b1318050ce5ccaeb3ff03a74fc657a862f0e9e1fcc385f2dd4e16efd6f9122f15e8dc20bd3b6d2a59bacce24fe77d836c67f156db32f914abf48a6c
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466480c53c0cd421691e09cf8c71845481d77f82da21ab4404e01cd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ebdd5b2ca6c67d29b7d2a99fc6f852211df419b41ac7aa73b6afed124aefe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=40560f67839ab4d6af1857af31b623678ff4247bfd4fe52c298519e4b37748

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625487f7d8fbdfe8f1b1391dda5c06ec57e068ee0de9e260a3b48444e0ec45ba243ba02332c9e0e6c9faa1c008ebffde52601555b3462a986b29bd0d0aca61ce824686b5ee49ec4a48ca8e7f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661f6cfea732227f439b5149a4d581b9ecd78c6c61b944aad00f7b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aae275159d2a9c8f77e94377242515e9c6faa83a1479dbcb7881dbd29f0fb2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d567ed8546efc8c4efd024eb3ff7a80a2e7a3c2cb15be8d00269e7dfb0e6c

        handshake=Noise_IN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846699119bc615749ecd1e6e7d1ac6d1977c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2bd30250706a1499562e15fa575c2a5fa7a3c0629af62e55b05201f5ee9a88
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8d24c99e0e9d13c7a8ea87e782a85620a2d9cfffdb51fcbfbb9f47bedb1d7a

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e6392475570fd5848881a9e38debf0e3ef40f0f089c76a43dadf1559adb12f963da30abf52e7bfc3b55a0209fcc0f7a175871e2e30e8450989365002aca269b2
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662b230f643036ec899a5a4f68d9d7044e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8ee45a004c4c4dea075b1b53c6336c68b12499a8014ec4d159edb4d8d2d61b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=c0ac2d8afe9d104aa19e725b419512b446d379380b524430ad69251033b740

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625412d935cd6b08a35c8ac9d91c82849b1318050ce5ccaeb3ff03a74fc657a862f07ab83b4c64b03c9e2033777cbb1312bbcdfbbe5ff2fdaf57ef374eff49d47fc6
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466cfc8f480e99a7c4c2ca19519a93b555e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ebdd5b2ca6c67d29b7d2a99fc6f852211df419b41ac7aa73b6afed124aefe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=40560f67839ab4d6af1857af31b623678ff4247bfd4fe52c298519e4b37748

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625487f7d8fbdfe8f1b1391dda5c06ec57e068ee0de9e260a3b48444e0ec45ba243b5fca98a7970812685deaf53e7ffb1575eb3f3daecc6f33e17d11d5301ab96b7b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665e39de767762c2beb6d96b26e84dbac6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aae275159d2a9c8f77e94377242515e9c6faa83a1479dbcb7881dbd29f0fb2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d567ed8546efc8c4efd024eb3ff7a80a2e7a3c2cb15be8d00269e7dfb0e6c

        handshake=Noise_IN_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e06c1cbe16f8d6eb194ee5323d1b620bf0b6767e08d8027ee9e7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2bd30250706a1499562e15fa575c2a5fa7a3c0629af62e55b05201f5ee9a88
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=8d24c99e0e9d13c7a8ea87e782a85620a2d9cfffdb51fcbfbb9f47bedb1d7a

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e6392475570fd5848881a9e38debf0e3ef40f0f089c76a43dadf1559adb12f963da30abf52e7bfc3b55a0209fcc0f7a1a3f341409341bc2633a483e8bf7bea8307e6dc21c16519a91cbd
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846697a1574e379eb22d4ed66f506c2ec0fe5994eea0f25cced08528
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8ee45a004c4c4dea075b1b53c6336c68b12499a8014ec4d159edb4d8d2d61b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=c0ac2d8afe9d104aa19e725b419512b446d379380b524430ad69251033b740

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625412d935cd6b08a35c8ac9d91c82849b1318050ce5ccaeb3ff03a74fc657a862f07ab83b4c64b03c9e2033777cbb1312bbdc20bd3b6d2a59bacce207c6e3a1f515317eb137612cb3d35409
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466480c53c0cd421691e09cc75414f28abdc13ecc8b13cc73692825
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=ebdd5b2ca6c67d29b7d2a99fc6f852211df419b41ac7aa73b6afed124aefe8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=40560f67839ab4d6af1857af31b623678ff4247bfd4fe52c298519e4b37748

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625487f7d8fbdfe8f1b1391dda5c06ec57e068ee0de9e260a3b48444e0ec45ba243b5fca98a7970812685deaf53e7ffb15751555b3462a986b29bd0d93839bd9528630f52982f870bfd48f38
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661f6cfea732227f439b51131d5eeb7da02a5d2293f0ecd9d4183a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=aae275159d2a9c8f77e94377242515e9c6faa83a1479dbcb7881dbd29f0fb2
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d567ed8546efc8c4efd024eb3ff7a80a2e7a3c2cb15be8d00269e7dfb0e6c
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_IN_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_IN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666e3f19dc99a2257db910145fa6e54aef
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9ccb684459ec247c656f7a9c582a018aac429546bdee1199a1ed61ba49fc64
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=39614a2f4324d2407d903c372a779b30fd32fae1c5b6d69cdc0877cae101ff

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625471caa66028f64280a10cdb259a0f0ee1c59b656bb9366bd2a76f8e42a9bebed7872be750256a0ce3dd0b8d85daee1094b8ed982f1c2a6657ff978086d16874d4
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661c71ad2acb743655448c1b44eb19eb7f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=524b10cf461ef1f535017e250c8fe51471fb22093f7aef578485f282f7af0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6d27cc209baae7deb036ff0c7c45a3c0c7b86d1949ff81570da6e319323c08

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541ce4cd9b7ed42c5afaac1903aa6b83bf2665bf49b278784bed2a8d8ca87f34402fdb485d8cfde58838035a57e1ba4e8da2957ac4c7de5d2725b56092d25a7177
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660e1884abae5c79aec17fe6ba6b321f1c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9afced7a00a7d235716c18a3cd21737541e0ce919babee1b4106da009fd889
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=65783176595aba309742bfdf98f1c699ee18b65e091571ff41ef7f3e658b4d

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549138f71daf8a8ccad5990ffd2d892da9fbcf2b41c95e11f1d48ed3ade358c32f7ea8eeaabc9629b368b2e98e0f3733be7225d72099f7df6538e48a8c60dce748
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f10361bb35702893ddbf2c2c632d849c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be487fd9db2f9d9dd8ecb6a2c071a8ebcf71e344d535ecb0376efc8890726d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e43bb8a33bdf3307795da4a4d99d691922794058217d4c4902cef80d1b94ed

        handshake=Noise_IN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466883df2067301b17472bc17c3aea78ff04f20412f5f100390fd79
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9ccb684459ec247c656f7a9c582a018aac429546bdee1199a1ed61ba49fc64
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=39614a2f4324d2407d903c372a779b30fd32fae1c5b6d69cdc0877cae101ff

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625471caa66028f64280a10cdb259a0f0ee1c59b656bb9366bd2a76f8e42a9bebed7872be750256a0ce3dd0b8d85daee109442a2e41e0634afc367f0ce923a70cf9bd6c4db73bb0a0803f10d
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663536123ea26b1bfcf393c34e3298477c533893ebfc51cbf9193b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=524b10cf461ef1f535017e250c8fe51471fb22093f7aef578485f282f7af0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6d27cc209baae7deb036ff0c7c45a3c0c7b86d1949ff81570da6e319323c08

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541ce4cd9b7ed42c5afaac1903aa6b83bf2665bf49b278784bed2a8d8ca87f34402fdb485d8cfde58838035a57e1ba4e8d14e124433912c24fe0422740d71e57f17e357266751d7d99aba3
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662fd0bf78bd69757b645a2d07e6a5fe7582a47bdfba1bbcb3cacc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9afced7a00a7d235716c18a3cd21737541e0ce919babee1b4106da009fd889
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=65783176595aba309742bfdf98f1c699ee18b65e091571ff41ef7f3e658b4d

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549138f71daf8a8ccad5990ffd2d892da9fbcf2b41c95e11f1d48ed3ade358c32f7ea8eeaabc9629b368b2e98e0f3733bede18b3b48a6276edf76a81785394b60e6d181d0b55147e05997d
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484667e3677d51882a717bfafeb6e28ceb9957567363ba37c8a809db0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be487fd9db2f9d9dd8ecb6a2c071a8ebcf71e344d535ecb0376efc8890726d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e43bb8a33bdf3307795da4a4d99d691922794058217d4c4902cef80d1b94ed

        handshake=Noise_IN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663030d12e83fc1c593b562909667508fb
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9ccb684459ec247c656f7a9c582a018aac429546bdee1199a1ed61ba49fc64
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=39614a2f4324d2407d903c372a779b30fd32fae1c5b6d69cdc0877cae101ff

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625471caa66028f64280a10cdb259a0f0ee1c59b656bb9366bd2a76f8e42a9bebed7305e7a3c409dd4ba92d3fc3f3f8d763c46d6344acf2941446c9812a1286cb04d
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666d7c1191cd68a34ba4b64c5e58c972a0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=524b10cf461ef1f535017e250c8fe51471fb22093f7aef578485f282f7af0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6d27cc209baae7deb036ff0c7c45a3c0c7b86d1949ff81570da6e319323c08

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541ce4cd9b7ed42c5afaac1903aa6b83bf2665bf49b278784bed2a8d8ca87f3440ed8d78ab07ed6b569d0fc538be2a8220c6b583f1bffa1acc148370953f45cd11
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846621ddef7c2f3b01b8748714bdab2937fd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9afced7a00a7d235716c18a3cd21737541e0ce919babee1b4106da009fd889
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=65783176595aba309742bfdf98f1c699ee18b65e091571ff41ef7f3e658b4d

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549138f71daf8a8ccad5990ffd2d892da9fbcf2b41c95e11f1d48ed3ade358c32fcd3bed0595f69641adbfdd57ab1dc085a124a2b362fb05d05f1e655d15fa290f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664a4abe3680fc325b700f59d5c46985d1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be487fd9db2f9d9dd8ecb6a2c071a8ebcf71e344d535ecb0376efc8890726d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e43bb8a33bdf3307795da4a4d99d691922794058217d4c4902cef80d1b94ed

        handshake=Noise_IN_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466883df2067301b17472bc62ad68cabba7bc80654d521b7a892865
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9ccb684459ec247c656f7a9c582a018aac429546bdee1199a1ed61ba49fc64
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=39614a2f4324d2407d903c372a779b30fd32fae1c5b6d69cdc0877cae101ff

        handshake=Noise_INpsk0_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625471caa66028f64280a10cdb259a0f0ee1c59b656bb9366bd2a76f8e42a9bebed7305e7a3c409dd4ba92d3fc3f3f8d763c42a2e41e0634afc367f0dde3a61bd4a359193386bca6e46e72b1
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663536123ea26b1bfcf393b8cca304c5aa1b4646aad82de257ebcf
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=524b10cf461ef1f535017e250c8fe51471fb22093f7aef578485f282f7af0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6d27cc209baae7deb036ff0c7c45a3c0c7b86d1949ff81570da6e319323c08

        handshake=Noise_INpsk1_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541ce4cd9b7ed42c5afaac1903aa6b83bf2665bf49b278784bed2a8d8ca87f3440ed8d78ab07ed6b569d0fc538be2a822014e124433912c24fe042705ce2c0d3705e137ee0734f70240170
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662fd0bf78bd69757b645ad82bb4ce6c5bab13a549bfe52cdc2135
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9afced7a00a7d235716c18a3cd21737541e0ce919babee1b4106da009fd889
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=65783176595aba309742bfdf98f1c699ee18b65e091571ff41ef7f3e658b4d

        handshake=Noise_INpsk2_25519_ChaChaPoly_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549138f71daf8a8ccad5990ffd2d892da9fbcf2b41c95e11f1d48ed3ade358c32fcd3bed0595f69641adbfdd57ab1dc085de18b3b48a6276edf76ae73f5ad4478d00547bf6d0cf9f6a4121
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484667e3677d51882a717bfaf6fa3e9f062a27f45029aa7e50a76aa13
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be487fd9db2f9d9dd8ecb6a2c071a8ebcf71e344d535ecb0376efc8890726d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e43bb8a33bdf3307795da4a4d99d691922794058217d4c4902cef80d1b94ed
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_IN_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_IN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466cdeb70e577c726fba1c682d0cc9d58dc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=942a03a9fbd149d80f827d68acb020b98a2988435155931aa6e87780e1ae0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6c22a69895e4c940bed283b9a10ce57d83f09683827a283fda77d75d086c6e

        handshake=Noise_INpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547c265cb3ca07c422159c05da5508b509330a9d97d67a3a8fea09e53fe4965fa404a45a7a007c03ec5b18911e3e5a11d686325db0c406eac3d84e1e705cd7e1c0
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846669eeb99c25d0285113c571b33c777dc2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=702284b311f0bab378528420b7a5a4e829737ee3e6daf41517fda5fdfeadfb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=52c5ed9e8e2fe3bb2a870b47b1380ef94a8578d3a895f4e799720902699fca

        handshake=Noise_INpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544d56bb0c1876cf3c43d9e4704c3695912692be106f89aefc5f9a82faa4b8ed6d21fd0416e483d32cc8774dfcfdd0d384b277fc77f8a612755a568224a86f48e6
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846610fab43afb44de3edfc9d3039020a09b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=594ecdb1619d52ce6094d23485ce71d1ba806bb3297be3e2aa8031b51f3fb9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=703336a1f5ae2eff07442bbbe4797fb864c8038a890332e943234fe11e92e7

        handshake=Noise_INpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c9b90bf88a0b8849c338ddcba137cc03b951bd2dc177071ee618d38f18d8171576e80df2eb20134ea61ecca66d604826193d3940232859387a7e6ab57d74bb41
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665f13b26b4e47f377f079cba555e2c2e7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c8cda123eca519ddae68fd5de69ae61696a8147e06b1b057478de9ca4dd0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=477468334e5fe3fd833bedbdaa22c7030e03eb531402dd48df9ce98182ef08

        handshake=Noise_IN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e081945b5d5301fe42dadb6da0f788260c6252af7f41e986c5c2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=942a03a9fbd149d80f827d68acb020b98a2988435155931aa6e87780e1ae0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6c22a69895e4c940bed283b9a10ce57d83f09683827a283fda77d75d086c6e

        handshake=Noise_INpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547c265cb3ca07c422159c05da5508b509330a9d97d67a3a8fea09e53fe4965fa404a45a7a007c03ec5b18911e3e5a11d609022778b13fa7b2d13986844231dd445a7fdf2deced73ed7dc6
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466245acc39d32cd111269cd3b4981cd32d0fc1dd3dbcd10c2ccd00
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=702284b311f0bab378528420b7a5a4e829737ee3e6daf41517fda5fdfeadfb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=52c5ed9e8e2fe3bb2a870b47b1380ef94a8578d3a895f4e799720902699fca

        handshake=Noise_INpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544d56bb0c1876cf3c43d9e4704c3695912692be106f89aefc5f9a82faa4b8ed6d21fd0416e483d32cc8774dfcfdd0d3849494d756adea0eee2f87617f98ac7dedd0342f13f2437853cac6
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bb85a80b70fd80c7647ad87182859bce0d29d69890b8fddcad49
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=594ecdb1619d52ce6094d23485ce71d1ba806bb3297be3e2aa8031b51f3fb9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=703336a1f5ae2eff07442bbbe4797fb864c8038a890332e943234fe11e92e7

        handshake=Noise_INpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c9b90bf88a0b8849c338ddcba137cc03b951bd2dc177071ee618d38f18d8171576e80df2eb20134ea61ecca66d60482696650307415ef3e84d9de5db5ddbb0c6edb37e0652d8f8a58b7b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bda119e70ff1a807b1f5c259b407bd4480b60a637c4e94aed69b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c8cda123eca519ddae68fd5de69ae61696a8147e06b1b057478de9ca4dd0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=477468334e5fe3fd833bedbdaa22c7030e03eb531402dd48df9ce98182ef08

        handshake=Noise_IN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b8070f1a05f109f179e7d3cb6327b9ff
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=942a03a9fbd149d80f827d68acb020b98a2988435155931aa6e87780e1ae0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6c22a69895e4c940bed283b9a10ce57d83f09683827a283fda77d75d086c6e

        handshake=Noise_INpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547c265cb3ca07c422159c05da5508b509330a9d97d67a3a8fea09e53fe4965fa459403c6046385d6af1f458771895e2fab6c321b290160c5bd68c6a7c621388ad
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661e03dc287297fc7ff86bc8c7810284ea
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=702284b311f0bab378528420b7a5a4e829737ee3e6daf41517fda5fdfeadfb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=52c5ed9e8e2fe3bb2a870b47b1380ef94a8578d3a895f4e799720902699fca

        handshake=Noise_INpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544d56bb0c1876cf3c43d9e4704c3695912692be106f89aefc5f9a82faa4b8ed6d83c17fa055704307c8811d1b0e0ad295f02971305459fdd7f965b0feb5b7ab6b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846628f89ed04b07e0e9e94742792dc39554
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=594ecdb1619d52ce6094d23485ce71d1ba806bb3297be3e2aa8031b51f3fb9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=703336a1f5ae2eff07442bbbe4797fb864c8038a890332e943234fe11e92e7

        handshake=Noise_INpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c9b90bf88a0b8849c338ddcba137cc03b951bd2dc177071ee618d38f18d8171506626ab4985988f259d4b3030f1cecd90c4c6d1aa93d4213ad6adf172946bd3e
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663096c40b47d26caec9bce34e223bc3db
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c8cda123eca519ddae68fd5de69ae61696a8147e06b1b057478de9ca4dd0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=477468334e5fe3fd833bedbdaa22c7030e03eb531402dd48df9ce98182ef08

        handshake=Noise_IN_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e081945b5d5301fe42dabcc010cb04cf66f06d25106d39cc52c8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=942a03a9fbd149d80f827d68acb020b98a2988435155931aa6e87780e1ae0e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6c22a69895e4c940bed283b9a10ce57d83f09683827a283fda77d75d086c6e

        handshake=Noise_INpsk0_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547c265cb3ca07c422159c05da5508b509330a9d97d67a3a8fea09e53fe4965fa459403c6046385d6af1f458771895e2fa09022778b13fa7b2d1391f421b1293b7d5da70d030b158d7cc98
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466245acc39d32cd111269c53d0795705caaf644f5bd95501f560b9
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=702284b311f0bab378528420b7a5a4e829737ee3e6daf41517fda5fdfeadfb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=52c5ed9e8e2fe3bb2a870b47b1380ef94a8578d3a895f4e799720902699fca

        handshake=Noise_INpsk1_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544d56bb0c1876cf3c43d9e4704c3695912692be106f89aefc5f9a82faa4b8ed6d83c17fa055704307c8811d1b0e0ad2959494d756adea0eee2f8785d82292d8f8ed078e246a2fb78d65e1
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bb85a80b70fd80c7647ae5822e9159b0bef8a8d773460386dc8b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=594ecdb1619d52ce6094d23485ce71d1ba806bb3297be3e2aa8031b51f3fb9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=703336a1f5ae2eff07442bbbe4797fb864c8038a890332e943234fe11e92e7

        handshake=Noise_INpsk2_25519_AESGCM_SHA256
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c9b90bf88a0b8849c338ddcba137cc03b951bd2dc177071ee618d38f18d8171506626ab4985988f259d4b3030f1cecd996650307415ef3e84d9d01a03ce746f46e4a8128825ca5788c4a
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bda119e70ff1a807b1f540d5adbfebb77d74f37e87a47d4df9a0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c8cda123eca519ddae68fd5de69ae61696a8147e06b1b057478de9ca4dd0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=477468334e5fe3fd833bedbdaa22c7030e03eb531402dd48df9ce98182ef08
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_IN_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_IN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c9ab17086eb52ba02f54fe48b11cf7ae
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d4e08cc4a109b93413b9f2b93a90c3b52d328130346ae8a7a65693bbdfffb3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2bf0d845c35d0b63452e9477083d9c35feb7263cebf00828ce84fba88f94c0

        handshake=Noise_INpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625405262b1f9b84cdb310908a65b2d6408f13ec9efef6a1b52c2bf0daaffe1e42204de45bf028283b88c60ab5cc2745b8e8c6cf4e30f5e4d01f7a36153c4d2028b1
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fcf90b48cc4034aefda82a6593ca634e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d8f33663563115c594ca28b2fe01e8dae1cf498b312ceb4c18fc55a005cc6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=36f1d5c7339b870e822497f1a014c1032e3268d62ea5bc7f80264b2de3535d

        handshake=Noise_INpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c205846663809a031f5a191bd9323566dc3c824c7273fa31a5fc1d54a8e951aa4f4a2c01331090fe2dc47358b134f4983e57f6e050a654d43575149488e4d962
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660f9cecdffa97451986964e6b181e2961
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=79d1215e41ae753d5c8dafc474355e4b7af8ec2d84f13444f3d1c7bea75e53
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=216ecf739142ee4ce72573b4e79f765df31be2022377fee7e9847f558a6187

        handshake=Noise_INpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541906307774eb6ae1a18c731b2af6d9bcf09b69e5b9b66678a3b968edb6550e7dc123f2506c770de516702097583503973ef95ff80d31b363f0e2637b8df344c7
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac222e4b2d2f6d105228f1f6eaab97ff
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f18b76b773ad92a0551eaaccac2822ef7c89e2e4141b493494a5671432e538
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b500b236900edd4ce3a74e0f021fc0b93bb677a8a0417996474ad1b3ad40f8

        handshake=Noise_IN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466578e11ef9be6d820631037dc05abdcb236c57a2567ba93669ab0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d4e08cc4a109b93413b9f2b93a90c3b52d328130346ae8a7a65693bbdfffb3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2bf0d845c35d0b63452e9477083d9c35feb7263cebf00828ce84fba88f94c0

        handshake=Noise_INpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625405262b1f9b84cdb310908a65b2d6408f13ec9efef6a1b52c2bf0daaffe1e42204de45bf028283b88c60ab5cc2745b8e87016ea492791838b92f00800e636883dc626eb2f3895011a139e
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466217778ef3116b94146df592ed848106664bcbfff47169058bda2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d8f33663563115c594ca28b2fe01e8dae1cf498b312ceb4c18fc55a005cc6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=36f1d5c7339b870e822497f1a014c1032e3268d62ea5bc7f80264b2de3535d

        handshake=Noise_INpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c205846663809a031f5a191bd9323566dc3c824c7273fa31a5fc1d54a8e951aa4f4a2c01331090fe2dc47358b134f4985722e0d190fada548c133472917187cdb527644e700547c52b28
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466471b4496207cea9199841fc64e1bb1b5b788be9d1689e4540867
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=79d1215e41ae753d5c8dafc474355e4b7af8ec2d84f13444f3d1c7bea75e53
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=216ecf739142ee4ce72573b4e79f765df31be2022377fee7e9847f558a6187

        handshake=Noise_INpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541906307774eb6ae1a18c731b2af6d9bcf09b69e5b9b66678a3b968edb6550e7dc123f2506c770de516702097583503971cf56370e4abe94a9f67eda71c22f885de116aa378e1cd96eced
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846643ad2c9a96755f8efbbcf40b385fe808da55ab103c66dd8c1542
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f18b76b773ad92a0551eaaccac2822ef7c89e2e4141b493494a5671432e538
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b500b236900edd4ce3a74e0f021fc0b93bb677a8a0417996474ad1b3ad40f8

        handshake=Noise_IN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846648988f7cb5d85b5c5c03e276b86fe50f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d4e08cc4a109b93413b9f2b93a90c3b52d328130346ae8a7a65693bbdfffb3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2bf0d845c35d0b63452e9477083d9c35feb7263cebf00828ce84fba88f94c0

        handshake=Noise_INpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625405262b1f9b84cdb310908a65b2d6408f13ec9efef6a1b52c2bf0daaffe1e422032e60c283f594634358c6ade5821244600d8d2e6dea60137b4f10b074ba7193d
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b1e5ecbcc832e6ac1a8414797bb920cb
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d8f33663563115c594ca28b2fe01e8dae1cf498b312ceb4c18fc55a005cc6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=36f1d5c7339b870e822497f1a014c1032e3268d62ea5bc7f80264b2de3535d

        handshake=Noise_INpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c205846663809a031f5a191bd9323566dc3c824c7273fa31a5fc1d54a8e951aa6ec025aad0d8f9cb26a27d5d1176d9a994077aab03b577f2e8039e4366bc6245
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d663e6ac3d33e23ad323622c476fe906
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=79d1215e41ae753d5c8dafc474355e4b7af8ec2d84f13444f3d1c7bea75e53
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=216ecf739142ee4ce72573b4e79f765df31be2022377fee7e9847f558a6187

        handshake=Noise_INpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541906307774eb6ae1a18c731b2af6d9bcf09b69e5b9b66678a3b968edb6550e7dfee517c34ceeba54fee005b95e94e05103161169f40b807a26d7d3bf013b7f85
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664813a5e72f6b66ec89e411840f84ba80
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f18b76b773ad92a0551eaaccac2822ef7c89e2e4141b493494a5671432e538
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b500b236900edd4ce3a74e0f021fc0b93bb677a8a0417996474ad1b3ad40f8

        handshake=Noise_IN_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f40c5adb68f25624ae5b214ea767a6ec94d829d3d7b5e1ad1ba6f3e2138285f746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466578e11ef9be6d82063107b23e9a7cdafd87a02d15059693b866a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d4e08cc4a109b93413b9f2b93a90c3b52d328130346ae8a7a65693bbdfffb3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=2bf0d845c35d0b63452e9477083d9c35feb7263cebf00828ce84fba88f94c0

        handshake=Noise_INpsk0_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625405262b1f9b84cdb310908a65b2d6408f13ec9efef6a1b52c2bf0daaffe1e422032e60c283f594634358c6ade582124467016ea492791838b92f08ea1ce07ac1c29aaca2ba2e6be8aae6f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466217778ef3116b94146df5f06a4a59dfcbb765ff9ffaf65d3063d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=7d8f33663563115c594ca28b2fe01e8dae1cf498b312ceb4c18fc55a005cc6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=36f1d5c7339b870e822497f1a014c1032e3268d62ea5bc7f80264b2de3535d

        handshake=Noise_INpsk1_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c205846663809a031f5a191bd9323566dc3c824c7273fa31a5fc1d54a8e951aa6ec025aad0d8f9cb26a27d5d1176d9a95722e0d190fada548c13cebafccf5db40ddec9c8ee4edbf85e68
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466471b4496207cea9199840fb7d1bf618aa15eb0b74b90a0a8f9b4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=79d1215e41ae753d5c8dafc474355e4b7af8ec2d84f13444f3d1c7bea75e53
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=216ecf739142ee4ce72573b4e79f765df31be2022377fee7e9847f558a6187

        handshake=Noise_INpsk2_25519_AESGCM_SHA512
        init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541906307774eb6ae1a18c731b2af6d9bcf09b69e5b9b66678a3b968edb6550e7dfee517c34ceeba54fee005b95e94e0511cf56370e4abe94a9f67f486bb56720c1832a61683a3ebde2eec
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846643ad2c9a96755f8efbbcab063bc3e701c9facb3668c1589ea2d6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=f18b76b773ad92a0551eaaccac2822ef7c89e2e4141b493494a5671432e538
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b500b236900edd4ce3a74e0f021fc0b93bb677a8a0417996474ad1b3ad40f8
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}

