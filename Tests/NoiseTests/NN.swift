//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class NN_Handshake_Tests: XCTestCase {
    
    func test_Noise_NN_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_NN_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b9a74f6724441623af038022288c2556
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=96cd46be111804586a935795eeb4ce62bdec121048a10520b00266b22722eb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=fe2bc534e31964c0bd56337223e921565e39dbc5f156aa04766ced4689a2a2

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e7136508cb8178281204abd62e9f2a3e
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466922f3b7824001193c077abd8b7a73030
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b349a522c145762c7c737ac1d1425ce1fb25c7cca626177ee4ceed3cd6fb3d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b41e24399dc3f1ad2faf82868700e4bf31bb89f6616e1d6a92802bb8ad80d6

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ee9d033f6e676839de40170aca012002
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fa780f5014acbab4d9e8a60099774b2f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c86e1615188d3feae514a908523ccbbce6f0b0fa368c0dbac6ddf01b6571
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3b27b0caca5899086a3ebfb80a0651a18f1af75c9f71f3b3818a0170c8e615

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254649f81a8f7cd2ee213caf437abedbbf5
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f61e2ebde3648ba1353298a7b8f99454
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eb1a9999225c8a03f6c053d24da26df330c7b2ac6315c5aeff9a4c2893d9e3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=17aecb7454199636aa7e8a44b7e51b5dc6729b39faddd2739bc66d8cbf07be

        handshake=Noise_NN_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bb598b7e636e9475d9a7d3111d7a7f3929f0f4c47293613c173f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=96cd46be111804586a935795eeb4ce62bdec121048a10520b00266b22722eb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=fe2bc534e31964c0bd56337223e921565e39dbc5f156aa04766ced4689a2a2

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547c78f22f8cea986f934a675201c7f431a539e50c9be46986fa89
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666913ea64c74c2f63ee5e814fda25301b9508e4685ee02e9852fd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b349a522c145762c7c737ac1d1425ce1fb25c7cca626177ee4ceed3cd6fb3d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b41e24399dc3f1ad2faf82868700e4bf31bb89f6616e1d6a92802bb8ad80d6

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d14f69b3b9d75ea1662d0ce4daecd3845bd11582aebf2fba3e99
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466961705fd812d19815374d102e749b09e623ad659a7a3afef8415
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c86e1615188d3feae514a908523ccbbce6f0b0fa368c0dbac6ddf01b6571
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3b27b0caca5899086a3ebfb80a0651a18f1af75c9f71f3b3818a0170c8e615

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ba71add3db8e76dddcfecd52c7db8b92e7b993407c57d909b7f9
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665aeaba3e8ae057890d222d19af245e23209100a4b501ca82f843
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eb1a9999225c8a03f6c053d24da26df330c7b2ac6315c5aeff9a4c2893d9e3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=17aecb7454199636aa7e8a44b7e51b5dc6729b39faddd2739bc66d8cbf07be

        handshake=Noise_NN_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665cda04f69d491f9bf509e632fc1a20dd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=96cd46be111804586a935795eeb4ce62bdec121048a10520b00266b22722eb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=fe2bc534e31964c0bd56337223e921565e39dbc5f156aa04766ced4689a2a2

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546e96a20116b68fd776478e81d11779ca
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846666f51bc44f88917daa53fb4529499b55
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b349a522c145762c7c737ac1d1425ce1fb25c7cca626177ee4ceed3cd6fb3d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b41e24399dc3f1ad2faf82868700e4bf31bb89f6616e1d6a92802bb8ad80d6

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545860fa411dfa26d26f2128f7e347eaf9
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662d6b25a63eb7741de46ecfe91e243f6f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c86e1615188d3feae514a908523ccbbce6f0b0fa368c0dbac6ddf01b6571
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3b27b0caca5899086a3ebfb80a0651a18f1af75c9f71f3b3818a0170c8e615

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254358bf186163f6d621580cf909c191a7c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b382c809faae2b2874cd218c7b075c96
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eb1a9999225c8a03f6c053d24da26df330c7b2ac6315c5aeff9a4c2893d9e3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=17aecb7454199636aa7e8a44b7e51b5dc6729b39faddd2739bc66d8cbf07be

        handshake=Noise_NN_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466bb598b7e636e9475d9a74243a419c31324b40cc77cc7a7ea3b24
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=96cd46be111804586a935795eeb4ce62bdec121048a10520b00266b22722eb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=fe2bc534e31964c0bd56337223e921565e39dbc5f156aa04766ced4689a2a2

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547c78f22f8cea986f934ab17c2484a24a990a6473d588a4f20e99
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666913ea64c74c2f63ee5e32a5358320d459322d624c9ccc975fa0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b349a522c145762c7c737ac1d1425ce1fb25c7cca626177ee4ceed3cd6fb3d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b41e24399dc3f1ad2faf82868700e4bf31bb89f6616e1d6a92802bb8ad80d6

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d14f69b3b9d75ea1662d338ce00a4c4454f04db11957c29b45ba
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466961705fd812d198153745358e4e1e28b5a350b1f7abd0f271620
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=75c86e1615188d3feae514a908523ccbbce6f0b0fa368c0dbac6ddf01b6571
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=3b27b0caca5899086a3ebfb80a0651a18f1af75c9f71f3b3818a0170c8e615

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ba71add3db8e76dddcfe83087861219e26e6f5b0b682e6758cdd
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665aeaba3e8ae057890d221b12297799709eb36b11f4fd7366a4b2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=eb1a9999225c8a03f6c053d24da26df330c7b2ac6315c5aeff9a4c2893d9e3
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=17aecb7454199636aa7e8a44b7e51b5dc6729b39faddd2739bc66d8cbf07be
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_NN_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_NN_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f8006a097c5b557f4464c7b27dbd8e35
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=984f97fa7c1125c40ac0c3bb124e9a60fe179997c677873ab695f7b19ac262
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6826eeac32a5efc75cb0fcbdc9833c4fdcbad4923c77064f83ee7dfbdc288f

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254974676d1695ef76c90de21fd792bcbbf
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664295530903147b2ef9fa23131d315e89
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0613a33b46a7b58b27aee0341bb301c9ab995009b4cc5184fbb5a8cf7be53d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5cab31d679356097d8d190df5c068dee6e2ba4e4c275fd81e25c019bf65f6d

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d74b5809b1cc7872a9b81f4042b3e795
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660541a69fa4c2c12112d7506b314c7c3f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=abf9e02663066047949fc2b5618d5ac5e2c078cdb011b7ed7a8f97aa4436b0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d85667b02a4a35a2c701afbca632f1c94741b2fc3345220d6b74af80134ca9

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aaf57bcc7f1092854b42b9d236a4c004
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466159739894d9652a3509deb14b3a10299
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be2eff0ceb13ed28f46bd59b64b8acb937ada777ee557f6147111e9fbc5d25
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=79c9684daee2cdbf5117ccd166e2da4ef6bfd9c7babc9ab75e5d3665518cbd

        handshake=Noise_NN_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466114578170ac333f0a403ad4d13e744e5040f7f860764f72ede92
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=984f97fa7c1125c40ac0c3bb124e9a60fe179997c677873ab695f7b19ac262
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6826eeac32a5efc75cb0fcbdc9833c4fdcbad4923c77064f83ee7dfbdc288f

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541c2a9acfae038fa688b36a860ce3cab6de204e5286be35d42db1
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846633d99a5f182be11e1105b85168c151b4b5551d5ef3ade5e59ce2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0613a33b46a7b58b27aee0341bb301c9ab995009b4cc5184fbb5a8cf7be53d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5cab31d679356097d8d190df5c068dee6e2ba4e4c275fd81e25c019bf65f6d

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541686d22f6e5298997dc0c473114ab1dc6e02dc2355872726df0e
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466402b1ffabe29fc69e1daad0ecafe3a6282d4ad0aeb7ee6625e2c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=abf9e02663066047949fc2b5618d5ac5e2c078cdb011b7ed7a8f97aa4436b0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d85667b02a4a35a2c701afbca632f1c94741b2fc3345220d6b74af80134ca9

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b3a376dcfce9e9147a0616a720fd3172ecb619f17eccdc9005ab
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846693b56fc7a048915c8251b5382ce54df64c1d362e477150d6a07b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be2eff0ceb13ed28f46bd59b64b8acb937ada777ee557f6147111e9fbc5d25
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=79c9684daee2cdbf5117ccd166e2da4ef6bfd9c7babc9ab75e5d3665518cbd

        handshake=Noise_NN_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484667cc7b2813fbd918f730af3e151d18ebc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=984f97fa7c1125c40ac0c3bb124e9a60fe179997c677873ab695f7b19ac262
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6826eeac32a5efc75cb0fcbdc9833c4fdcbad4923c77064f83ee7dfbdc288f

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c6e9ea5266f8fe353cd01f932b2a7804
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466dbb235f1ab9dc24f035f317418338415
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0613a33b46a7b58b27aee0341bb301c9ab995009b4cc5184fbb5a8cf7be53d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5cab31d679356097d8d190df5c068dee6e2ba4e4c275fd81e25c019bf65f6d

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ee047aa2f9f98eabb4e2e09bb1970c42
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466241ec162167033e63b0abca7874e3355
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=abf9e02663066047949fc2b5618d5ac5e2c078cdb011b7ed7a8f97aa4436b0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d85667b02a4a35a2c701afbca632f1c94741b2fc3345220d6b74af80134ca9

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625451990afd47d5cff7607df29d7e08b05c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663bf1d1f0f5c435b3018b3c8ba0a625c1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be2eff0ceb13ed28f46bd59b64b8acb937ada777ee557f6147111e9fbc5d25
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=79c9684daee2cdbf5117ccd166e2da4ef6bfd9c7babc9ab75e5d3665518cbd

        handshake=Noise_NN_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466114578170ac333f0a4036ded1f916a042a8b557f6b850f608d5f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=984f97fa7c1125c40ac0c3bb124e9a60fe179997c677873ab695f7b19ac262
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6826eeac32a5efc75cb0fcbdc9833c4fdcbad4923c77064f83ee7dfbdc288f

        handshake=Noise_NNpsk0_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541c2a9acfae038fa688b361ef2dab5318ec6e764eeaeb60312d9b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846633d99a5f182be11e11056d6f69deb26bfc780001cca9428c875d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0613a33b46a7b58b27aee0341bb301c9ab995009b4cc5184fbb5a8cf7be53d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=5cab31d679356097d8d190df5c068dee6e2ba4e4c275fd81e25c019bf65f6d

        handshake=Noise_NNpsk1_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541686d22f6e5298997dc08d43269f7d5bae51225e05e672adaef1
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466402b1ffabe29fc69e1da4133d3c9e013bc17c3e78f908ce4c654
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=abf9e02663066047949fc2b5618d5ac5e2c078cdb011b7ed7a8f97aa4436b0
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d85667b02a4a35a2c701afbca632f1c94741b2fc3345220d6b74af80134ca9

        handshake=Noise_NNpsk2_25519_ChaChaPoly_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b3a376dcfce9e9147a06727bb95b42b46c2791a6e07c1824a5af
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846693b56fc7a048915c8251fd399101582872eab051fbe3bc3ef39c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=be2eff0ceb13ed28f46bd59b64b8acb937ada777ee557f6147111e9fbc5d25
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=79c9684daee2cdbf5117ccd166e2da4ef6bfd9c7babc9ab75e5d3665518cbd
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_NN_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_NN_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484667cc0d7b4540fd183ba30ecbd3f464f16
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a0193b62b90fb3497108ec8adcc340a49ebb0a07f1654d71f7e38361f57ba5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b2afdcb051e896fa5b6a23def5ee6bdd6032f1b39b2d22ef7da01857648389

        handshake=Noise_NNpsk0_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544833316e6c21d899aec6c5f0c6e85e13
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d3ec4419885d86e6d7310fb1d2263afd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6a7b199c69a64cc2ea3c556cf17489fd2ae452d3f3c2a0871cebd327fc31c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e58d43e0c69d8c15df523586b2c58ca40cb0472b5b3775f1cca807fee28a71

        handshake=Noise_NNpsk1_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254da8ea488f6163eeccb6d3836ec6ccefd
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666f14491c4b69e43af265c51f3c3c09a7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84a7c955143ce45834b0acdef085054ab1a321668d7045dafc67b3e189f66d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=44cb770629debcb89480285522a1fd693b666884f7758f6f864c09c538c119

        handshake=Noise_NNpsk2_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625407418737b0236214775b43573cb13a23
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f6a7d8b64f54b20c5f93066303fb3170
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84c7ad0cff2af00d6c12896f0230233a99e1abeaef043747035d9a38c06f9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4bdd4800b3abd620ce9f4c519428acf7912af8b6507aa3befecce2444d2614

        handshake=Noise_NN_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663d8d136c2fcf7ecd3c3d631843bc33819e3a01f9b58040751011
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a0193b62b90fb3497108ec8adcc340a49ebb0a07f1654d71f7e38361f57ba5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b2afdcb051e896fa5b6a23def5ee6bdd6032f1b39b2d22ef7da01857648389

        handshake=Noise_NNpsk0_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d2f8054fcaf80f34700607e4422560b0626b1bc69e65290f6437
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e21a3177614fce09f014bde7e996fb8c8300777068e6fd2aa7c4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6a7b199c69a64cc2ea3c556cf17489fd2ae452d3f3c2a0871cebd327fc31c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e58d43e0c69d8c15df523586b2c58ca40cb0472b5b3775f1cca807fee28a71

        handshake=Noise_NNpsk1_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254422cb9f10bb05f92da10138bc8c286b5aa2f756e90b8edf48acb
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d48f5698c6af1a7d6f1c5755e27285251fe4aa9074a3ba30c3ca
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84a7c955143ce45834b0acdef085054ab1a321668d7045dafc67b3e189f66d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=44cb770629debcb89480285522a1fd693b666884f7758f6f864c09c538c119

        handshake=Noise_NNpsk2_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547bddd25c5d196f5110f02adbbd877b69e8a86f44e2aaa0ee24aa
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ad1970fd7307e7594135cfec5a24fac90fc08bc1b0f393ec250c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84c7ad0cff2af00d6c12896f0230233a99e1abeaef043747035d9a38c06f9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4bdd4800b3abd620ce9f4c519428acf7912af8b6507aa3befecce2444d2614

        handshake=Noise_NN_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662529efae98611941ab23ad370919a7f5
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a0193b62b90fb3497108ec8adcc340a49ebb0a07f1654d71f7e38361f57ba5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b2afdcb051e896fa5b6a23def5ee6bdd6032f1b39b2d22ef7da01857648389

        handshake=Noise_NNpsk0_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625486959ba2f588031f633a6c0e54a14ae5
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c8783e80be055a8f51e32418393af7cd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6a7b199c69a64cc2ea3c556cf17489fd2ae452d3f3c2a0871cebd327fc31c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e58d43e0c69d8c15df523586b2c58ca40cb0472b5b3775f1cca807fee28a71

        handshake=Noise_NNpsk1_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a0328c29b33470d04740e97e9514cbcd
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668badb8f25007a52eef9d16009be2c712
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84a7c955143ce45834b0acdef085054ab1a321668d7045dafc67b3e189f66d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=44cb770629debcb89480285522a1fd693b666884f7758f6f864c09c538c119

        handshake=Noise_NNpsk2_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540dae00c4de099415fc994fe385a4c2e5
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666a126d2d8d2dff1221cb69310cca148f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84c7ad0cff2af00d6c12896f0230233a99e1abeaef043747035d9a38c06f9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4bdd4800b3abd620ce9f4c519428acf7912af8b6507aa3befecce2444d2614

        handshake=Noise_NN_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663d8d136c2fcf7ecd3c3d4c93591205092db481f2a901eb96f06c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a0193b62b90fb3497108ec8adcc340a49ebb0a07f1654d71f7e38361f57ba5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=b2afdcb051e896fa5b6a23def5ee6bdd6032f1b39b2d22ef7da01857648389

        handshake=Noise_NNpsk0_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d2f8054fcaf80f347006e0fc25590a31fd33c4626fe59283ea40
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e21a3177614fce09f014af55e853ed6b88b0e4628e071b23e905
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=6a7b199c69a64cc2ea3c556cf17489fd2ae452d3f3c2a0871cebd327fc31c6
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=e58d43e0c69d8c15df523586b2c58ca40cb0472b5b3775f1cca807fee28a71

        handshake=Noise_NNpsk1_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254422cb9f10bb05f92da1086ba7a3f7fdeede2360802fce2bab641
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d48f5698c6af1a7d6f1cce81b2d248ccdd0f13d7c85b6b61d30a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84a7c955143ce45834b0acdef085054ab1a321668d7045dafc67b3e189f66d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=44cb770629debcb89480285522a1fd693b666884f7758f6f864c09c538c119

        handshake=Noise_NNpsk2_25519_AESGCM_SHA256
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547bddd25c5d196f5110f0e47e04cd720aa46674d274f35cc9219a
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ad1970fd7307e7594135c3fbe2866e29c265002153e2342cf6a0
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=84c7ad0cff2af00d6c12896f0230233a99e1abeaef043747035d9a38c06f9e
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4bdd4800b3abd620ce9f4c519428acf7912af8b6507aa3befecce2444d2614
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_NN_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_NN_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466546c757b1dee39fe34639f8e59d36b90
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9a465eef7a497d636aacec6f177a46820045154c6dc21cc887158ff7178f5f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a889eab9dcbdd768c92201eb7092fb3e9e2d1c87321fe70f6bd261b21a9aa1

        handshake=Noise_NNpsk0_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544ee81f7b223bb25827a6c6c707001dd3
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b0e7e624ccf4642b46e401e8b574cfa1
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2c2a25a39ec72b321405393e10c51caec56f8da5af863eb3d5875cbc99afe9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=31d8991d2ddb026d6ea7e4a1b1bf6388d87fa21d793547514f645d4724523a

        handshake=Noise_NNpsk1_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e4ed6d14e51cbd37289127ac1c818458
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846604d0bbf97d4b0d35616ddd8e3293e340
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=293dbf6b4293997b1f3609daa237dcf09ec2a79911ef69d311075b231f83cb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89ef11a27e48c5d96b7d4562a8ef782ede9b361e0efe9faacc97c90d361058

        handshake=Noise_NNpsk2_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254da9fb0ab9e465a7ae90061d62fc67048
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fa2036b0d82fc4c002454692a98cf138
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=5375de65fffa56df1d6e3e66a913430fe313c3418fdeda2e43afb34efd29c7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=979f3f045a786f9677281e84a4a5df198ec6a826f5969acc228ab6d1cda049

        handshake=Noise_NN_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466295bdf92326b33d62ca816fc6e8d84b579611812fea2df8204c8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9a465eef7a497d636aacec6f177a46820045154c6dc21cc887158ff7178f5f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a889eab9dcbdd768c92201eb7092fb3e9e2d1c87321fe70f6bd261b21a9aa1

        handshake=Noise_NNpsk0_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625437af6d133d63144ae694f990d6e209b9fc4b7cd0f5ca1307e06b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466823c7e1e048fa3767e86e0d471622865d0683936feec93cb113c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2c2a25a39ec72b321405393e10c51caec56f8da5af863eb3d5875cbc99afe9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=31d8991d2ddb026d6ea7e4a1b1bf6388d87fa21d793547514f645d4724523a

        handshake=Noise_NNpsk1_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b4d6af33ed485a97c7b78e7d1348afa4323f56148bcd00e812d4
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664410c5cc3bcf499527e4b6a7df87d8b5007c28b75228d5a62a41
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=293dbf6b4293997b1f3609daa237dcf09ec2a79911ef69d311075b231f83cb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89ef11a27e48c5d96b7d4562a8ef782ede9b361e0efe9faacc97c90d361058

        handshake=Noise_NNpsk2_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543e1214c67afb95f49d730eb2108ee24b3d646e4aff196aafde03
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846646e5b3a50b77fce5d9d013a0cc1d6bb43389bd89bfae89fdffc6
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=5375de65fffa56df1d6e3e66a913430fe313c3418fdeda2e43afb34efd29c7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=979f3f045a786f9677281e84a4a5df198ec6a826f5969acc228ab6d1cda049

        handshake=Noise_NN_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466cf2b3d8441501153c7ad77fff102d4ad
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9a465eef7a497d636aacec6f177a46820045154c6dc21cc887158ff7178f5f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a889eab9dcbdd768c92201eb7092fb3e9e2d1c87321fe70f6bd261b21a9aa1

        handshake=Noise_NNpsk0_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e1f68ba6e11a996f2eaf8e6cb3b13ffa
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662175601186f38e8e4a7912983c06a531
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2c2a25a39ec72b321405393e10c51caec56f8da5af863eb3d5875cbc99afe9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=31d8991d2ddb026d6ea7e4a1b1bf6388d87fa21d793547514f645d4724523a

        handshake=Noise_NNpsk1_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625400265a786349e17fbf3e17b4741a0f71
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ad5a7a0e7c3373008afa12e20e32f4bc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=293dbf6b4293997b1f3609daa237dcf09ec2a79911ef69d311075b231f83cb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89ef11a27e48c5d96b7d4562a8ef782ede9b361e0efe9faacc97c90d361058

        handshake=Noise_NNpsk2_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540d8253a4f31ebf4711fa4bad845bf9d0
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ec4107be3f3458a3c348dfda74cb2480
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=5375de65fffa56df1d6e3e66a913430fe313c3418fdeda2e43afb34efd29c7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=979f3f045a786f9677281e84a4a5df198ec6a826f5969acc228ab6d1cda049

        handshake=Noise_NN_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466295bdf92326b33d62ca8984f94b14878d51ba9ce00d1d3ff8a2d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=9a465eef7a497d636aacec6f177a46820045154c6dc21cc887158ff7178f5f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=a889eab9dcbdd768c92201eb7092fb3e9e2d1c87321fe70f6bd261b21a9aa1

        handshake=Noise_NNpsk0_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625437af6d133d63144ae6948b6affd3e6efdabe0650147eedb0be22
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466823c7e1e048fa3767e86d07cedbf0af0e30b9bf2390a8a6891c5
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=2c2a25a39ec72b321405393e10c51caec56f8da5af863eb3d5875cbc99afe9
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=31d8991d2ddb026d6ea7e4a1b1bf6388d87fa21d793547514f645d4724523a

        handshake=Noise_NNpsk1_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b4d6af33ed485a97c7b76404c4af6bd734344a8deb859a576eb0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664410c5cc3bcf499527e474b5995606d95c03e01d927792b13f20
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=293dbf6b4293997b1f3609daa237dcf09ec2a79911ef69d311075b231f83cb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=89ef11a27e48c5d96b7d4562a8ef782ede9b361e0efe9faacc97c90d361058

        handshake=Noise_NNpsk2_25519_AESGCM_SHA512
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543e1214c67afb95f49d731e6796c13bf0aff823ea8ff9d0a0c167
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846646e5b3a50b77fce5d9d054b5a59fddb6f6f965ad8a102b98c3e7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=5375de65fffa56df1d6e3e66a913430fe313c3418fdeda2e43afb34efd29c7
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=979f3f045a786f9677281e84a4a5df198ec6a826f5969acc228ab6d1cda049
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}
