//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class N_Handshake_Tests: XCTestCase {
    
    func test_Noise_N_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_N_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625466758477eb5e8e0b273460a89ef8d8bb
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=2e89db912502b14e9dbf21dc062b494ac2e25f2010ba86f246759fdb8bd990
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=505ffc87ec9cca139162b049416af8ca811e7044897d399912f9a139ac65ec

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625404ec6da801ab66f5e59f874f002af309
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=bf4151a9d4b9f4250c91542ee802a0701692a141344edb1ef3e831a8210e1c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c1dc8651b5c1d3f4189f858a7972bfd62a4123530c64d4239457fa7e46c10a

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546d32a96bccf7b2b063e7745276a99f6e
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=6b24bc0b584f4ca451495cdddeed74727d03f88fc561227b4cf2486f3bb360
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=60f010c122da08e08781f409477350a6da336e03bf3eb266693b581dd61826

        handshake=Noise_N_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a703e3bfcc38dbdb465b7d5ded3686008b3ff4c92f20e9fe4b44
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=2e89db912502b14e9dbf21dc062b494ac2e25f2010ba86f246759fdb8bd990
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=505ffc87ec9cca139162b049416af8ca811e7044897d399912f9a139ac65ec

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625457027708cda785ef784def1e032c2ffbbcbed3108edbbb565140
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=bf4151a9d4b9f4250c91542ee802a0701692a141344edb1ef3e831a8210e1c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c1dc8651b5c1d3f4189f858a7972bfd62a4123530c64d4239457fa7e46c10a

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625407e786c1a8d1e6880cf0c8ce414c8d2dbf57be2fd7c3152586df
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=6b24bc0b584f4ca451495cdddeed74727d03f88fc561227b4cf2486f3bb360
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=60f010c122da08e08781f409477350a6da336e03bf3eb266693b581dd61826

        handshake=Noise_N_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625439e0d27ade0e68178eedc32a520154b9
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=2e89db912502b14e9dbf21dc062b494ac2e25f2010ba86f246759fdb8bd990
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=505ffc87ec9cca139162b049416af8ca811e7044897d399912f9a139ac65ec

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c1180d93ec09b5da7a888f7b5b9e9d6e
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=bf4151a9d4b9f4250c91542ee802a0701692a141344edb1ef3e831a8210e1c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c1dc8651b5c1d3f4189f858a7972bfd62a4123530c64d4239457fa7e46c10a

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547d8ce635d32999d4ca2bb00175c04248
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=6b24bc0b584f4ca451495cdddeed74727d03f88fc561227b4cf2486f3bb360
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=60f010c122da08e08781f409477350a6da336e03bf3eb266693b581dd61826

        handshake=Noise_N_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a703e3bfcc38dbdb465bc83726dbcf8aa4764c684931d2985245
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=2e89db912502b14e9dbf21dc062b494ac2e25f2010ba86f246759fdb8bd990
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=505ffc87ec9cca139162b049416af8ca811e7044897d399912f9a139ac65ec

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625457027708cda785ef784de0eed7a36afc2fad22523e691cd155e5
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=bf4151a9d4b9f4250c91542ee802a0701692a141344edb1ef3e831a8210e1c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c1dc8651b5c1d3f4189f858a7972bfd62a4123530c64d4239457fa7e46c10a

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625407e786c1a8d1e6880cf049f2b82299602ae37ab12f077040a55a
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=6b24bc0b584f4ca451495cdddeed74727d03f88fc561227b4cf2486f3bb360
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=60f010c122da08e08781f409477350a6da336e03bf3eb266693b581dd61826
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_N_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_N_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625481e3638895f74c7f2fb79478a8b1ef0b
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=94858a8929ec3029eee24ac3b9430a0ad960324b465ebf1e4a4e5b42d5578d
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0d950d3e8b3b1c1e92f0672fa29e408ff3051ceb7ab03a61419559a6772f08

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625464629b177388333c8d175896ab297935
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=33da6aeec7478a08f7878c62fd7fcc88165cf1bf47953546ac1b64fb183258
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=3376b3ceedfdeaf78df87cfaeabbe7a3b4cb1ffb9ee72b05a36aaa4fea99ee

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625450b0f423d7d637d7a460b86a48cc487b
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e33fa900c0dcebe93bce0408696d13866c780766f0c670a3932b0d05c1c69b
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c06aac8a526a8b995fafc59f9ffe856c8316d9fd97db9ba322bd4dbc940158

        handshake=Noise_N_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548d5c068cc55c86ec3234b490d40afc4cf4d6263378881c946d7f
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=94858a8929ec3029eee24ac3b9430a0ad960324b465ebf1e4a4e5b42d5578d
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0d950d3e8b3b1c1e92f0672fa29e408ff3051ceb7ab03a61419559a6772f08

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f8dbb976f32d75fe4f1fdd32667b33832835533005266a53712b
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=33da6aeec7478a08f7878c62fd7fcc88165cf1bf47953546ac1b64fb183258
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=3376b3ceedfdeaf78df87cfaeabbe7a3b4cb1ffb9ee72b05a36aaa4fea99ee

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254354f2847f89991ee82660859ba99e38c0b65beffa762a956db43
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e33fa900c0dcebe93bce0408696d13866c780766f0c670a3932b0d05c1c69b
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c06aac8a526a8b995fafc59f9ffe856c8316d9fd97db9ba322bd4dbc940158

        handshake=Noise_N_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dc989d32c66a940d8f3bb092ec1cc39b
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=94858a8929ec3029eee24ac3b9430a0ad960324b465ebf1e4a4e5b42d5578d
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0d950d3e8b3b1c1e92f0672fa29e408ff3051ceb7ab03a61419559a6772f08

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254adb2ef9e38153b82ab826cf2c293d2e2
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=33da6aeec7478a08f7878c62fd7fcc88165cf1bf47953546ac1b64fb183258
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=3376b3ceedfdeaf78df87cfaeabbe7a3b4cb1ffb9ee72b05a36aaa4fea99ee

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d8a9ac9ddfea0fd3f61053e5cce9c468
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e33fa900c0dcebe93bce0408696d13866c780766f0c670a3932b0d05c1c69b
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c06aac8a526a8b995fafc59f9ffe856c8316d9fd97db9ba322bd4dbc940158

        handshake=Noise_N_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548d5c068cc55c86ec32343e3869720328a5659aa70ee82a7e2153
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=94858a8929ec3029eee24ac3b9430a0ad960324b465ebf1e4a4e5b42d5578d
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0d950d3e8b3b1c1e92f0672fa29e408ff3051ceb7ab03a61419559a6772f08

        handshake=Noise_Npsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f8dbb976f32d75fe4f1fcbe700b9013b07745aafab8bf4e2fa7b
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=33da6aeec7478a08f7878c62fd7fcc88165cf1bf47953546ac1b64fb183258
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=3376b3ceedfdeaf78df87cfaeabbe7a3b4cb1ffb9ee72b05a36aaa4fea99ee

        handshake=Noise_Npsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254354f2847f89991ee82666c5a1d2c330638acc769bec02338bfb4
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e33fa900c0dcebe93bce0408696d13866c780766f0c670a3932b0d05c1c69b
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=c06aac8a526a8b995fafc59f9ffe856c8316d9fd97db9ba322bd4dbc940158
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_N_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_N_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625471bcc2ec91fac5d2551b8a08e39ae5ab
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=374a734846ea8b76251255d17bae5b5313087ff42afa23ed42a5b5bf325804
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=922037b8012e37d18adb6827375085f06f034888ea3f625dfc91d424334290

        handshake=Noise_Npsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254340a10ebcc2642dfbcf5af7f2bf975a9
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e20e59bdd4cb2aa25691345a5b462b2cf85084b15643091c4fc173f16dc5d7
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=68c7d8986c79c6f8b4589765ef1cc903024c6e8759bf05776335d9e065abe7

        handshake=Noise_Npsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254bd29db2d71093718be3c9068ae19b028
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=3caf03e7b531dd629d062fa119ea14d08939bf79327005f276b9a99c5400f0
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=4638116fe8341f36f69c2e646687fd4f6b5b5f10dec581a9ca8202f016f8f8

        handshake=Noise_N_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254df115f83f13b64589fecddf876dd30eb9ba694948e5169479513
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=374a734846ea8b76251255d17bae5b5313087ff42afa23ed42a5b5bf325804
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=922037b8012e37d18adb6827375085f06f034888ea3f625dfc91d424334290

        handshake=Noise_Npsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625406dd68c4f13f48b25468230d7cef980524e27eaabc8ba348da29
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e20e59bdd4cb2aa25691345a5b462b2cf85084b15643091c4fc173f16dc5d7
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=68c7d8986c79c6f8b4589765ef1cc903024c6e8759bf05776335d9e065abe7

        handshake=Noise_Npsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c13a66d1ae511893d991fdd6649d5aa540467596b854ff69e59e
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=3caf03e7b531dd629d062fa119ea14d08939bf79327005f276b9a99c5400f0
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=4638116fe8341f36f69c2e646687fd4f6b5b5f10dec581a9ca8202f016f8f8

        handshake=Noise_N_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ceb26e62698f0a9d16577f5fcb929fb3
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=374a734846ea8b76251255d17bae5b5313087ff42afa23ed42a5b5bf325804
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=922037b8012e37d18adb6827375085f06f034888ea3f625dfc91d424334290

        handshake=Noise_Npsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c84f374576798a9ac7c4e4f3d6fb1660
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e20e59bdd4cb2aa25691345a5b462b2cf85084b15643091c4fc173f16dc5d7
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=68c7d8986c79c6f8b4589765ef1cc903024c6e8759bf05776335d9e065abe7

        handshake=Noise_Npsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545b20f16a10cf8aec5558e9615c798606
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=3caf03e7b531dd629d062fa119ea14d08939bf79327005f276b9a99c5400f0
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=4638116fe8341f36f69c2e646687fd4f6b5b5f10dec581a9ca8202f016f8f8

        handshake=Noise_N_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254df115f83f13b64589fec852ae179184185e9d29fed35f4d235dc
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=374a734846ea8b76251255d17bae5b5313087ff42afa23ed42a5b5bf325804
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=922037b8012e37d18adb6827375085f06f034888ea3f625dfc91d424334290

        handshake=Noise_Npsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625406dd68c4f13f48b25468727d65e4f2c438542b1a8181a53dcc73
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=e20e59bdd4cb2aa25691345a5b462b2cf85084b15643091c4fc173f16dc5d7
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=68c7d8986c79c6f8b4589765ef1cc903024c6e8759bf05776335d9e065abe7

        handshake=Noise_Npsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c13a66d1ae511893d9916e916af9cabdd72bf1d4e58c91685c96
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=3caf03e7b531dd629d062fa119ea14d08939bf79327005f276b9a99c5400f0
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=4638116fe8341f36f69c2e646687fd4f6b5b5f10dec581a9ca8202f016f8f8
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_N_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_N_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a69eac07dc78694d6a30a4c7f2120bc4
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=53dc944be58d1292365d6a5096b1d990353d826dd51e0cfeef9820d480d814
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0ac777bf15a2f8e9ae4c0fd7d53aa4b6b61cbb33ea1e64f726aa51cb6c3b57

        handshake=Noise_Npsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548ee4ea4ef70d80e3be3383136c01dba7
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=7b2521d4d92735ed21e8ef9b635353c6cbbe6ba708e234d8d30c593af6091c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=5a66f48e7581384a50a8a6197a76a21fe6e109f3b3c9c89cd335845970a875

        handshake=Noise_Npsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254341b1bfc14a6369937b021c81f3b19a0
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=f2a1148bdbfaf3843292d3ad1d665cb11a83f1a412c3f9c04f6b876a91ff00
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=caa8b41e1b5d2289d4f8e91ee4587dbc6335873e1a9b1f9f4a220d3cbbdd2d

        handshake=Noise_N_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254059099a62768f40676c0696be1c8076e4620fb27faad0ae8abb2
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=53dc944be58d1292365d6a5096b1d990353d826dd51e0cfeef9820d480d814
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0ac777bf15a2f8e9ae4c0fd7d53aa4b6b61cbb33ea1e64f726aa51cb6c3b57

        handshake=Noise_Npsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cff66e55f9165514342e82b98a436b78c1172bd9a5d44538c499
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=7b2521d4d92735ed21e8ef9b635353c6cbbe6ba708e234d8d30c593af6091c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=5a66f48e7581384a50a8a6197a76a21fe6e109f3b3c9c89cd335845970a875

        handshake=Noise_Npsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542bf8c34c79ce1dd4da49f8ed9dfdbbe608500f4aeb3610f2ebf5
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=f2a1148bdbfaf3843292d3ad1d665cb11a83f1a412c3f9c04f6b876a91ff00
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=caa8b41e1b5d2289d4f8e91ee4587dbc6335873e1a9b1f9f4a220d3cbbdd2d

        handshake=Noise_N_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c927ef8c933450ef29c8fe116405cad6
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=53dc944be58d1292365d6a5096b1d990353d826dd51e0cfeef9820d480d814
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0ac777bf15a2f8e9ae4c0fd7d53aa4b6b61cbb33ea1e64f726aa51cb6c3b57

        handshake=Noise_Npsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254fba424bfce5fb315d8c4452c719600d4
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=7b2521d4d92735ed21e8ef9b635353c6cbbe6ba708e234d8d30c593af6091c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=5a66f48e7581384a50a8a6197a76a21fe6e109f3b3c9c89cd335845970a875

        handshake=Noise_Npsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e88eae4b737047e2ebd9a57e4179dee4
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=f2a1148bdbfaf3843292d3ad1d665cb11a83f1a412c3f9c04f6b876a91ff00
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=caa8b41e1b5d2289d4f8e91ee4587dbc6335873e1a9b1f9f4a220d3cbbdd2d

        handshake=Noise_N_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254059099a62768f40676c0ad747e00bc4abdc4e547b5d64a203faa
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=53dc944be58d1292365d6a5096b1d990353d826dd51e0cfeef9820d480d814
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=0ac777bf15a2f8e9ae4c0fd7d53aa4b6b61cbb33ea1e64f726aa51cb6c3b57

        handshake=Noise_Npsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cff66e55f9165514342e009262a3b2d4fb0efd940a5ae53f42f7
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=7b2521d4d92735ed21e8ef9b635353c6cbbe6ba708e234d8d30c593af6091c
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=5a66f48e7581384a50a8a6197a76a21fe6e109f3b3c9c89cd335845970a875

        handshake=Noise_Npsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542bf8c34c79ce1dd4da4984d89bde8e3c00ff7204e7e3e7845bf3
        msg_1_payload=79656c6c6f777375626d6172696e65
        msg_1_ciphertext=f2a1148bdbfaf3843292d3ad1d665cb11a83f1a412c3f9c04f6b876a91ff00
        msg_2_payload=7375626d6172696e6579656c6c6f77
        msg_2_ciphertext=caa8b41e1b5d2289d4f8e91ee4587dbc6335873e1a9b1f9f4a220d3cbbdd2d
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}

