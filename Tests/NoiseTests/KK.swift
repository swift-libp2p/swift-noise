//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import Crypto
import XCTest

@testable import Noise

final class KK_Handshake_Tests: XCTestCase {

    func test_Noise_KK_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
            handshake=Noise_KK_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254de3641cda8802b636ee7afe370f7e34e
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e4c15cda24dee01c5c60ef6c4d6b92b3
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=ab44bf778165ad086eaebbb994df826628b3fe26ad310642480a1b2af8fc23
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=baacf816b83aaeb15954621113f8e0603cb79168fe6308b87413004beee4d2

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625498bf0afa6ad430bef2179595b80f00af
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660bc0a013b37277dafd0e2a2073ac3cc0
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=fe6f6f749a1495883a1715674543c2ebe56c1cb674d4f4e47f9086553700ce
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=7a88c03c458db5b49827d899535210ba453d7dfc0f76a661b8cad08cf967ef

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625482f300522a0b96d0e03c3d41f98f6030
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846652279732a99893f3b89cf55f3784a3b5
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=de7af56efebaae1c6a616b624b39a441d8b82e09a2f2a30531a7c30441e6eb
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=408aae72aaa26f98d436f4a64c34ea26baa1802548774b8f14cff3d1891895

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f76e9ef85e5bc141f0d2ac73c491af69
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466479ea79a1a541cbc7eb522078716e1d4
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cdafd1b6afea01667934ed26de85e3a200927343f534ccee0bdab0fbbe5aee
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=2c4b0bdb11291ee7b67616af3c37e7a9f8c400c715e7f9142a620db4fd3e05

            handshake=Noise_KK_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254558809aaeff03abdf354a87685ef23c3191ad86ae0c81bbaafa8
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f7c3b2f7cef28a2f21245150a4abd05d6404ab474c115c578ea5
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=ab44bf778165ad086eaebbb994df826628b3fe26ad310642480a1b2af8fc23
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=baacf816b83aaeb15954621113f8e0603cb79168fe6308b87413004beee4d2

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b999c716e2b5ebd7dddc18c68985cfb4351b19d5aa51e6b6a3d9
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ad07cf9d7d4c88039123d1fae114ca14da9754cad2103495e943
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=fe6f6f749a1495883a1715674543c2ebe56c1cb674d4f4e47f9086553700ce
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=7a88c03c458db5b49827d899535210ba453d7dfc0f76a661b8cad08cf967ef

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541a96b079a0d93c9c8a155898e5985630a9b1f023773114dabe32
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466677a31f9e25c3322951402efef0b854d68e456565be88e0d51a2
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=de7af56efebaae1c6a616b624b39a441d8b82e09a2f2a30531a7c30441e6eb
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=408aae72aaa26f98d436f4a64c34ea26baa1802548774b8f14cff3d1891895

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543d75d4599f7a207000b95e3ba21772976160bc0d0e9d849b969b
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669ba2c1c12e0ae525b5442707aa5ea703c57d8aa875aa18ed909a
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cdafd1b6afea01667934ed26de85e3a200927343f534ccee0bdab0fbbe5aee
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=2c4b0bdb11291ee7b67616af3c37e7a9f8c400c715e7f9142a620db4fd3e05

            handshake=Noise_KK_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c2b1750e0c698c0a6112819f9c76fc36
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846680da3b11f10f1a9b7790d0edd4dffbaf
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=ab44bf778165ad086eaebbb994df826628b3fe26ad310642480a1b2af8fc23
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=baacf816b83aaeb15954621113f8e0603cb79168fe6308b87413004beee4d2

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543dbdbd15ce16ebbd5cbe94c31693a31d
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466c6530671018ea8a0fc755a25fc2567ce
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=fe6f6f749a1495883a1715674543c2ebe56c1cb674d4f4e47f9086553700ce
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=7a88c03c458db5b49827d899535210ba453d7dfc0f76a661b8cad08cf967ef

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254840a997d6af2ba012dd07b2df7798fee
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ca8bb47ff4a43848304c6d2edcf068dd
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=de7af56efebaae1c6a616b624b39a441d8b82e09a2f2a30531a7c30441e6eb
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=408aae72aaa26f98d436f4a64c34ea26baa1802548774b8f14cff3d1891895

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625482752d661cd7555efeb06de81c9c7440
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466faf6abfeb8c57688af793a94b8b59903
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cdafd1b6afea01667934ed26de85e3a200927343f534ccee0bdab0fbbe5aee
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=2c4b0bdb11291ee7b67616af3c37e7a9f8c400c715e7f9142a620db4fd3e05

            handshake=Noise_KK_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254558809aaeff03abdf354ad47d26523f1b98b5ce386c3b066ff53
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f7c3b2f7cef28a2f212487967f4b709e22ff452dcb68821a10aa
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=ab44bf778165ad086eaebbb994df826628b3fe26ad310642480a1b2af8fc23
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=baacf816b83aaeb15954621113f8e0603cb79168fe6308b87413004beee4d2

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b999c716e2b5ebd7dddc071a74c7c4c9cb80ac268b23a5284fc2
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ad07cf9d7d4c88039123b962375716b252dc4ad12cfe6f5d4bb8
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=fe6f6f749a1495883a1715674543c2ebe56c1cb674d4f4e47f9086553700ce
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=7a88c03c458db5b49827d899535210ba453d7dfc0f76a661b8cad08cf967ef

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541a96b079a0d93c9c8a154abc656a5b149ecbeb06e87583b65868
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466677a31f9e25c33229514bb8c7076d4faff8789a0e351738b86fd
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=de7af56efebaae1c6a616b624b39a441d8b82e09a2f2a30531a7c30441e6eb
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=408aae72aaa26f98d436f4a64c34ea26baa1802548774b8f14cff3d1891895

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543d75d4599f7a207000b9c74a6e5fb64546dabaea326eae41e103
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669ba2c1c12e0ae525b54442c957df906bb8905ee7620374ebf0b2
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cdafd1b6afea01667934ed26de85e3a200927343f534ccee0bdab0fbbe5aee
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=2c4b0bdb11291ee7b67616af3c37e7a9f8c400c715e7f9142a620db4fd3e05
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_KK_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
            handshake=Noise_KK_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625422ed6d5d012d0c7b8b7c91b303b2eeaa
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484667db7a98eb9c50939d9d424becba2cfe4
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0dc5775f180ebbca24ba2dbedf7df763974789fffe201a7158f92c61c21e56
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=94573c8b800345c65607ec7bd2244bcd871c8e73247b6835ad35334257460c

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625435c738ecdc74a3da8ba56685cbda15fb
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e6f50e396f3bfa2a91db76cf3550b57a
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cb7d802310849d2cbcb2bf628d5b5be8694cff1cd9d9fe4d88270315550664
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=8c51f3b2a7bdef2910114236378b9d97d5b0a5054f3e6e0b93d9ba1439a314

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542aa38a5f7583c960333ffdb92f005d72
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b3a625b74b537cdd5581ca17b2d20c91
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=14e6e930733e777341e6bb7ec522f24f7aff05b125bf49d45b5150d2c8eee8
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=39a6c784e7e5f91d33ba6200a4bfb333e9e5d5974e89b8c92f7cca58641e98

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ac287025515a5ec183f396ac7626bceb
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466680cff1a53276ab7f03431d5fe2ddf49
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=1ee2a40d2d547aa1ecff9085d876d61bef6d5faa010db3e983313e28a84176
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=022620f1e6e067f7af42f407df7b37bfe24da7a7d79d91f3d3278bee00809f

            handshake=Noise_KK_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625439201e9eaf437b4be19b1452073cf37e9fad03973780eb051f13
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669d683ff6a052688a4bf54d599e036fb4cf5d8c4fe35628270a9a
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0dc5775f180ebbca24ba2dbedf7df763974789fffe201a7158f92c61c21e56
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=94573c8b800345c65607ec7bd2244bcd871c8e73247b6835ad35334257460c

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c7d83c70d4f86e56a84f48e3f71d9451d09c606773101e89a3fa
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662d99936cb48465009334c1afddb55f62072449be590183a496b7
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cb7d802310849d2cbcb2bf628d5b5be8694cff1cd9d9fe4d88270315550664
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=8c51f3b2a7bdef2910114236378b9d97d5b0a5054f3e6e0b93d9ba1439a314

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625428bddcbf220404e1f3344e37fae6b2b658565e8322fde73aae4a
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b6be75c4a8160a18b20eafa7a5919dbc8dab95aa27d4604038ec
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=14e6e930733e777341e6bb7ec522f24f7aff05b125bf49d45b5150d2c8eee8
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=39a6c784e7e5f91d33ba6200a4bfb333e9e5d5974e89b8c92f7cca58641e98

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dcbb401e89f43c8af94bbdf465fb33a6d47244a2b418f7946bf4
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466766cf40c486fe6860ad473d82a2500671ef59ee6cd2096af1427
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=1ee2a40d2d547aa1ecff9085d876d61bef6d5faa010db3e983313e28a84176
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=022620f1e6e067f7af42f407df7b37bfe24da7a7d79d91f3d3278bee00809f

            handshake=Noise_KK_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546100613cdbb5fe7b350dc52dba01d51c
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846613f7bc06352a6a111cf882cbb90fb733
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0dc5775f180ebbca24ba2dbedf7df763974789fffe201a7158f92c61c21e56
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=94573c8b800345c65607ec7bd2244bcd871c8e73247b6835ad35334257460c

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254186a15c02343bc4dd83d048fa63f5304
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484665e19c67762e245b10dd4f42441152693
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cb7d802310849d2cbcb2bf628d5b5be8694cff1cd9d9fe4d88270315550664
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=8c51f3b2a7bdef2910114236378b9d97d5b0a5054f3e6e0b93d9ba1439a314

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aafd5f671a619fdf23e78fdde0739a99
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846608923bb663020fcbd98f46f96b19838e
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=14e6e930733e777341e6bb7ec522f24f7aff05b125bf49d45b5150d2c8eee8
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=39a6c784e7e5f91d33ba6200a4bfb333e9e5d5974e89b8c92f7cca58641e98

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b612c908afa3994b259f7bbe6f61d48b
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660200b1bebc05ec930091302b462ee495
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=1ee2a40d2d547aa1ecff9085d876d61bef6d5faa010db3e983313e28a84176
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=022620f1e6e067f7af42f407df7b37bfe24da7a7d79d91f3d3278bee00809f

            handshake=Noise_KK_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625439201e9eaf437b4be19be0e1fd46345e956541b7a79bedfc0a44
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669d683ff6a052688a4bf5d08f5e907b60839eaf900ab19faff7b3
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0dc5775f180ebbca24ba2dbedf7df763974789fffe201a7158f92c61c21e56
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=94573c8b800345c65607ec7bd2244bcd871c8e73247b6835ad35334257460c

            handshake=Noise_KKpsk0_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c7d83c70d4f86e56a84f27bf60c3bd52c62f0ee0b8dd9fc54d94
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662d99936cb484650093346699bf1d8c0806c839532d2d8ab258d1
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=cb7d802310849d2cbcb2bf628d5b5be8694cff1cd9d9fe4d88270315550664
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=8c51f3b2a7bdef2910114236378b9d97d5b0a5054f3e6e0b93d9ba1439a314

            handshake=Noise_KKpsk1_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625428bddcbf220404e1f3342045d5a40b989d199aea6a10b95443af
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b6be75c4a8160a18b20ed33cc111a2da1ba4ad020106b496a765
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=14e6e930733e777341e6bb7ec522f24f7aff05b125bf49d45b5150d2c8eee8
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=39a6c784e7e5f91d33ba6200a4bfb333e9e5d5974e89b8c92f7cca58641e98

            handshake=Noise_KKpsk2_25519_ChaChaPoly_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dcbb401e89f43c8af94bc27709f8e7ea9d2baeacbe96f51e4d92
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466766cf40c486fe6860ad4ed44c066c8102966ab34d3e295b04ebe
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=1ee2a40d2d547aa1ecff9085d876d61bef6d5faa010db3e983313e28a84176
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=022620f1e6e067f7af42f407df7b37bfe24da7a7d79d91f3d3278bee00809f
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_KK_25519_AESGCM_SHA256() throws {
        let vectors = """
            handshake=Noise_KK_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662543f53f25dc2eca97efae6a4a4b847de06
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484660f506ffcf6b2781821b24b70b8fad884
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0e79035855cdea04bc833d5ff63291042c6e12b0ac55ef2c4096deed1cbac2
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=c6dbcc2ac8f85338732b71a58f4c3be89bdfa7b2da8a8506ec4f1d2d9299a0

            handshake=Noise_KKpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f8ec97c143e2e9193574ea4989ebc3a2
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484668021ddcdb7eb8e89d8034de9248af340
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=13f09ec7877b005731a876958cec004a7f9c2734e971828082db441ce001c1
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=cf3a9cb9da7eb9bea19447b1f9bea60ac70124dfef886e9b82cd52f748c682

            handshake=Noise_KKpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662542a366ea33985fc1669836b873058f89a
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664aad05b9467f884f79f963ec5febb35f
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=96252868cb85131fc634b43f37c135da2b02902158369ec7a8e6b45b246732
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=52822ad96c98c7ebcf68cafe91b6f18929aad75af5424a973cdb0f004b3832

            handshake=Noise_KKpsk2_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b7cf6c9cefd4f1fb33dddd9f27acdb20
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661fe30c2f7bbae74d87402b1cd73c4862
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d219ab65f4416d18e67f501afa99f43009c0a1c2c78427b1dcbdd6cf020928
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=1c6b3e31392287e06fcc5a885ea8690e39a2d3d54e23f5aeca14fca3c2f053

            handshake=Noise_KK_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f076403f2e0cdd201c5aae9d1539c9ad90262eefea9c90a5397b
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f12abbcda56565bf3fa3254fe35ad97f3e9d5e25aa296741ec3e
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0e79035855cdea04bc833d5ff63291042c6e12b0ac55ef2c4096deed1cbac2
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=c6dbcc2ac8f85338732b71a58f4c3be89bdfa7b2da8a8506ec4f1d2d9299a0

            handshake=Noise_KKpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625413c6b4c495bbc7b95432907247ab38b5bb507bcf4f32abbd490e
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466169cfd28ccd38213e17be5b967a6ff6de85f6949f26824243711
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=13f09ec7877b005731a876958cec004a7f9c2734e971828082db441ce001c1
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=cf3a9cb9da7eb9bea19447b1f9bea60ac70124dfef886e9b82cd52f748c682

            handshake=Noise_KKpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f45eb20acd443feff46beebe27c56ffdd58063a70d706f8640c6
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d510ee9dd1b542ca5a0d0c5756779245766d964eef8f34867872
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=96252868cb85131fc634b43f37c135da2b02902158369ec7a8e6b45b246732
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=52822ad96c98c7ebcf68cafe91b6f18929aad75af5424a973cdb0f004b3832

            handshake=Noise_KKpsk2_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540590c32754712b9ce391e4773cd5b7c761ef65b6cb530ab10d8f
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f1bd851e93bfded9a6c7d56b6672e23bdc4a53bdc9e10961b1f0
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d219ab65f4416d18e67f501afa99f43009c0a1c2c78427b1dcbdd6cf020928
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=1c6b3e31392287e06fcc5a885ea8690e39a2d3d54e23f5aeca14fca3c2f053

            handshake=Noise_KK_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d05f754c90d580f21b243391fe987af4
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f8f3babbd403b9665488570810b364dd
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0e79035855cdea04bc833d5ff63291042c6e12b0ac55ef2c4096deed1cbac2
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=c6dbcc2ac8f85338732b71a58f4c3be89bdfa7b2da8a8506ec4f1d2d9299a0

            handshake=Noise_KKpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625420f8e0f9c7579f754ce9b5e05f5cee81
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b05668d3dcd247a08e099cbeb58174df
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=13f09ec7877b005731a876958cec004a7f9c2734e971828082db441ce001c1
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=cf3a9cb9da7eb9bea19447b1f9bea60ac70124dfef886e9b82cd52f748c682

            handshake=Noise_KKpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546bfe451377763da7a318dbfc124530f9
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484662f550d35da0ef73348c5f2a8be605444
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=96252868cb85131fc634b43f37c135da2b02902158369ec7a8e6b45b246732
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=52822ad96c98c7ebcf68cafe91b6f18929aad75af5424a973cdb0f004b3832

            handshake=Noise_KKpsk2_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625456ad94f8b8869d6b972be9a552537a3c
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466dfd7a0cc157b4afc52ff249d573f1358
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d219ab65f4416d18e67f501afa99f43009c0a1c2c78427b1dcbdd6cf020928
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=1c6b3e31392287e06fcc5a885ea8690e39a2d3d54e23f5aeca14fca3c2f053

            handshake=Noise_KK_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f076403f2e0cdd201c5a743d4aab448e6e3b29d4aa05628a5cbd
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f12abbcda56565bf3fa37b196488daf515b7434096aa1638346b
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0e79035855cdea04bc833d5ff63291042c6e12b0ac55ef2c4096deed1cbac2
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=c6dbcc2ac8f85338732b71a58f4c3be89bdfa7b2da8a8506ec4f1d2d9299a0

            handshake=Noise_KKpsk0_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625413c6b4c495bbc7b95432535cc6716834442ddae5e177d5bfd397
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466169cfd28ccd38213e17b518f78c70703c52b0d8d51d4479b557a
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=13f09ec7877b005731a876958cec004a7f9c2734e971828082db441ce001c1
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=cf3a9cb9da7eb9bea19447b1f9bea60ac70124dfef886e9b82cd52f748c682

            handshake=Noise_KKpsk1_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f45eb20acd443feff46b315ad0366d803b7da09e6b84e12c1064
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466d510ee9dd1b542ca5a0dca75e69bc396eea2dadec726382e2030
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=96252868cb85131fc634b43f37c135da2b02902158369ec7a8e6b45b246732
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=52822ad96c98c7ebcf68cafe91b6f18929aad75af5424a973cdb0f004b3832

            handshake=Noise_KKpsk2_25519_AESGCM_SHA256
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662540590c32754712b9ce391bf35caa325f1ed107ec12d5cb4fc49af
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466f1bd851e93bfded9a6c776e0614d573731a40e7f562f6f3c067f
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d219ab65f4416d18e67f501afa99f43009c0a1c2c78427b1dcbdd6cf020928
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=1c6b3e31392287e06fcc5a885ea8690e39a2d3d54e23f5aeca14fca3c2f053
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }

    func test_Noise_KK_25519_AESGCM_SHA512() throws {
        let vectors = """
            handshake=Noise_KK_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cbe8f77ad210ff754922c56591edaf17
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466b9198d85a19fe670094c3f65b567f3b5
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=6b689fca5f9af8029b40d692f66dab834d9b1ad71ef02e12f0ec068a93ba55
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=126650ec27e76d0de04fc556ef662a4a0cd619b62daacd5110dc43bfe1c1ba

            handshake=Noise_KKpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cfc494240128ca1a452dedf604a4aa1c
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e88e00d5fc2996457fd334c4f011f7cc
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d15b43ffc8c33b514f6b1d1cb5a9baac7bb9e8ab7fa60db501342d4369c737
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=6bd6bdae40d6880a9cf6572e48db7cde278aa1dedd855791167a093d62b2dc

            handshake=Noise_KKpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625437534665c31a179f15fb392f7617e6b4
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846651a78581524074d4053423c2a7380160
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=5ee8fab16de07e20d98cd7a3cfcd72d229520670746f1fcaaa1127c729994d
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=ee6791cd8c9a12ecd260c7efcf6d0b094f05828949743f7f1da36d2fead3bd

            handshake=Noise_KKpsk2_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625493708ed5d90a001924c0e673e87cb122
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484669f5abbd68865b250dfbf71912d44074b
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0304f4a07a39789848204b1ac1fe2004f035cbb474b1e3f4f11b6f09aaff19
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=14bb951739a8ed231acc6348dcbe342ea124dd4d53a4a463ef415ebd15cb0d

            handshake=Noise_KK_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254983397660911ddae03feba9474c170c3f303fd4d39625083903a
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466beeba4b2e28bbb5d84eea1eb61d690d124b95b3c9f26a166fb5f
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=6b689fca5f9af8029b40d692f66dab834d9b1ad71ef02e12f0ec068a93ba55
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=126650ec27e76d0de04fc556ef662a4a0cd619b62daacd5110dc43bfe1c1ba

            handshake=Noise_KKpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625432687ae9f41a125bbb260be5b0199fb6934a0986470429e21cc4
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466678c53d1c8fb7d77e1c7ad887a31a56e2c7281c1bcb3bd549a7d
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d15b43ffc8c33b514f6b1d1cb5a9baac7bb9e8ab7fa60db501342d4369c737
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=6bd6bdae40d6880a9cf6572e48db7cde278aa1dedd855791167a093d62b2dc

            handshake=Noise_KKpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548b75e1a1de629bd7bac048614be9ce38bd0c0f0100160ff1dcd5
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664bf2a2da8c86239618ed75c5a3a80f84f18e853c86a6c6137b98
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=5ee8fab16de07e20d98cd7a3cfcd72d229520670746f1fcaaa1127c729994d
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=ee6791cd8c9a12ecd260c7efcf6d0b094f05828949743f7f1da36d2fead3bd

            handshake=Noise_KKpsk2_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254797f85753395023883c29179f22e141c07c0d0940712f6c0224f
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663fc5041accf40fbcf106a268de93fd43bd8ce67eec5bec522977
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0304f4a07a39789848204b1ac1fe2004f035cbb474b1e3f4f11b6f09aaff19
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=14bb951739a8ed231acc6348dcbe342ea124dd4d53a4a463ef415ebd15cb0d

            handshake=Noise_KK_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625481294976bf2915b8d25846e070a8faf3
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846683c72d35f421d61ea833ffb5a5ececc1
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=6b689fca5f9af8029b40d692f66dab834d9b1ad71ef02e12f0ec068a93ba55
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=126650ec27e76d0de04fc556ef662a4a0cd619b62daacd5110dc43bfe1c1ba

            handshake=Noise_KKpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545511775bf252b7b7798b5aa47a6d2bf4
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e6927b5da0967848b5cca6d9441ea950
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d15b43ffc8c33b514f6b1d1cb5a9baac7bb9e8ab7fa60db501342d4369c737
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=6bd6bdae40d6880a9cf6572e48db7cde278aa1dedd855791167a093d62b2dc

            handshake=Noise_KKpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254782f9ea5e938f3a83cd596e21dc38f26
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466108c204a27ee44abec42ab2e2155c7f1
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=5ee8fab16de07e20d98cd7a3cfcd72d229520670746f1fcaaa1127c729994d
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=ee6791cd8c9a12ecd260c7efcf6d0b094f05828949743f7f1da36d2fead3bd

            handshake=Noise_KKpsk2_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546cfe8fea278b52605acdaed61a076cff
            msg_1_payload=
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661aea6d52c5f57bdb87846f3b20633e01
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0304f4a07a39789848204b1ac1fe2004f035cbb474b1e3f4f11b6f09aaff19
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=14bb951739a8ed231acc6348dcbe342ea124dd4d53a4a463ef415ebd15cb0d

            handshake=Noise_KK_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254983397660911ddae03fe246b376afbd5d094b0fa701a84bdcd3e
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466beeba4b2e28bbb5d84ee8142c6b37c508edf518dbad16a09b062
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=6b689fca5f9af8029b40d692f66dab834d9b1ad71ef02e12f0ec068a93ba55
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=126650ec27e76d0de04fc556ef662a4a0cd619b62daacd5110dc43bfe1c1ba

            handshake=Noise_KKpsk0_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625432687ae9f41a125bbb266304cfeeda44b8ac9eb1338ef6f186a7
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466678c53d1c8fb7d77e1c79d4704436e55e97648d81807db8a43ba
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=d15b43ffc8c33b514f6b1d1cb5a9baac7bb9e8ab7fa60db501342d4369c737
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=6bd6bdae40d6880a9cf6572e48db7cde278aa1dedd855791167a093d62b2dc

            handshake=Noise_KKpsk1_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548b75e1a1de629bd7bac046d9df733cd3c96d735b2b5338c09281
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664bf2a2da8c86239618ed437962b82a34484359e590b7252d01b7
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=5ee8fab16de07e20d98cd7a3cfcd72d229520670746f1fcaaa1127c729994d
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=ee6791cd8c9a12ecd260c7efcf6d0b094f05828949743f7f1da36d2fead3bd

            handshake=Noise_KKpsk2_25519_AESGCM_SHA512
            init_static=000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
            resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
            gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
            gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
            prologue=6e6f74736563726574
            preshared_key=2176657279736563726574766572797365637265747665727973656372657421
            msg_0_payload=746573745f6d73675f30
            msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254797f85753395023883c2c7495a1b13f1976fa9ebbf898a1054d0
            msg_1_payload=746573745f6d73675f31
            msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484663fc5041accf40fbcf106a311f7eaa3ab0eb5bef5f28fa9ef0055
            msg_2_payload=79656c6c6f777375626d6172696e65
            msg_2_ciphertext=0304f4a07a39789848204b1ac1fe2004f035cbb474b1e3f4f11b6f09aaff19
            msg_3_payload=7375626d6172696e6579656c6c6f77
            msg_3_ciphertext=14bb951739a8ed231acc6348dcbe342ea124dd4d53a4a463ef415ebd15cb0d
            """

        XCTAssertNoThrow(try NoiseTestSuite.doAllHandshakeVectors(vectors))
    }
}
