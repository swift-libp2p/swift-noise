//===----------------------------------------------------------------------===//
//
// This source file is part of the swift-libp2p open source project
//
// Copyright (c) 2022-2025 swift-libp2p project authors
// Licensed under MIT
//
// See LICENSE for license information
// See CONTRIBUTORS for the list of swift-libp2p project authors
//
// SPDX-License-Identifier: MIT
//
//===----------------------------------------------------------------------===//

import XCTest
import Crypto
@testable import Noise

final class NX_Handshake_Tests: XCTestCase {
    
    func test_Noise_NX_25519_ChaChaPoly_SHA256() throws {
        let vectors = """
        handshake=Noise_NX_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846686b5f4e8c51a605bcb276206a6df60ae938b905adaf29a2dae4a4951bbd9ac64830ab64f2329646560b930979ff52da8dda7c0677c502dba13c078b5afd1bf11
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=92613cda6ccb2936449efb8ff870b5a4536f5734a4e31056d38101230762e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed89355072429afe6c3442ba7af66f6647499291bab58d40f6a392e79ff80a

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a9ee73b4288fdbc31cb51797c65fbaa9
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664f6b8c9a95aeb764b26cf8c501bacc34e529749e4f6ae88920bd387fabb8637dcde2392baf3709659849325856ac9cf356aaefe992efcb4f9ab2a3970fbb99f5
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=48a1263c75d2406120b1a37c67ea6dbfd419846d447bb9561f7b2e59e519fb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=73b72d691daf65626d78168e0ed56bea89856f26a9dafe3e9bfc9eb6e0f31d

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254630415173b9f1928701ff2289f37d561
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846605a586d5481fff45caeea1cd0655af37781458d66a4815875d47b78c96a3a12d093a0dc166d20f0c3214a4626b9e66336caf89021d364d65e4772bc8f1321040
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0939720a26cecdc36b1c4026bd90b3dbcf385f01e559ca5a0a0d3e873490e5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d4d6c20c1864598f66f01fe45acc18f5bda9ffa8df1ef6ceb816767b89a58

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254162c9c2f5940535c6bfd1f890e60408d
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466353ad209b6a362c223414b1d0a03e9e81e22fa4caeb6b362260fbfe5c128631598e58eba6e707e7d2222949ee232b54ebf61e33970b46cd4eeac807a2f0cf192
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a4e0c92d865ded40ef3c75ba54bdf98e66a5a0f2518d3b0a7f6f0282f2b20a
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=295ed0f56eb5f31822f8d9555d259cad3287f00b0a190e11039c84931c3da5

        handshake=Noise_NX_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846686b5f4e8c51a605bcb276206a6df60ae938b905adaf29a2dae4a4951bbd9ac64ab58309bc12c2c6833badcfdd3d7ff0761dbe60d6d29ade8507d29fb2bc4117057fc8179e6fbef5007ad
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=92613cda6ccb2936449efb8ff870b5a4536f5734a4e31056d38101230762e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed89355072429afe6c3442ba7af66f6647499291bab58d40f6a392e79ff80a

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e9015cba2a23b0096a05011567485f6bf02291236c1a148210fc
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664f6b8c9a95aeb764b26cf8c501bacc34e529749e4f6ae88920bd387fabb8637dd40f5cfab465b3b2502a36bd5eb32fcfcd18d09a129a297e8b6ec14c40f49ddefba21635f51fb72aa086
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=48a1263c75d2406120b1a37c67ea6dbfd419846d447bb9561f7b2e59e519fb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=73b72d691daf65626d78168e0ed56bea89856f26a9dafe3e9bfc9eb6e0f31d

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546f39612d4d40b9e9cfdc3a11c3356eeff3ebf41fbfaeeef9aa39
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846605a586d5481fff45caeea1cd0655af37781458d66a4815875d47b78c96a3a12d555e64b1d866a2cc146e4d71d56b0bacf2c3abdcf587228060f0a41bb179568b9c95191f7bdb9ab94e9d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0939720a26cecdc36b1c4026bd90b3dbcf385f01e559ca5a0a0d3e873490e5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d4d6c20c1864598f66f01fe45acc18f5bda9ffa8df1ef6ceb816767b89a58

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625438e8bbb2574005b8a72c7fc4a5455835244356622ed2cdbbd68d
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466353ad209b6a362c223414b1d0a03e9e81e22fa4caeb6b362260fbfe5c1286315de9dafc57e6d45a3fbd49aced15f14ce967be96d154f36efe24015a68924e69b7c9135349ce6264f6c59
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a4e0c92d865ded40ef3c75ba54bdf98e66a5a0f2518d3b0a7f6f0282f2b20a
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=295ed0f56eb5f31822f8d9555d259cad3287f00b0a190e11039c84931c3da5

        handshake=Noise_NX_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846686b5f4e8c51a605bcb276206a6df60ae938b905adaf29a2dae4a4951bbd9ac64609b51f99bea30ec0bbedbd1007843d83c9763a959b00ab5cab5ba49eafb3e2e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=92613cda6ccb2936449efb8ff870b5a4536f5734a4e31056d38101230762e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed89355072429afe6c3442ba7af66f6647499291bab58d40f6a392e79ff80a

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254d93a8a6ccad06b8a39521b804712e760
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664f6b8c9a95aeb764b26cf8c501bacc34e529749e4f6ae88920bd387fabb8637d74d1f7e7e208bab05d20d4b685ce7dbd7c3ac274d2fc417b9ea17fca299290ea
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=48a1263c75d2406120b1a37c67ea6dbfd419846d447bb9561f7b2e59e519fb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=73b72d691daf65626d78168e0ed56bea89856f26a9dafe3e9bfc9eb6e0f31d

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254921fe5c4bb90760e53d6faf1a0740c79
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846605a586d5481fff45caeea1cd0655af37781458d66a4815875d47b78c96a3a12d92c26414634b717744bf686cda3a086e2a5f112e7b50193a0981c9052b26b95a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0939720a26cecdc36b1c4026bd90b3dbcf385f01e559ca5a0a0d3e873490e5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d4d6c20c1864598f66f01fe45acc18f5bda9ffa8df1ef6ceb816767b89a58

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a816c865955730f32f7955893a0d7f2e
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466353ad209b6a362c223414b1d0a03e9e81e22fa4caeb6b362260fbfe5c128631555051ef062c98db54b470d1e15b0050171b4b5a3b57703c66b018918176481dd
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a4e0c92d865ded40ef3c75ba54bdf98e66a5a0f2518d3b0a7f6f0282f2b20a
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=295ed0f56eb5f31822f8d9555d259cad3287f00b0a190e11039c84931c3da5

        handshake=Noise_NX_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846686b5f4e8c51a605bcb276206a6df60ae938b905adaf29a2dae4a4951bbd9ac640fc955b72cd7be36df1431bc363bf15b61dbe60d6d29ade8507d549c2b17ff58629ba542d5129adf100f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=92613cda6ccb2936449efb8ff870b5a4536f5734a4e31056d38101230762e8
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed89355072429afe6c3442ba7af66f6647499291bab58d40f6a392e79ff80a

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e9015cba2a23b0096a053a030712430d2c4b67068f03021e228f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484664f6b8c9a95aeb764b26cf8c501bacc34e529749e4f6ae88920bd387fabb8637da2ba3faccfe2faa68a3139e1c8447a55cd18d09a129a297e8b6eae2479c85097b112227d3a5f8c151535
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=48a1263c75d2406120b1a37c67ea6dbfd419846d447bb9561f7b2e59e519fb
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=73b72d691daf65626d78168e0ed56bea89856f26a9dafe3e9bfc9eb6e0f31d

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662546f39612d4d40b9e9cfdc571de866bca651aafdc036069e6287ee
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846605a586d5481fff45caeea1cd0655af37781458d66a4815875d47b78c96a3a12d10417dc13d71a4453495b69c0892beb5f2c3abdcf587228060f0258e113345473d901ace83f9bdbd0b41
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0939720a26cecdc36b1c4026bd90b3dbcf385f01e559ca5a0a0d3e873490e5
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=4d4d6c20c1864598f66f01fe45acc18f5bda9ffa8df1ef6ceb816767b89a58

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625438e8bbb2574005b8a72cea9f0f940e1159de27b869b82e9779f0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466353ad209b6a362c223414b1d0a03e9e81e22fa4caeb6b362260fbfe5c1286315e1f3a591d5886270af814b41d8bacb7a967be96d154f36efe240b4f5bbe437a4669d354ec3f988467b16
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=a4e0c92d865ded40ef3c75ba54bdf98e66a5a0f2518d3b0a7f6f0282f2b20a
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=295ed0f56eb5f31822f8d9555d259cad3287f00b0a190e11039c84931c3da5
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_NX_25519_ChaChaPoly_SHA512() throws {
        let vectors = """
        handshake=Noise_NX_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846646b94b876aef590a75654b6ad3759d4a2b887f24780015b9f52dce3318747d1421273ee37fab11ec0e19b97e016019eba398fd0234f4f397c37869498760e015
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b5d17fa3d357b71df323fb36fe9468c8b8231d52687d3ab34e943d5176559f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9604b7d4aeb5d2d669004203e5ea36a496185d60aa484d843de5ce6504fcf2

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625486484f9dc39cfcb069ca0a6b4fb53898
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466073c7b8893efddc83a6550268f1f2b58b810514f8ceb8839db90f8bd9c2d88e8839bdfbf351f047acabb381fb6432cc1098d42a95e5226dd40e64b67fa0d021f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b29d746b8d07a50fb43cde476703b870b5d9ef75e760dbb38548ff5449b74b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=575261f1aece9f5960ed5e51ecafb480adef5c1b681509cc73270b63b0cc58

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254b9f6b397b7e8f8dc1bc7e73b0c61286f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466df854f551297c8c948841769640157bb0a68e959679f8956f3f078956be2c39c8de3427a96c0db5628e54857e7e316efc2d4ea29d8ecd50c31bd439f99a75736
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d1dcb9b1e4dbba2386624a124bb1539e391e890c463a8940127ae765eb6aee
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6334f69a2c9bcf6c7c1aff16f653da4b241ce641ebb859f456923670bd0c35

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547bc9eeadef9d1cd0dbc4a06e004c06b6
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e758b813c78910a7246ba02fa2bf78f1f91df195e41d33fd94c03e51aa35750983a79f279c5845431d6ec30e9122d07d1b1a2f219ef8ff8fe043ca9e6e8e0f2e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8e98a23dc6de8edee0529f80f7d14be0774f42c6d90fbc56d0d5d27b9c207
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9de92b1e88a0cb7794854160cae0f948c366287194e571c8e0922554cb78bb

        handshake=Noise_NX_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846646b94b876aef590a75654b6ad3759d4a2b887f24780015b9f52dce3318747d14fe963b90ba2e278d62c50e22832a691765f20777ea751a010257b1616a6de3043e332e8e891e5d4afdeb
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b5d17fa3d357b71df323fb36fe9468c8b8231d52687d3ab34e943d5176559f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9604b7d4aeb5d2d669004203e5ea36a496185d60aa484d843de5ce6504fcf2

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541b57ff52600948c125f4a5c4d387d7cef809d8036fd40ed2e108
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466073c7b8893efddc83a6550268f1f2b58b810514f8ceb8839db90f8bd9c2d88e8b4a4972b01bd3a29057bd6f1e9e5b90570f6cb66d26bb6164e544dc248a26347b3c7f87d473ee01ba434
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b29d746b8d07a50fb43cde476703b870b5d9ef75e760dbb38548ff5449b74b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=575261f1aece9f5960ed5e51ecafb480adef5c1b681509cc73270b63b0cc58

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f512badfe5247731af42e55b1324f361c190926302ffdbc1eef7
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466df854f551297c8c948841769640157bb0a68e959679f8956f3f078956be2c39c940b3d894e4d2f72db33c47e6355d445f4b4456e5d2ea966b4bf8bcdb5dfe2c29aa68488b3f82d5526d7
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d1dcb9b1e4dbba2386624a124bb1539e391e890c463a8940127ae765eb6aee
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6334f69a2c9bcf6c7c1aff16f653da4b241ce641ebb859f456923670bd0c35

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547664a776a6da240a65ab7b2c75ed4cd21f507d1d609e65f11a74
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e758b813c78910a7246ba02fa2bf78f1f91df195e41d33fd94c03e51aa357509868f2beb823e19c97840ee2171198d4c02d416c7ca47cee015daa374cc9074a2c53a48a516d5f467572b
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8e98a23dc6de8edee0529f80f7d14be0774f42c6d90fbc56d0d5d27b9c207
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9de92b1e88a0cb7794854160cae0f948c366287194e571c8e0922554cb78bb

        handshake=Noise_NX_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846646b94b876aef590a75654b6ad3759d4a2b887f24780015b9f52dce3318747d1480c897964b162ef9638256026c093979aa00d4334a90f1ec65206e5102364b7e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b5d17fa3d357b71df323fb36fe9468c8b8231d52687d3ab34e943d5176559f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9604b7d4aeb5d2d669004203e5ea36a496185d60aa484d843de5ce6504fcf2

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548cc277e07714f923bddfbe134b7cdcb7
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466073c7b8893efddc83a6550268f1f2b58b810514f8ceb8839db90f8bd9c2d88e89d03c776cd7ec28d70e84e6c387ef70b0e46454c8b950550860815a2ee213171
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b29d746b8d07a50fb43cde476703b870b5d9ef75e760dbb38548ff5449b74b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=575261f1aece9f5960ed5e51ecafb480adef5c1b681509cc73270b63b0cc58

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254aabe871c6705c33c5e6812e239569c08
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466df854f551297c8c948841769640157bb0a68e959679f8956f3f078956be2c39cd24b6200d5fbe33debec8cbb3a4a266b69ef965c80b1a345caac03508e6a462f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d1dcb9b1e4dbba2386624a124bb1539e391e890c463a8940127ae765eb6aee
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6334f69a2c9bcf6c7c1aff16f653da4b241ce641ebb859f456923670bd0c35

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545fb3c95fcffb1e687a983bf52c73e46e
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e758b813c78910a7246ba02fa2bf78f1f91df195e41d33fd94c03e51aa3575090102a531c19850c4c0a6e9e7831a97553a0c85ba8f73d9e895f7af081c5a2d20
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8e98a23dc6de8edee0529f80f7d14be0774f42c6d90fbc56d0d5d27b9c207
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9de92b1e88a0cb7794854160cae0f948c366287194e571c8e0922554cb78bb

        handshake=Noise_NX_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d4846646b94b876aef590a75654b6ad3759d4a2b887f24780015b9f52dce3318747d14a02d1af836b904cdc2331de53846c36b65f20777ea751a010257af5106dbf27395fbb55e705de1c21894
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b5d17fa3d357b71df323fb36fe9468c8b8231d52687d3ab34e943d5176559f
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9604b7d4aeb5d2d669004203e5ea36a496185d60aa484d843de5ce6504fcf2

        handshake=Noise_NXpsk0_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662541b57ff52600948c125f44b02653596239ee0c152247266ab71ff
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466073c7b8893efddc83a6550268f1f2b58b810514f8ceb8839db90f8bd9c2d88e85de4226713c8a68e15e259379d0bf3c870f6cb66d26bb6164e54d4475c4f7b4f79f00db1d34e4897233a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=b29d746b8d07a50fb43cde476703b870b5d9ef75e760dbb38548ff5449b74b
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=575261f1aece9f5960ed5e51ecafb480adef5c1b681509cc73270b63b0cc58

        handshake=Noise_NXpsk1_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254f512badfe5247731af4236af5558ff1540b60219e82ed4fee868
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466df854f551297c8c948841769640157bb0a68e959679f8956f3f078956be2c39c385c53c43c3ffc2b5bbea33db14dbec3f4b4456e5d2ea966b4bfb56f3cb874d5c7b23b76b52ec0f9ac32
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=d1dcb9b1e4dbba2386624a124bb1539e391e890c463a8940127ae765eb6aee
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=6334f69a2c9bcf6c7c1aff16f653da4b241ce641ebb859f456923670bd0c35

        handshake=Noise_NXpsk2_25519_ChaChaPoly_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547664a776a6da240a65aba904f90d1eaa5f44454c7cb850438789
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466e758b813c78910a7246ba02fa2bf78f1f91df195e41d33fd94c03e51aa35750948e563125f88f23f662a24cab0ae857302d416c7ca47cee015dad0910b515661e0062e9f13e5bff3b05e
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8e98a23dc6de8edee0529f80f7d14be0774f42c6d90fbc56d0d5d27b9c207
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=9de92b1e88a0cb7794854160cae0f948c366287194e571c8e0922554cb78bb
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
    
    func test_Noise_NX_25519_AESGCM_SHA256() throws {
        let vectors = """
        handshake=Noise_NX_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ba1de7566c661eeed804d8fba1bcf3071d59a4a7ee2095ae6e8d813b554ad81ee45f4a4b6c2e8cd75b923c050e1330749b0c56fbae778fd91060bca3512061cf
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=947e1b1a2798ef97094d7dbccd7244c92baf5e4d8b0e7ed5da78fbe1fdac76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed42482e9b09e2f97dc931e1444f9d7a8b51241108b41cab53474327500596

        handshake=Noise_NXpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254600c4a8eb4f41bafda4465f2e9e34bae
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661aa7a9691509a04c46a6ce79f30fdbc377a2158ca3967df0ea4b1bb18532ca8737927e184c0605e9641bc3974b037282ceae988c87be4c68494c1d4f2b705cb2
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=309e81a1ec83fd198e19b766e75f5e3a6ee55cd7b0119955211dcfcfdd0dae
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=92ac33cb48df9677f9a6528346e17cd89855368535e8ee3c8252291d7820a4

        handshake=Noise_NXpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545b83011e8a447059f5a20533e49339a7
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466afe68fdc6ad2df579fc8c4647c9daa9bccf146281b1fd8a0c4a193c206e89182236eb3f634d1c039759312597c6b3d48389b835f65abd51fd8e9a844fcfa9d89
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bd4ff6855a94bfd208d12eab8a615bd648d2e255bbca66ef2dcf95b6f64051
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=72f8827c79760073df771af24d5577a294e6c91391de79ad375277b91c899e

        handshake=Noise_NXpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254c32f9f7340e786f655274b1d55dddeb1
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466483412f9b4501d6e091c567f54851490683ba20583a2d46f9e46a34e1aef4d4f027e98fac3b55d80b833ac43e55d84d2597fbd6906b2ce5c0101b0c992bd7816
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=4e6a4d111017cdfee460438955caf3234610c1971e06d1143ca16c7b407a96
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0f24650c4c6aa4a0ac25f0def8ac28890c64ad3bd787f101be1f6f3d868288

        handshake=Noise_NX_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ba1de7566c661eeed804d8fba1bcf3071d59a4a7ee2095ae6e8d813b554ad81e4ad1b2e3dc131f7decf35551aaa64803118efe076183e491cbc8dbfa9e20298f8603da282b6cbbf303c8
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=947e1b1a2798ef97094d7dbccd7244c92baf5e4d8b0e7ed5da78fbe1fdac76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed42482e9b09e2f97dc931e1444f9d7a8b51241108b41cab53474327500596

        handshake=Noise_NXpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dc8c612be768de5f7f3df631297f55b318248d15e3475c151d8d
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661aa7a9691509a04c46a6ce79f30fdbc377a2158ca3967df0ea4b1bb18532ca87a13b25dfb83dac18a8cbac87c6bc6992ef497397067bba94fb3a96ca3a1020c00a2ae479f2e60e977d68
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=309e81a1ec83fd198e19b766e75f5e3a6ee55cd7b0119955211dcfcfdd0dae
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=92ac33cb48df9677f9a6528346e17cd89855368535e8ee3c8252291d7820a4

        handshake=Noise_NXpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547bb202abc57006587591d4d467cc7bcbd58800e3d148ce4963e9
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466afe68fdc6ad2df579fc8c4647c9daa9bccf146281b1fd8a0c4a193c206e89182e71c52c2ee8ffc027ee7460754ec704fb0f338043a3e469bd74c850e7f4502269fd8e69922b3ec7f014c
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bd4ff6855a94bfd208d12eab8a615bd648d2e255bbca66ef2dcf95b6f64051
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=72f8827c79760073df771af24d5577a294e6c91391de79ad375277b91c899e

        handshake=Noise_NXpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cb0e968d6f6cf4ffa7b1a168a144a90d468d117045bcdac9ce2b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466483412f9b4501d6e091c567f54851490683ba20583a2d46f9e46a34e1aef4d4f2f0c8a081791c4ee0f5abb8697ffc0c99562af1f3e104d1bc04df1b1a17a2ead35a5b569377336e90470
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=4e6a4d111017cdfee460438955caf3234610c1971e06d1143ca16c7b407a96
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0f24650c4c6aa4a0ac25f0def8ac28890c64ad3bd787f101be1f6f3d868288

        handshake=Noise_NX_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ba1de7566c661eeed804d8fba1bcf3071d59a4a7ee2095ae6e8d813b554ad81e607b7c6987c60ff865c745b0c6ef765be0580f5484546cf94bd3ecb0d2298226
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=947e1b1a2798ef97094d7dbccd7244c92baf5e4d8b0e7ed5da78fbe1fdac76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed42482e9b09e2f97dc931e1444f9d7a8b51241108b41cab53474327500596

        handshake=Noise_NXpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd16625470fd0f29b580ff883963cdee7776787b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661aa7a9691509a04c46a6ce79f30fdbc377a2158ca3967df0ea4b1bb18532ca87d439f889f15a1819502b8356523b4d3a14b3906db2105a3a567cecce7699b721
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=309e81a1ec83fd198e19b766e75f5e3a6ee55cd7b0119955211dcfcfdd0dae
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=92ac33cb48df9677f9a6528346e17cd89855368535e8ee3c8252291d7820a4

        handshake=Noise_NXpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254ead4aca71459776346063860fc9dacef
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466afe68fdc6ad2df579fc8c4647c9daa9bccf146281b1fd8a0c4a193c206e8918205f730787beb926375b224bdd8c3ffd2b485a3a2e44ac9e33de0e3160438b266
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bd4ff6855a94bfd208d12eab8a615bd648d2e255bbca66ef2dcf95b6f64051
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=72f8827c79760073df771af24d5577a294e6c91391de79ad375277b91c899e

        handshake=Noise_NXpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549d596409946ef9c77e9c61aaeaaad31b
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466483412f9b4501d6e091c567f54851490683ba20583a2d46f9e46a34e1aef4d4fd1622b6c789a6df165149281d1be9449a04338eb661d26528df109a269ed2a5d
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=4e6a4d111017cdfee460438955caf3234610c1971e06d1143ca16c7b407a96
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0f24650c4c6aa4a0ac25f0def8ac28890c64ad3bd787f101be1f6f3d868288

        handshake=Noise_NX_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ba1de7566c661eeed804d8fba1bcf3071d59a4a7ee2095ae6e8d813b554ad81eb15e8bfeea1d1766c1ca995bf2fc89f8118efe076183e491cbc8f2e50c3b6af6238ec0e37daffb0cc742
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=947e1b1a2798ef97094d7dbccd7244c92baf5e4d8b0e7ed5da78fbe1fdac76
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=ed42482e9b09e2f97dc931e1444f9d7a8b51241108b41cab53474327500596

        handshake=Noise_NXpsk0_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dc8c612be768de5f7f3d2d79705307fcaf69908c306a29c5e2e2
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661aa7a9691509a04c46a6ce79f30fdbc377a2158ca3967df0ea4b1bb18532ca87cd254354d4669c66db55d59ea0db0c57ef497397067bba94fb3a75d3a3b3804d73a62887f06cd31b17dc
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=309e81a1ec83fd198e19b766e75f5e3a6ee55cd7b0119955211dcfcfdd0dae
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=92ac33cb48df9677f9a6528346e17cd89855368535e8ee3c8252291d7820a4

        handshake=Noise_NXpsk1_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662547bb202abc57006587591865999d0fba3fb1daa6f307a1c5a69b9
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466afe68fdc6ad2df579fc8c4647c9daa9bccf146281b1fd8a0c4a193c206e89182883437826964719dfe774885fd82ed85b0f338043a3e469bd74c03833e4d31c6c4197118b2d0c23fe394
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=bd4ff6855a94bfd208d12eab8a615bd648d2e255bbca66ef2dcf95b6f64051
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=72f8827c79760073df771af24d5577a294e6c91391de79ad375277b91c899e

        handshake=Noise_NXpsk2_25519_AESGCM_SHA256
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254cb0e968d6f6cf4ffa7b18efe9bd452f1b893c8e960b8be69195b
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466483412f9b4501d6e091c567f54851490683ba20583a2d46f9e46a34e1aef4d4fe228d02a04c8e97aca8ccf320bd8132d9562af1f3e104d1bc04dbc27c527aa4edf080cdd9962779f7718
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=4e6a4d111017cdfee460438955caf3234610c1971e06d1143ca16c7b407a96
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=0f24650c4c6aa4a0ac25f0def8ac28890c64ad3bd787f101be1f6f3d868288
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }

    func test_Noise_NX_25519_AESGCM_SHA512() throws {
        let vectors = """
        handshake=Noise_NX_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac104e4413b3e6091ab98f8902f898f750341010fc28130905edcfa84df5b5ff78b8851e94c6c17bd270a7a37e6708c2d69210ebf8c5da2c7babd825d14ba61a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=50f23b250835f62aeee57429ea276cce9ce465b1fa5bd01cb8041bc9ae7722
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=681c16d92b2ed840ea2096ee1445c6d699f71659c0aa98c115fd2be24a4e6a

        handshake=Noise_NXpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254128719fddfb85978a91462e8016a3b7c
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666c4fbd20d2daae06cfee3a4044de5f045844d2d23c127c77abb5006a1727e9b0d65cf665ef2c2cf4b9b6abc1b2eb38c3795451e327b76fb59eb66315301bc415
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8a9c8176161c87470eb1bbe4a5ffe8bd08cc293b80f57f244c10ddbbe368d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=38d5a75a6dd18e71d5f6555c7edeac938ed79a312ac10077fd8fc8d82ad81b

        handshake=Noise_NXpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662548f68a3d756a50740b15842b4246d40c9
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661d6f6e3ddf23875e0592cb924daf3d8126d3008e0d245a8ced1dbfb1286387dedccda427697bf1517a2ce36d5d4dfab9647ec2d26dee1cf6281f4b3217c2e7be
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0253fb688077f49bb12859d7f33c3988a23b855e14bb9963008bb5e8ada039
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d296bf8aac74a67761c7c5666f2922d68ab6e431aa6b4004b9fd8cd626cbee

        handshake=Noise_NXpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254a3a8c0e25d9cbfd7880c6d3feacf6066
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fc485d9c0d76abdbc722684433571ab05ce22a12c92fb1ef81296edd14429f57af4cb353cb580e67a53f1d03fc6c7bede73fcb3b753dc767dfc38016c3dc3102
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8b285956fce83786691fb9e5a48f6571ee16435da742caa84e27606c8c0417
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=43a9eb08fe5a95969a4eb076b238e5eba3913319b0b74142bc47a35b1fcace

        handshake=Noise_NX_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac104e4413b3e6091ab98f8902f898f750341010fc28130905edcfa84df5b5ff50d0f6181f350f6b280c29e87598a257ff5df3365fc12cae7322ea77df156a499836d833f1c218000c9f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=50f23b250835f62aeee57429ea276cce9ce465b1fa5bd01cb8041bc9ae7722
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=681c16d92b2ed840ea2096ee1445c6d699f71659c0aa98c115fd2be24a4e6a

        handshake=Noise_NXpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544c087d6fe10c8862ed749092cff7288bbb82d14d6c00f86f0974
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666c4fbd20d2daae06cfee3a4044de5f045844d2d23c127c77abb5006a1727e9b07e867dd2c4ea66642d27c3ae9feeaea47089b9aede3e5674a1829bd4a5d8b3b057de516d4bf5318a2fa9
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8a9c8176161c87470eb1bbe4a5ffe8bd08cc293b80f57f244c10ddbbe368d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=38d5a75a6dd18e71d5f6555c7edeac938ed79a312ac10077fd8fc8d82ad81b

        handshake=Noise_NXpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549b88c66c5db16c076955495c7289c3499a801ca5a1840f075d1e
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661d6f6e3ddf23875e0592cb924daf3d8126d3008e0d245a8ced1dbfb1286387de90ab182bc2fb03dd6955f7ae27b74c7077b45b9ff2a8c8130a47ece321f582f42765af8ce6cecc9dab7f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0253fb688077f49bb12859d7f33c3988a23b855e14bb9963008bb5e8ada039
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d296bf8aac74a67761c7c5666f2922d68ab6e431aa6b4004b9fd8cd626cbee

        handshake=Noise_NXpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dad9df4c8fe65e76706807c4b6f3261a2ab9dd864826a4105018
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fc485d9c0d76abdbc722684433571ab05ce22a12c92fb1ef81296edd14429f57352b4c17d9ec7183cafe3bed352923f60758d553d3fe9be0c2f52ed6cbe5bc8146067bee786a4921f2b4
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8b285956fce83786691fb9e5a48f6571ee16435da742caa84e27606c8c0417
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=43a9eb08fe5a95969a4eb076b238e5eba3913319b0b74142bc47a35b1fcace

        handshake=Noise_NX_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac104e4413b3e6091ab98f8902f898f750341010fc28130905edcfa84df5b5fffd5c64064a663cc1f8f0e59775f3d93db4e7d95dd77b5928935227a3bbfef59a
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=50f23b250835f62aeee57429ea276cce9ce465b1fa5bd01cb8041bc9ae7722
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=681c16d92b2ed840ea2096ee1445c6d699f71659c0aa98c115fd2be24a4e6a

        handshake=Noise_NXpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662545386451c97b61e92eddb55d435aa604f
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666c4fbd20d2daae06cfee3a4044de5f045844d2d23c127c77abb5006a1727e9b0fb77c4cfa310f7eb93a6b23b45f1c6dfc7b695808fdeb14bbcdf420040e859a3
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8a9c8176161c87470eb1bbe4a5ffe8bd08cc293b80f57f244c10ddbbe368d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=38d5a75a6dd18e71d5f6555c7edeac938ed79a312ac10077fd8fc8d82ad81b

        handshake=Noise_NXpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254e6b06ac4ec214355f45fa8353f935109
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661d6f6e3ddf23875e0592cb924daf3d8126d3008e0d245a8ced1dbfb1286387de45b77dee817b10ee56198c4aeb08eaf24446e360a7d53fff28c2d680bbfd97ae
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0253fb688077f49bb12859d7f33c3988a23b855e14bb9963008bb5e8ada039
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d296bf8aac74a67761c7c5666f2922d68ab6e431aa6b4004b9fd8cd626cbee

        handshake=Noise_NXpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254006ef9622a9fef1a70a559a801e0b3c5
        msg_1_payload=
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fc485d9c0d76abdbc722684433571ab05ce22a12c92fb1ef81296edd14429f571c5eeee49093a423c6b4acd63e27a510e1abef38197787ac2ec2d692f837e495
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8b285956fce83786691fb9e5a48f6571ee16435da742caa84e27606c8c0417
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=43a9eb08fe5a95969a4eb076b238e5eba3913319b0b74142bc47a35b1fcace

        handshake=Noise_NX_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254746573745f6d73675f30
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466ac104e4413b3e6091ab98f8902f898f750341010fc28130905edcfa84df5b5ff10abab009c4e0ae9e6fe931c4b3a2db2ff5df3365fc12cae7322c0d6356a6fd2ae2b72c9b68520749403
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=50f23b250835f62aeee57429ea276cce9ce465b1fa5bd01cb8041bc9ae7722
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=681c16d92b2ed840ea2096ee1445c6d699f71659c0aa98c115fd2be24a4e6a

        handshake=Noise_NXpsk0_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662544c087d6fe10c8862ed7448bb4f10327d492edf33de25e98a29f0
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484666c4fbd20d2daae06cfee3a4044de5f045844d2d23c127c77abb5006a1727e9b0cb6829c168ec40755cb9791148c71e9b7089b9aede3e5674a182ddb40f356db56ba4f9af3bd611e9c363
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=e8a9c8176161c87470eb1bbe4a5ffe8bd08cc293b80f57f244c10ddbbe368d
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=38d5a75a6dd18e71d5f6555c7edeac938ed79a312ac10077fd8fc8d82ad81b

        handshake=Noise_NXpsk1_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd1662549b88c66c5db16c0769556dd7aaeacf1e9daf99473ed45b7449e5
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d484661d6f6e3ddf23875e0592cb924daf3d8126d3008e0d245a8ced1dbfb1286387de97e23ace6ec8210a1f5045c76214305477b45b9ff2a8c8130a47b7170d66956ae33fd7bcce1e8df4c94f
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=0253fb688077f49bb12859d7f33c3988a23b855e14bb9963008bb5e8ada039
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=d296bf8aac74a67761c7c5666f2922d68ab6e431aa6b4004b9fd8cd626cbee

        handshake=Noise_NXpsk2_25519_AESGCM_SHA512
        resp_static=0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20
        gen_init_ephemeral=202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f
        gen_resp_ephemeral=4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f60
        prologue=6e6f74736563726574
        preshared_key=2176657279736563726574766572797365637265747665727973656372657421
        msg_0_payload=746573745f6d73675f30
        msg_0_ciphertext=358072d6365880d1aeea329adf9121383851ed21a28e3b75e965d0d2cd166254dad9df4c8fe65e767068bdb6e296baddfa4c82b21bbcc228d06f
        msg_1_payload=746573745f6d73675f31
        msg_1_ciphertext=64b101b1d0be5a8704bd078f9895001fc03e8e9f9522f188dd128d9846d48466fc485d9c0d76abdbc722684433571ab05ce22a12c92fb1ef81296edd14429f57ee712f3e89a116cf1ad6e3ad414d7a320758d553d3fe9be0c2f5b3bf317650ef3f796be8958b8619f595
        msg_2_payload=79656c6c6f777375626d6172696e65
        msg_2_ciphertext=8b285956fce83786691fb9e5a48f6571ee16435da742caa84e27606c8c0417
        msg_3_payload=7375626d6172696e6579656c6c6f77
        msg_3_ciphertext=43a9eb08fe5a95969a4eb076b238e5eba3913319b0b74142bc47a35b1fcace
        """
        
        XCTAssertNoThrow( try NoiseTestSuite.doAllHandshakeVectors(vectors) )
    }
}

